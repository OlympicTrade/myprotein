;var libs={jquery:'//ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js',jqueryUi:'//ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js',libYandexMaps:'//api-maps.yandex.ru/2.1/?lang=ru_RU',libVkOpenApi:'//vk.com/js/api/openapi.js',libFancybox:'lib/fancybox/fansybox.js',libHistory:'lib/history.js',libFancyboxThumb:'lib/fancybox/thumbs.js',libFancyboxMedia:'lib/fancybox/media.js',libFlexSlider:'lib/flexslider.js',libOwlSlider:'lib/owlslider.js',libAptero:'lib/aptero.js',libFormValidator:'lib/form-validator.js',mouseWheeel:'lib/mousewheel.js',libSmoothScroll:'lib/smoothscroll.js',libNiceScroll:'lib/nicescroll.js',libInputMask:'lib/inputmask.js',libCookie:'lib/cookie.js',libCart:'lib/cart.js',libProductsList:'lib/products-list.js',};$.config={};(function(w){if(w.fastXDM)return;var handlers={};var onEnvLoad=[],env={};function genKey(){var key='';for(var i=0;i<5;i++){key+=Math.ceil(Math.random()*15).toString(16)};return key};function waitFor(obj,prop,func,self,count){if(obj[prop]){func.apply(self)}else{count=count||0;if(count<1000){setTimeout(function(){waitFor(obj,prop,func,self,count+1)},0)}}};function attachScript(url){setTimeout(function(){var newScript=document.createElement('script');newScript.type='text/javascript';newScript.src=url||w.fastXDM.helperUrl;waitFor(document,'body',function(){document.getElementsByTagName('HEAD')[0].appendChild(newScript)})},0)};function walkVar(value,clean){var newValue;switch(typeof value){case'string':if(clean){newValue=value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;')}else{newValue=value.replace(/&#039;/g,'\'').replace(/&quot;/g,'"').replace(/&gt;/g,'>').replace(/&lt;/g,'<').replace(/&amp;/g,'&')};break;case'object':if(Object.prototype.toString.apply(value)==='[object Array]'){newValue=[];for(var i=0,len=value.length;i<len;i++){newValue[i]=walkVar(value[i],clean)}}else{newValue={};for(var k in value){if(Object.hasOwnProperty.call(value,k)){newValue[k]=walkVar(value[k],clean)}}};break;default:newValue=value;break};return newValue};function getEnv(callback,self){if(env.loaded){callback.apply(self,[env])}else{onEnvLoad.push([self,callback])}};function envLoaded(){env.loaded=true;for(var i=0,len=onEnvLoad.length;i<len;i++){onEnvLoad[i][1].apply(onEnvLoad[i][0],[env])}};function applyMethod(strData,self){getEnv(function(env){var data=env.json.parse(strData);if(data[0]){if(!data[1])data[1]=[];for(var i=0,len=data[1].length;i<len;i++){if(data[1][i]&&data[1][i]._func){var funcNum=data[1][i]._func;data[1][i]=function(){var args=Array.prototype.slice.call(arguments);args.unshift('_func'+funcNum);self.callMethod.apply(self,args)}}else if(self.options.safe){data[1][i]=walkVar(data[1][i],true)}};setTimeout(function(){if(!self.methods[data[0]]){throw Error('fastXDM: Method '+data[0]+' is undefined');};self.methods[data[0]].apply(self,data[1])},0)}})};function extend(obj1,obj2){for(var i in obj2){if(obj1[i]&&typeof(obj1[i])==='object'){extend(obj1[i],obj2[i])}else{obj1[i]=obj2[i]}}};w.fastXDM={_id:0,helperUrl:'https://vk.com/js/api/xdmHelper.js',Server:function(methods,filter,options){this.methods=methods||{};this.filter=filter;this.options=options||{};this.id=w.fastXDM._id++;this.key=genKey();this.frameName='fXD'+this.key;this.server=true;this.methods['%init%']=this.methods.__fxdm_i=function(){w.fastXDM.run(this.id);if(this.methods.onInit){this.methods.onInit()}};handlers[this.key]=[applyMethod,this]},Client:function(methods,options){this.methods=methods||{};this.options=options||{};this.id=w.fastXDM._id++;this.client=true;w.fastXDM.run(this.id);if(window.name.indexOf('fXD')===0){this.key=window.name.substr(3)}else{throw Error('Wrong window.name property.');};this.caller=window.parent;handlers[this.key]=[applyMethod,this];w.fastXDM.on('helper',function(){w.fastXDM.onClientStart(this)},this);getEnv(function(env){env.send(this,env.json.stringify(['%init%']));var methods=this.methods;setTimeout(function(){if(methods.onInit){methods.onInit()}},0)},this)},onMessage:function(e){var data=e.data;if(!data){return false};if(typeof data!=='string'&&!(data instanceof String)){return false};var key=data.substr(0,5);if(handlers[key]){var self=handlers[key][1];if(self&&(!self.filter||self.filter(e.origin))){handlers[key][0](data.substr(6),self)}}},setJSON:function(json){env.json=json},getJSON:function(callback){if(!callback){return env.json};getEnv(function(env){callback(env.json)})},setEnv:function(exEnv){for(var i in exEnv){env[i]=exEnv[i]};envLoaded()},_q:{},on:function(key,act,self){if(!this._q[key])this._q[key]=[];if(this._q[key]==-1){act.apply(self)}else{this._q[key].push([act,self])}},run:function(key){var len=(this._q[key]||[]).length;for(var i=0;i<len;i++){this._q[key][i][0].apply(this._q[key][i][1])};this._q[key]=-1},waitFor:waitFor};w.fastXDM.Server.prototype.start=function(obj,count){if(obj.contentWindow){this.caller=obj.contentWindow;this.frame=obj;w.fastXDM.on('helper',function(){w.fastXDM.onServerStart(this)},this)}else{var self=this;count=count||0;if(count<50){setTimeout(function(){self.start.apply(self,[obj,count+1])},100)}}};w.fastXDM.Server.prototype.destroy=function(){delete handlers[this.key]};w.fastXDM.Server.prototype.append=function(obj,options,attrs){var div=document.createElement('DIV');div.innerHTML='<iframe name="'+this.frameName+'" '+(attrs||'')+'></iframe>';var frame=div.firstChild,self=this;setTimeout(function(){frame.frameBorder='0';if(options)extend(frame,options);obj.insertBefore(frame,obj.firstChild);self.start(frame)},0);return frame};w.fastXDM.Client.prototype.callMethod=w.fastXDM.Server.prototype.callMethod=function(){var args=Array.prototype.slice.call(arguments),method=args.shift();for(var i=0,len=args.length;i<len;i++){if(typeof(args[i])==='function'){this.funcsCount=(this.funcsCount||0)+1;var func=args[i],funcName='_func'+this.funcsCount;this.methods[funcName]=function(){func.apply(this,arguments);delete this.methods[funcName]};args[i]={_func:this.funcsCount}}else if(this.options.safe){args[i]=walkVar(args[i],false)}};waitFor(this,'caller',function(){w.fastXDM.on(this.id,function(){getEnv(function(env){env.send(this,env.json.stringify([method,args]))},this)},this)},this)};if(w.JSON&&typeof(w.JSON)==='object'&&w.JSON.parse&&w.JSON.stringify&&w.JSON.stringify({a:[1,2,3]}).replace(/ /g,'')==='{"a":[1,2,3]}'){env.json={parse:w.JSON.parse,stringify:w.JSON.stringify}}else{w.fastXDM._needJSON=true};if(w.postMessage){env.protocol='p';env.send=function(xdm,strData){var win=(xdm.frame?xdm.frame.contentWindow:xdm.caller);if(win){try{win.postMessage(xdm.key+':'+strData,'*')}catch(catch$scope$var751069445){window.postMessage.call(win,xdm.key+':'+strData,'*')}}};if(w.addEventListener){w.addEventListener('message',w.fastXDM.onMessage,false)}else{w.attachEvent('onmessage',w.fastXDM.onMessage)};if(w.fastXDM._needJSON){w.fastXDM._onlyJSON=true;attachScript()}else{envLoaded()}}else{attachScript()}})(window);if(!window.VK)window.VK={};if(!VK.MD5){VK.MD5=function(n){var j=function(o,r){var q=(o&65535)+(r&65535),p=(o>>16)+(r>>16)+(q>>16);return(p<<16)|(q&65535)},g=function(o,p){return(o<<p)|(o>>>(32-p))},k=function(w,r,p,o,v,u){return j(g(j(j(r,w),j(o,u)),v),p)},a=function(q,p,w,v,o,u,r){return k((p&w)|((~p)&v),q,p,o,u,r)},h=function(q,p,w,v,o,u,r){return k((p&v)|(w&(~v)),q,p,o,u,r)},c=function(q,p,w,v,o,u,r){return k(p^w^v,q,p,o,u,r)},m=function(q,p,w,v,o,u,r){return k(w^(p|(~v)),q,p,o,u,r)},b=function(A,u){var z=1732584193,y=-271733879,w=-1732584194,v=271733878,r,q,p,o;A[u>>5]|=128<<((u)%32);A[(((u+64)>>>9)<<4)+14]=u;for(var t=0,s=A.length;t<s;t+=16){r=z;q=y;p=w;o=v;z=a(z,y,w,v,A[t+0],7,-680876936);v=a(v,z,y,w,A[t+1],12,-389564586);w=a(w,v,z,y,A[t+2],17,606105819);y=a(y,w,v,z,A[t+3],22,-1044525330);z=a(z,y,w,v,A[t+4],7,-176418897);v=a(v,z,y,w,A[t+5],12,1200080426);w=a(w,v,z,y,A[t+6],17,-1473231341);y=a(y,w,v,z,A[t+7],22,-45705983);z=a(z,y,w,v,A[t+8],7,1770035416);v=a(v,z,y,w,A[t+9],12,-1958414417);w=a(w,v,z,y,A[t+10],17,-42063);y=a(y,w,v,z,A[t+11],22,-1990404162);z=a(z,y,w,v,A[t+12],7,1804603682);v=a(v,z,y,w,A[t+13],12,-40341101);w=a(w,v,z,y,A[t+14],17,-1502002290);y=a(y,w,v,z,A[t+15],22,1236535329);z=h(z,y,w,v,A[t+1],5,-165796510);v=h(v,z,y,w,A[t+6],9,-1069501632);w=h(w,v,z,y,A[t+11],14,643717713);y=h(y,w,v,z,A[t+0],20,-373897302);z=h(z,y,w,v,A[t+5],5,-701558691);v=h(v,z,y,w,A[t+10],9,38016083);w=h(w,v,z,y,A[t+15],14,-660478335);y=h(y,w,v,z,A[t+4],20,-405537848);z=h(z,y,w,v,A[t+9],5,568446438);v=h(v,z,y,w,A[t+14],9,-1019803690);w=h(w,v,z,y,A[t+3],14,-187363961);y=h(y,w,v,z,A[t+8],20,1163531501);z=h(z,y,w,v,A[t+13],5,-1444681467);v=h(v,z,y,w,A[t+2],9,-51403784);w=h(w,v,z,y,A[t+7],14,1735328473);y=h(y,w,v,z,A[t+12],20,-1926607734);z=c(z,y,w,v,A[t+5],4,-378558);v=c(v,z,y,w,A[t+8],11,-2022574463);w=c(w,v,z,y,A[t+11],16,1839030562);y=c(y,w,v,z,A[t+14],23,-35309556);z=c(z,y,w,v,A[t+1],4,-1530992060);v=c(v,z,y,w,A[t+4],11,1272893353);w=c(w,v,z,y,A[t+7],16,-155497632);y=c(y,w,v,z,A[t+10],23,-1094730640);z=c(z,y,w,v,A[t+13],4,681279174);v=c(v,z,y,w,A[t+0],11,-358537222);w=c(w,v,z,y,A[t+3],16,-722521979);y=c(y,w,v,z,A[t+6],23,76029189);z=c(z,y,w,v,A[t+9],4,-640364487);v=c(v,z,y,w,A[t+12],11,-421815835);w=c(w,v,z,y,A[t+15],16,530742520);y=c(y,w,v,z,A[t+2],23,-995338651);z=m(z,y,w,v,A[t+0],6,-198630844);v=m(v,z,y,w,A[t+7],10,1126891415);w=m(w,v,z,y,A[t+14],15,-1416354905);y=m(y,w,v,z,A[t+5],21,-57434055);z=m(z,y,w,v,A[t+12],6,1700485571);v=m(v,z,y,w,A[t+3],10,-1894986606);w=m(w,v,z,y,A[t+10],15,-1051523);y=m(y,w,v,z,A[t+1],21,-2054922799);z=m(z,y,w,v,A[t+8],6,1873313359);v=m(v,z,y,w,A[t+15],10,-30611744);w=m(w,v,z,y,A[t+6],15,-1560198380);y=m(y,w,v,z,A[t+13],21,1309151649);z=m(z,y,w,v,A[t+4],6,-145523070);v=m(v,z,y,w,A[t+11],10,-1120210379);w=m(w,v,z,y,A[t+2],15,718787259);y=m(y,w,v,z,A[t+9],21,-343485551);z=j(z,r);y=j(y,q);w=j(w,p);v=j(v,o)};return[z,y,w,v]},f=function(r){var q='',s=-1,p=r.length,o,t;while(++s<p){o=r.charCodeAt(s);t=s+1<p?r.charCodeAt(s+1):0;if(55296<=o&&o<=56319&&56320<=t&&t<=57343){o=65536+((o&1023)<<10)+(t&1023);s++};if(o<=127){q+=String.fromCharCode(o)}else{if(o<=2047){q+=String.fromCharCode(192|((o>>>6)&31),128|(o&63))}else{if(o<=65535){q+=String.fromCharCode(224|((o>>>12)&15),128|((o>>>6)&63),128|(o&63))}else{if(o<=2097151){q+=String.fromCharCode(240|((o>>>18)&7),128|((o>>>12)&63),128|((o>>>6)&63),128|(o&63))}}}}};return q},e=function(p){var o=Array(p.length>>2),r,q;for(r=0,q=o.length;r<q;r++){o[r]=0};for(r=0,q=p.length*8;r<q;r+=8){o[r>>5]|=(p.charCodeAt(r/8)&255)<<(r%32)};return o},l=function(p){var o='';for(var r=0,q=p.length*32;r<q;r+=8){o+=String.fromCharCode((p[r>>5]>>>(r%32))&255)};return o},d=function(o){return l(b(e(o),o.length*8))},i=function(q){var t='0123456789abcdef',p='',o;for(var s=0,r=q.length;s<r;s++){o=q.charCodeAt(s);p+=t.charAt((o>>>4)&15)+t.charAt(o&15)};return p};return i(d(f(n)))}};VK.extend=function(target,source,overwrite){for(var key in source){if(overwrite||typeof target[key]==='undefined'){target[key]=source[key]}};return target};VK._protocol='https:';if(!VK.xdConnectionCallbacks){VK.extend(VK,{version:1,_apiId:null,_session:null,_userStatus:'unknown',_domain:{main:'https://oauth.vk.com/',api:'https://api.vk.com/'},_path:{login:'authorize',proxy:'fxdm_oauth_proxy.html'},_rootId:'vk_api_transport',_nameTransportPath:'',xdReady:false,access:{FRIENDS:0x2,PHOTOS:0x4,AUDIO:0x8,VIDEO:0x10,MATCHES:0x20,QUESTIONS:0x40,WIKI:0x80}});VK.init=function(options){var body,root;VK._apiId=null;if(!options.apiId){throw Error('VK.init() called without an apiId');};VK._apiId=options.apiId;if(options.onlyWidgets)return true;if(options.nameTransportPath&&options.nameTransportPath!==''){VK._nameTransportPath=options.nameTransportPath};root=document.getElementById(VK._rootId);if(!root){root=document.createElement('div');root.id=VK._rootId;body=document.getElementsByTagName('body')[0];body.insertBefore(root,body.childNodes[0])};root.style.position='absolute';root.style.top='-10000px';var session=VK.Cookie.load();if(session){VK.Auth._loadState='loaded';VK.Auth.setSession(session,session?'connected':'unknown')}};if(!VK.Cookie){VK.Cookie={_domain:null,load:function(){var cookie=document.cookie.match('\\bvk_app_'+VK._apiId+'=([^;]*)\\b'),session;if(cookie){session=this.decode(cookie[1]);if(session.secret!='oauth'){return false};session.expire=parseInt(session.expire,10);VK.Cookie._domain='.'+window.location.hostname};return session},setRaw:function(val,ts,domain,time){var rawCookie;rawCookie='vk_app_'+VK._apiId+'='+val+'';var exp=time?(new Date().getTime()+time*1000):ts*1000;rawCookie+=(val&&ts===0?'':'; expires='+new Date(exp).toGMTString());rawCookie+='; path=/';rawCookie+=(domain?'; domain=.'+domain:'');document.cookie=rawCookie;this._domain=domain},set:function(session,resp){if(session){this.setRaw(this.encode(session),session.expire,window.location.hostname,(resp||{}).time)}else{this.clear()}},clear:function(){this.setRaw('',0,this._domain,0)},encode:function(params){var pairs=[],key;for(key in params){if(key!='user')pairs.push(encodeURIComponent(key)+'='+encodeURIComponent(params[key]))};pairs.sort();return pairs.join('&')},decode:function(str){var params={},parts=str.split('&'),i,pair;for(i=0;i<parts.length;i++){pair=parts[i].split('=',2);if(pair&&pair[0]){params[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1])}};return params}}};if(!VK.Api){VK.Api={_headId:null,_callbacks:{},ie6_7:function(){if(!VK.Api.ieTested){VK.Api.isIE6_7=navigator.userAgent.match(/MSIE [6|7]/i);VK.Api.ieTested=true};return VK.Api.isIE6_7},supportCORS:function(){var xhr=new XMLHttpRequest();if('withCredentials' in xhr){return true};if(typeof XDomainRequest!='undefined'){return true};return false},makeRequest:function(url,cb){var xhr=VK.Api.createRequest('GET',url);if(!xhr){return false};xhr.onload=function(){var text=xhr.responseText;if(xhr.status===200){cb(text)}else{try{console.error('Open api access error',xhr.response)}catch(catch$scope$var751069445){}}};xhr.onerror=function(){try{console.error('Open api access error')}catch(catch$scope$var751069445){}};xhr.send();return true},createRequest:function(method,url){var xhr=new XMLHttpRequest();if('withCredentials' in xhr){xhr.open(method,url,true);xhr.withCredentials=true}else if(typeof XDomainRequest!='undefined'){xhr=new XDomainRequest();xhr.open(method,url);xhr.withCredentials=true}else{xhr=null};return xhr},attachScript:function(url){if(!VK.Api._headId)VK.Api._headId=document.getElementsByTagName('head')[0];var newScript=document.createElement('script');newScript.type='text/javascript';newScript.setAttribute('encoding','UTF-8');newScript.src=url;VK.Api._headId.appendChild(newScript)},checkMethod:function(method,params,cb,queryTry){var m=method.toLowerCase();if(m=='wall.post'||m=='activity.set'){var text=(m=='activity.set')?params.text:params.message;if(!text){text=''};var query=VK._protocol+'//vk.com/al_apps.php?act=wall_post_box&widget=4&method='+m+'&aid='+parseInt(VK._apiId,10)+'&text='+encodeURIComponent(text);if(m=='wall.post'){query+='&owner_id='+parseInt(params.owner_id||0,10)+'&attachments='+(params.attachments||params.attachment||'')+'&publish_date='+(params.publish_date||'')};var method_access='_'+(Math.random()).toString(16).substr(2);query+='&method_access='+method_access;var popup=VK.UI.popup({url:query,width:560,height:304});var timer=setInterval(function(){if(VK.UI.active.closed){clearInterval(timer);params.method_access=method_access;VK.Api.call(method,params,cb,queryTry)}},500);return false};if(m=='messages.allowmessagesfromgroup'){var method_access='_'+(Math.random()).toString(16).substr(2),query=VK._protocol+'//vk.com/widget_allow_messages_from_community.php?act=allow_box&group_id='+parseInt(params.group_id,10)+'&app_id='+parseInt(VK._apiId,10)+'&method_access='+method_access;VK.UI.popup({url:query,width:560,height:304});var timer=setInterval(function(){if(VK.UI.active.closed){clearInterval(timer);params.method_access=method_access;VK.Api.call(method,params,cb,queryTry)}},500);return false};return true},call:function(method,params,cb,queryTry){var query=params||{},qs,responseCb;if(typeof query!='object'||typeof cb!='function'){return false};if(!params.method_access&&!params.method_force&&!VK.Api.checkMethod(method,params,cb,queryTry)){return};if(!queryTry)queryTry=0;if(VK.Auth._loadState!='loaded'){var authFunc=function(result){if(result&&result.session){VK.Observer.unsubscribe('auth.loginStatus',authFunc);VK.Api.call(method,params,cb)}};VK.Observer.subscribe('auth.loginStatus',authFunc);VK.Auth.getLoginStatus();return};if(VK.Api.queryLength(query)<1500&&!VK.Api.ie6_7()){var useXDM=false,rnd=parseInt(Math.random()*10000000,10);while(VK.Api._callbacks[rnd]){rnd=parseInt(Math.random()*10000000,10)};query.callback='VK.Api.k$['+rnd+']'}else{var useXDM=true};if(VK._session&&VK._session.sid){query.access_token=VK._session.sid};qs=VK.Cookie.encode(query);responseCb=function(response){if(response.error&&(response.error.error_code==3||response.error.error_code==4||response.error.error_code==5)){if(queryTry>3)return false;var repeatCall=function(resp){VK.Observer.unsubscribe('auth.sessionChange',repeatCall);delete params.access_token;if(resp.session)VK.Api.call(method,params,cb,queryTry+1)};VK.Observer.subscribe('auth.sessionChange',repeatCall);VK.Auth.getLoginStatus()}else{cb(response)};if(!useXDM)delete VK.Api._callbacks[rnd]};if(useXDM){if(VK.xdReady){VK.XDM.remote.callMethod('apiCall',method,qs,responseCb)}else{VK.Observer.subscribe('xdm.init',function(){VK.XDM.remote.callMethod('apiCall',method,qs,responseCb)});VK.XDM.init()}}else{VK.Api._callbacks[rnd]=responseCb;VK.Api.attachScript(VK._domain.api+'method/'+method+'?'+qs)}},queryLength:function(query){var len=100,i;for(i in query){len+=i.length+encodeURIComponent(query[i]).length+1};return len}};VK.api=function(method,params,cb){VK.Api.call(method,params,cb)}};if(!VK.Auth){VK.Auth={popup:null,lsCb:{},setSession:function(session,status,settings,resp){var login=!VK._session&&session,logout=VK._session&&!session,both=VK._session&&session&&VK._session.mid!=session.mid,sessionChange=login||logout||(VK._session&&session&&VK._session.sid!=session.sid),statusChange=status!=VK._userStatus,response={'session':session,'status':status,'settings':settings};VK._session=session;VK._userStatus=status;VK.Cookie.set(session,resp);if(sessionChange||statusChange||both){setTimeout(function(){if(statusChange){VK.Observer.publish('auth.statusChange',response)};if(logout||both){VK.Observer.publish('auth.logout',response)};if(login||both){VK.Observer.publish('auth.login',response)};if(sessionChange){VK.Observer.publish('auth.sessionChange',response)}},0)};return response},login:function(cb,settings){if(!VK._apiId){return false};var url=VK._domain.main+VK._path.login+'?client_id='+VK._apiId+'&display=popup&redirect_uri=close.html&response_type=token';if(settings&&parseInt(settings,10)>0){url+='&scope='+settings};VK.Observer.unsubscribe('auth.onLogin');VK.Observer.subscribe('auth.onLogin',cb);VK.UI.popup({width:665,height:370,url:url});var authCallback=function(){VK.Auth.getLoginStatus(function(resp){VK.Observer.publish('auth.onLogin',resp);VK.Observer.unsubscribe('auth.onLogin')},true)};VK.UI.popupOpened=true;var popupCheck=function(){if(!VK.UI.popupOpened){return false};try{if(!VK.UI.active.top||VK.UI.active.closed){VK.UI.popupOpened=false;authCallback();return true}}catch(catch$scope$var751069445){VK.UI.popupOpened=false;authCallback();return true};setTimeout(popupCheck,100)};setTimeout(popupCheck,100)},logout:function(cb){VK.Auth.revokeGrants(cb)},revokeGrants:function(cb){var onLogout=function(resp){VK.Observer.unsubscribe('auth.statusChange',onLogout);if(cb){cb(resp)}};VK.Observer.subscribe('auth.statusChange',onLogout);if(VK._session&&VK._session.sid){var url='https://login.vk.com/?act=openapi&oauth=1&aid='+parseInt(VK._apiId,10)+'&location='+encodeURIComponent(window.location.hostname)+'&do_logout=1&token='+VK._session.sid;if(VK.Api.supportCORS()){var logoutCallback=function(){VK.Auth.setSession(null,'unknown')};VK.Api.makeRequest(url+'&new=1',logoutCallback)}else{VK.Api.attachScript(url)}};VK.Cookie.clear()},getSession:function(){return VK._session},getLoginStatus:function(cb,force){if(!VK._apiId){return};if(cb){if(!force&&VK.Auth._loadState=='loaded'){cb({status:VK._userStatus,session:VK._session});return}else{VK.Observer.subscribe('auth.loginStatus',cb)}};if(!force&&VK.Auth._loadState=='loading'){return};VK.Auth._loadState='loading';var url='https://login.vk.com/?act=openapi&oauth=1&aid='+parseInt(VK._apiId,10)+'&location='+encodeURIComponent(window.location.hostname);if(VK.Api.supportCORS()){var loginCallback=function(response){if(!this.JSON){this.JSON={}};if(typeof JSON.parse!=='function'){response=eval(response)}else{response=JSON.parse(response)};VK.Auth._loadState='loaded';if(response&&response.auth){var session={mid:response.user.id,sid:response.access_token,sig:response.sig,secret:response.secret,expire:response.expire};if(force){session.user=response.user};var status='connected'}else{var session=null,status=response.user?'not_authorized':'unknown';VK.Cookie.clear()};VK.Auth.setSession(session,status,false,response);VK.Observer.publish('auth.loginStatus',{session:session,status:status});VK.Observer.unsubscribe('auth.loginStatus')};VK.Api.makeRequest(url+'&new=1',loginCallback)}else{var rnd=parseInt(Math.random()*10000000,10);while(VK.Auth.lsCb[rnd]){rnd=parseInt(Math.random()*10000000,10)};VK.Auth.lsCb[rnd]=function(response){delete VK.Auth.lsCb[rnd];VK.Auth._loadState='loaded';if(response&&response.auth){var session={mid:response.user.id,sid:response.access_token,sig:response.sig,secret:response.secret,expire:response.expire};if(force)session.user=response.user;var status='connected'}else{var session=null,status=response.user?'not_authorized':'unknown';VK.Cookie.clear()};VK.Auth.setSession(session,status,false,response);VK.Observer.publish('auth.loginStatus',{session:session,status:status});VK.Observer.unsubscribe('auth.loginStatus')};VK.Api.attachScript(url+'&rnd='+rnd)}}}}}else{setTimeout(function(){var callback;while(callback=VK.xdConnectionCallbacks.pop()){callback()}},0);if(VK.Widgets&&!VK.Widgets._constructor){VK.Widgets=false}};if(!VK.UI){VK.UI={active:null,_buttons:[],popup:function(options){var screenX=typeof window.screenX!='undefined'?window.screenX:window.screenLeft,screenY=typeof window.screenY!='undefined'?window.screenY:window.screenTop,outerWidth=typeof window.outerWidth!='undefined'?window.outerWidth:document.body.clientWidth,outerHeight=typeof window.outerHeight!='undefined'?window.outerHeight:(document.body.clientHeight-22),width=options.width,height=options.height,left=parseInt(screenX+((outerWidth-width)/2),10),top=parseInt(screenY+((outerHeight-height)/2.5),10),features=('width='+width+',height='+height+',left='+left+',top='+top);this.active=window.open(options.url,'vk_openapi',features)},button:function(el,handler){var html='';if(typeof el=='string'){el=document.getElementById(el)};this._buttons.push(el);index=this._buttons.length-1;html=('<table cellspacing="0" cellpadding="0" id="openapi_UI_'+index+'" onmouseover="VK.UI.x$(1, '+index+');" onmouseout="VK.UI.x$(0, '+index+');" onmousedown="VK.UI.x$(2, '+index+');" onmouseup="VK.UI.x$(1, '+index+');" style="cursor: pointer; border: 0px; font-family: tahoma, arial, verdana, sans-serif, Lucida Sans; font-size: 10px;"><tr style="vertical-align: middle"><td><div style="border: 1px solid #3b6798;border-radius: 2px 0px 0px 2px;-moz-border-radius: 2px 0px 0px 2px;-webkit-border-radius: 2px 0px 0px 2px;"><div style="border: 1px solid #5c82ab; border-top-color: #7e9cbc; background-color: #6D8DB1; color: #fff; text-shadow: 0px 1px #45688E; height: 15px; padding: 2px 4px 0px 6px;line-height: 13px;">&#1042;&#1086;&#1081;&#1090;&#1080;</div></div></td><td><div style="background: url('+VK._protocol+'//vk.com/images/btns.png) 0px -42px no-repeat; width: 21px; height: 21px"></div></td><td><div style="border: 1px solid #3b6798;border-radius: 0px 2px 2px 0px;-moz-border-radius: 0px 2px 2px 0px;-webkit-border-radius: 0px 2px 2px 0px;"><div style="border: 1px solid #5c82ab; border-top-color: #7e9cbc; background-color: #6D8DB1; color: #fff; text-shadow: 0px 1px #45688E; height: 15px; padding: 2px 6px 0px 4px;line-height: 13px;">&#1050;&#1086;&#1085;&#1090;&#1072;&#1082;&#1090;&#1077;</div></div></td></tr></table>');el.innerHTML=html;el.style.width=el.childNodes[0].offsetWidth+'px'},_change:function(state,index){var row=document.getElementById('openapi_UI_'+index).rows[0],elems=[row.cells[0].firstChild.firstChild,row.cells[2].firstChild.firstChild];for(var i=0;i<2;++i){var elem=elems[i];if(state===0){elem.style.backgroundColor='#6D8DB1';elem.style.borderTopColor='#7E9CBC';elem.style.borderLeftColor=elem.style.borderRightColor=elem.style.borderBottomColor='#5C82AB'}else if(state==1){elem.style.backgroundColor='#7693B6';elem.style.borderTopColor='#88A4C4';elem.style.borderLeftColor=elem.style.borderRightColor=elem.style.borderBottomColor='#6088B4'}else if(state==2){elem.style.backgroundColor='#6688AD';elem.style.borderBottomColor='#7495B8';elem.style.borderLeftColor=elem.style.borderRightColor=elem.style.borderTopColor='#51779F'}};if(state===0||state==2){row.cells[2].firstChild.style.backgroundPosition='0px -42px'}else if(state==1){row.cells[2].firstChild.style.backgroundPosition='0px -63px'}}}};if(!VK.XDM){VK.XDM={remote:null,init:function(){if(this.remote)return false;var url=VK._domain.api+VK._path.proxy;this.remote=new fastXDM.Server({onInit:function(){VK.xdReady=true;VK.Observer.publish('xdm.init')}});this.remote.append(document.getElementById(VK._rootId),{src:url})},xdHandler:function(code){try{eval('VK.'+code)}catch(catch$scope$var751069445){}}}};if(!VK.Observer){VK.Observer={_subscribers:function(){if(!this._subscribersMap){this._subscribersMap={}};return this._subscribersMap},publish:function(eventName){var args=Array.prototype.slice.call(arguments),eventName=args.shift(),subscribers=this._subscribers()[eventName],i,j;if(!subscribers)return;for(i=0,j=subscribers.length;i<j;i++){if(subscribers[i]!=null){subscribers[i].apply(this,args)}}},subscribe:function(eventName,handler){var subscribers=this._subscribers();if(typeof handler!='function')return false;if(!subscribers[eventName]){subscribers[eventName]=[handler]}else{subscribers[eventName].push(handler)}},unsubscribe:function(eventName,handler){var subscribers=this._subscribers()[eventName],i,j;if(!subscribers)return false;if(typeof handler=='function'){for(i=0,j=subscribers.length;i<j;i++){if(subscribers[i]==handler){subscribers[i]=null}}}else{delete this._subscribers()[eventName]}}}};if(!VK.Widgets){VK.Widgets={};VK.Widgets.count=0;VK.Widgets.RPC={};VK.Widgets.showBoxUrl=function(domain,url){domain=(domain||VK._protocol+'//vk.com').replace(/\/?\s*$/,'');url=url.replace(/^\s*\/?/,'');return domain+'/'+url};VK.Widgets.loading=function(obj,enabled){obj.style.background=enabled?'url("'+VK._protocol+'//vk.com/images/upload.gif") center center no-repeat transparent':'none'};VK.Widgets.Comments=function(objId,options,page){var pData=VK.Util.getPageData();if(!VK._apiId)throw Error('VK not initialized. Please use VK.init');options=options||{};var obj=document.getElementById(objId),params={limit:options.limit||10,height:options.height||0,mini:options.mini===undefined?'auto':options.mini,norealtime:options.norealtime?1:0},mouseup=function(){rpc.callMethod('mouseUp');return false},move=function(event){rpc.callMethod('mouseMove',{screenY:event.screenY})},iframe,rpc;if(options.browse){params.browse=1;params.replies=options.replies||0}else{var url=options.pageUrl||pData.url;if(url.substr(0,1)=='/'){url=(location.protocol+'//'+location.host)+url};VK.extend(params,{page:page||0,status_publish:options.autoPublish===undefined?0:options.autoPublish,attach:options.attach===undefined?'*':(options.attach?options.attach:''),url:url,title:options.pageTitle||pData.title,description:options.pageDescription||pData.description,image:options.pageImage||pData.image})};if(options.onChange){VK.Observer.subscribe('widgets.comments.new_comment',options.onChange);VK.Observer.subscribe('widgets.comments.delete_comment',options.onChange)};return VK.Widgets._constructor('widget_comments.php',objId,options,params,{showBox:function(url,props){var box=VK.Util.Box(VK.Widgets.showBoxUrl(options.base_domain,url),[],{proxy:function(){rpc.callMethod.apply(rpc,arguments)}});box.show()},startDrag:function(){cursorBack=window.document.body.style.cursor;window.document.body.style.cursor='pointer';VK.Util.addEvent('mousemove',move);VK.Util.addEvent('mouseup',mouseup)},stopDrag:function(){window.document.body.style.cursor=cursorBack;VK.Util.removeEvent('mousemove',move);VK.Util.removeEvent('mouseup',mouseup)}},{startHeight:133,minWidth:300},function(o,i,r){iframe=i;rpc=r})};VK.Widgets.CommentsBrowse=function(objId,options){options=options||{};options.browse=1;return VK.Widgets.Comments(objId,options)};VK.Widgets.Recommended=function(objId,options){var pData=VK.Util.getPageData();if(!VK._apiId)throw Error('VK not initialized. Please use VK.init');options=options||{};var params={limit:options.limit||5,max:options.max||0,sort:options.sort||'friend_likes',verb:options.verb||0,period:options.period||'week',target:options.target||'parent'};return VK.Widgets._constructor('widget_recommended.php',objId,options,params,{},{startHeight:(116+params.limit*47-15),minWidth:150})};VK.Widgets.Post=function(objId,ownerId,postId,hash,options){options=options||{};var obj=document.getElementById(objId),params={owner_id:ownerId,post_id:postId,hash:hash||''},iframe,rpc,cursorBack;if(options.preview){params.preview=1;delete options['preview']};return VK.Widgets._constructor('widget_post.php',objId,options,params,{showBox:function(url,props){var box=VK.Util.Box(VK.Widgets.showBoxUrl(options.base_domain,url),[],{proxy:function(){rpc.callMethod.apply(rpc,arguments)}});box.show()},startDrag:function(){cursorBack=window.document.body.style.cursor;window.document.body.style.cursor='pointer'},stopDrag:function(){window.document.body.style.cursor=cursorBack}},{startHeight:90,minWidth:250},function(o,i,r){iframe=i;rpc=r})};VK.Widgets.Like=(function(Like){if(Like)return Like;var instances=[];Like=function(objId,options,page){var pData=VK.Util.getPageData();if(!VK._apiId)throw Error('VK not initialized. Please use VK.init');options=VK.extend(options||{},{allowTransparency:true});var verticalBtnHeightWidth={18:43,20:47,22:51,24:55,30:67,},type=(options.type=='full'||options.type=='button'||options.type=='vertical'||options.type=='mini')?options.type:'full',autoWidth=options.width==='auto'&&(type=='button'||type=='mini'),btnHeight=parseInt(options.height,10)||22,size=btnHeight&&verticalBtnHeightWidth[btnHeight]?btnHeight:22,width=autoWidth?153:(type=='full'?Math.max(200,options.width||350):(type=='button'?180:(type=='mini'?115:verticalBtnHeightWidth[size]))),height=type=='vertical'?(2*btnHeight+7):btnHeight,params={page:page||0,url:options.pageUrl||pData.url,type:type,verb:options.verb==1?1:0,color:options.color||'',title:options.pageTitle||pData.title,description:options.pageDescription||pData.description,image:options.pageImage||pData.image,text:(options.text||'').substr(0,140),h:btnHeight},ttHere=options.ttHere||false,isOver=false,hideTimeout=null,obj,buttonIfr,buttonRpc,tooltipIfr,tooltipRpc,checkTO,statsBox;if(type=='vertical'||type=='button'||type=='mini')delete options.width;if(autoWidth)params.auto_width=1;function showTooltip(force){if((!isOver&&!force)||!tooltipRpc)return;if(!tooltipIfr||!tooltipRpc||tooltipIfr.style.display!='none'&&tooltipIfr.getAttribute('vkhidden')!='yes')return;hideTimeout&&clearTimeout(hideTimeout);checkTO&&clearTimeout(checkTO);var scrollTop=options.getScrollTop?options.getScrollTop():(document.body.scrollTop||document.documentElement.scrollTop||0),objPos=VK.Util.getXY(obj,options.fixed),startY=ttHere?0:objPos[1];if(scrollTop>objPos[1]-120&&options.tooltipPos!='top'||type=='vertical'||options.tooltipPos=='bottom'){tooltipIfr.style.top=(startY+height+2)+'px';tooltipRpc.callMethod('show',false,type+'_'+size)}else{tooltipIfr.style.top=(startY-128)+'px';tooltipRpc.callMethod('show',true,type+'_'+size)};VK.Util.ss(tooltipIfr,{left:(ttHere?0:objPos[0])-(type=='full'||type=='button'?32:2)+'px',display:'block',opacity:1,filter:'none'});tooltipIfr.setAttribute('vkhidden','no');isOver=true};function hideTooltip(force){if((isOver&&!force)||!tooltipRpc)return;tooltipRpc.callMethod('hide');buttonRpc.callMethod('hide');hideTimeout=setTimeout(function(){tooltipIfr.style.display='none'},400)};function handleStatsBox(act){hideTooltip(true);statsBox=VK.Util.Box(buttonIfr.src+'&act=a_stats_box&widget_width=638&from=wlike');statsBox.show()};var widgetId=VK.Widgets._constructor('widget_like.php',objId,options,params,{initTooltip:function(counter){tooltipRpc=new fastXDM.Server({onInit:counter?function(){showTooltip()}:function(){},proxy:function(){buttonRpc.callMethod.apply(buttonRpc,arguments)},showBox:function(url,props){var box=VK.Util.Box(VK.Widgets.showBoxUrl(options.base_domain,url),[props.width,props.height],{proxy:function(){tooltipRpc.callMethod.apply(tooltipRpc,arguments)}});box.show()},statsBox:handleStatsBox},false,{safe:true});tooltipIfr=tooltipRpc.append(ttHere?obj:document.body,{src:buttonIfr.src+'&act=a_like_tooltip',scrolling:'no',allowTransparency:true,id:buttonIfr.id+'_tt',style:{position:'absolute',padding:0,display:'none',opacity:0.01,filter:'alpha(opacity=1)',border:'0',width:'274px',height:'130px',zIndex:5000,overflow:'hidden'}});tooltipIfr.setAttribute('vkhidden','yes');tooltipIfr.onmouseover=function(){clearTimeout(checkTO);isOver=true};tooltipIfr.onmouseout=function(){clearTimeout(checkTO);isOver=false;checkTO=setTimeout(function(){hideTooltip()},200)}},statsBox:handleStatsBox,showTooltip:showTooltip,hideTooltip:hideTooltip,destroy:function(){buttonRpc.destroy();try{buttonIfr.src='about: blank;'}catch(catch$scope$var751069445){};buttonIfr.parentNode.removeChild(buttonIfr);if(tooltipIfr){try{tooltipIfr.src='about: blank;'}catch(catch$scope$var751069445){};tooltipIfr.parentNode.removeChild(tooltipIfr)};tooltipRpc&&tooltipRpc.destroy();if(statsBox){if(statsBox.iframe){try{statsBox.iframe.src='about: blank;'}catch(catch$scope$var751069445){};statsBox.iframe.parentNode.removeChild(statsBox.iframe)};statsBox.rpc&&statsBox.rpc.destroy()}},showBox:function(url,props){var box=VK.Util.Box(VK.Widgets.showBoxUrl(options.base_domain,url),[],{proxy:function(){buttonRpc.callMethod.apply(buttonRpc,arguments)}});box.show()},proxy:function(){if(tooltipRpc)tooltipRpc.callMethod.apply(tooltipRpc,arguments)}},{startHeight:height,minWidth:width},function(o,i,r){buttonRpc=r;VK.Util.ss(obj=o,{height:height+'px',width:width+'px',position:'relative',clear:'both'});VK.Util.ss(buttonIfr=i,{height:height+'px',width:width+'px',overflow:'hidden',zIndex:150});obj.onmouseover=function(){clearTimeout(checkTO);isOver=true};obj.onmouseout=function(){clearTimeout(checkTO);isOver=false;checkTO=setTimeout(function(){hideTooltip()},200)}});instances.push(widgetId);return widgetId};Like.destroyAll=function(){var xdm=null;while(instances[0]){xdm=VK.Widgets.RPC[instances.pop()];xdm&&xdm.methods.destroy()}};return Like})(VK.Widgets.Like);VK.Widgets.Poll=function(objId,options,pollId){var pData=VK.Util.getPageData();if(!pollId)throw Error('No poll id passed');options=options||{};var params={poll_id:pollId,url:options.pageUrl||pData.url||location.href,title:options.pageTitle||pData.title,description:options.pageDescription||pData.description};return VK.Widgets._constructor('al_widget_poll.php',objId,options,params,{},{startHeight:144,minWidth:300})};VK.Widgets.Community=VK.Widgets.Group=function(objId,options,gid){gid=parseInt(gid,10);if(!gid){throw Error('No group_id passed');};options.mode=parseInt(options.mode,10).toString();var params={gid:gid,mode:(options.mode)?options.mode:'0'},startHeight=options.mode==3?185:(options.mode==1?141:options.height|0||290),rpc;if(options.wall)params.wall=options.wall;params.color1=options.color1||'';params.color2=options.color2||'';params.color3=options.color3||'';params.class_name=options.class_name||'';if(options.no_head)params.no_head=1;if(options.no_cover)params.no_cover=1;if(options.wide){params.wide=1;if(!options.width||options.width<300){options.width=300}};if(!options.width|0)options.width=200;var cursorBack;function mouseup(){rpc.callMethod('mouseUp');return false};function move(event){rpc.callMethod('mouseMove',{screenY:event.screenY});return false};return VK.Widgets._constructor('widget_community.php',objId,options,params,{showBox:function(url,props){var box=VK.Util.Box(VK.Widgets.showBoxUrl(options.base_domain,url),[],{proxy:function(){rpc.callMethod.apply(rpc,arguments)}});box.show()},startDrag:function(){cursorBack=window.document.body.style.cursor;window.document.body.style.cursor='pointer';VK.Util.addEvent('mousemove',move);VK.Util.addEvent('mouseup',mouseup)},stopDrag:function(){window.document.body.style.cursor=cursorBack;VK.Util.removeEvent('mousemove',move);VK.Util.removeEvent('mouseup',mouseup)},auth:function(){VK.Auth.login(null,1)}},{minWidth:120,startHeight:startHeight},function(o,i,r){rpc=r})};VK.Widgets.Auth=function(objId,options){var pData=VK.Util.getPageData();if(!VK._apiId)throw Error('VK not initialized. Please use VK.init');if(!options.width){options.width=200};if(options.type){type=1}else{type=0};return VK.Widgets._constructor('widget_auth.php',objId,options,{},{makeAuth:function(data){if(data.session){VK.Auth._loadState='loaded';VK.Auth.setSession(data.session,'connected');VK.Observer.publish('auth.loginStatus',{session:data.session,status:'connected'});VK.Observer.unsubscribe('auth.loginStatus')};if(options.onAuth){options.onAuth(data)}else{if(options.authUrl){var href=options.authUrl}else{var href=window.location.href};if(href.indexOf('?')==-1){href+='?'}else{href+='&'};var vars=[];for(var i in data){if(i!='session')vars.push(i+'='+decodeURIComponent(data[i]).replace(/&/g,'%26').replace(/\#/g,'%23').replace(/\?/,'%3F'))};window.location.href=href+vars.join('&')}}},{startHeight:134})};VK.Widgets.Subscribe=function(objId,options,oid){oid=parseInt(oid,10);if(!oid){throw Error('No owner_id passed');};var params={oid:oid},rpc;if(options.mode){params.mode=options.mode};if(options.soft){params.soft=options.soft};return VK.Widgets._constructor('widget_subscribe.php',objId,options,params,{showBox:function(url,props){var box=VK.Util.Box(VK.Widgets.showBoxUrl(options.base_domain,url),[],{proxy:function(){rpc.callMethod.apply(rpc,arguments)}});box.show()},auth:function(){VK.Auth.login(null,1)}},{minWidth:220,startHeight:22},function(o,i,r){rpc=r})};VK.Widgets.ContactUs=function(objId,options,oid){oid=parseInt(oid,10);if(!options)options={};if(!oid)throw Error('No group or user id passed');var params={oid:oid,height:({18:18,20:20,22:22,24:24,30:30})[parseInt(options.height,10)||24],text:(options.text||'').substr(0,140)},rpc;return VK.Widgets._constructor('widget_contactus.php',objId,options,params,{},{startHeight:params.height,height:params.height},function(o,i,r){rpc=r})};VK.Widgets.Playlist=function(objId,ownerId,playlistId,hash,options){var params={oid:parseInt(ownerId,10),pid:parseInt(playlistId,10),hash:hash||''},rpc;if(!options)options={};if(!params.oid)throw Error('No owner id passed');if(!params.pid)throw Error('No playlist id passed');return VK.Widgets._constructor('widget_playlist.php',objId,options,params,{showBox:function(url,props){var box=VK.Util.Box(VK.Widgets.showBoxUrl(options.base_domain,url),[],{proxy:function(){rpc.callMethod.apply(rpc,arguments)}});box.show()}},{minWidth:200},function(o,i,r){rpc=r})};VK.Widgets.Ads=function(objId,options,paramsExtra){options=options||{};paramsExtra=paramsExtra||{};var params={};var defaults={};var funcs={};var obj=document.getElementById(objId),iframe,rpc,adsParams={};var adsParamsLocal={};var adsParamsDefault={};for(var key in paramsExtra){var keyFix=(inArray(key,['hash'])?key:'ads_'+key);adsParams[keyFix]=paramsExtra[key]};if(obj&&obj.getBoundingClientRect){obj.style.width='100%';obj.style.height='100%';var rect=obj.getBoundingClientRect();obj.style.width='';obj.style.height='';adsParams.ads_ad_unit_width_auto=Math.floor(rect.right-rect.left);adsParams.ads_ad_unit_height_auto=Math.floor(rect.bottom-rect.top)};adsParamsDefault.ads_ad_unit_width=100;adsParamsDefault.ads_ad_unit_height=100;adsParamsLocal.ads_ad_unit_width=(parseInt(adsParams.ads_ad_unit_width)||adsParams.ads_ad_unit_width==='auto'&&adsParams.ads_ad_unit_width_auto||adsParamsDefault.ads_ad_unit_width);adsParamsLocal.ads_ad_unit_height=(parseInt(adsParams.ads_ad_unit_height)||adsParams.ads_ad_unit_height==='auto'&&adsParams.ads_ad_unit_height_auto||adsParamsDefault.ads_ad_unit_height);if(adsParams.ads_handler){adsParamsLocal.ads_handler=adsParams.ads_handler};if(adsParams.ads_handler_empty_html){adsParamsLocal.ads_handler_empty_html=adsParams.ads_handler_empty_html};delete adsParams.ads_handler;delete adsParams.ads_handler_empty_html;params.act='ads_web';params.url=location.href;VK.extend(params,adsParams);options.noDefaultParams=true;options.width=adsParamsLocal.ads_ad_unit_width;options.allowTransparency=true;defaults.startHeight=adsParamsLocal.ads_ad_unit_height;defaults.minWidth=adsParamsLocal.ads_ad_unit_width;funcs.adsOnInitLoader=adsOnInitLoader;funcs.adsOnInit=adsOnInit;return VK.Widgets._constructor('ads_rotate.php',objId,options,params,funcs,defaults,onDone);function adsOnInitLoader(adsScriptVersion){VK.Widgets.loading(obj,true);adsAttachScript(adsScriptVersion)};function adsOnInit(errorCode,adsParamsExport){VK.Widgets.loading(obj,false);adsProcessParams(adsParamsExport);if(options.onAdsReady)options.onAdsReady.apply(options.onAdsReady,Array.prototype.slice.call(arguments));adsProcessHandler(errorCode)};function adsAttachScript(adsScriptVersion){if(!('vk__adsLight' in window)){window.vk__adsLight=false;adsScriptVersion=parseInt(adsScriptVersion);var attachScriptFunc=(VK.Api&&VK.Api.attachScript||VK.addScript),base_domain=(options.base_domain||VK._protocol+'//vk.com');attachScriptFunc(base_domain+'/js/al/aes_light.js?'+adsScriptVersion)}else if(window.vk__adsLight&&vk__adsLight.userHandlers&&vk__adsLight.userHandlers.onInit){vk__adsLight.userHandlers.onInit(false)}};function adsProcessParams(adsParamsExport){if(!adsParamsExport){return};for(var paramName in adsParamsExport){var paramValue=adsParamsExport[paramName];if(paramName==='ads_ad_unit_width'||paramName==='ads_ad_unit_height'){if(!(paramName in adsParams)){adsParamsLocal[paramName]=(parseInt(paramValue)||paramValue==='auto'&&adsParams[paramName+'_auto']||adsParamsDefault[paramName])}}else{if(!(paramName in adsParamsLocal)){adsParamsLocal[paramName]=paramValue}}}};function adsProcessHandler(errorCode){var handlerResult=adsEvalHandler(adsParamsLocal.ads_handler,errorCode);if(errorCode<=0&&handlerResult!==true){try{console.log('VK: ad_unit_id = '+adsParams.ads_ad_unit_id,', errorCode = ',errorCode)}catch(catch$scope$var751069445){};adsInsertHtmlHandler(adsParamsLocal.ads_handler_empty_html,adsParamsLocal.ads_ad_unit_width,adsParamsLocal.ads_ad_unit_height)}};function adsEvalHandler(handler){var result=false;try{if(!handler){return false};var func=false;if(isFunction(handler)){func=handler}else if(isString(handler)){var handlerFuncs=handler.split('.');func=window;for(var i=0,len=handlerFuncs.length;i<len;i++){func=func[handlerFuncs[i]];if(!func){break}};if(!func){if(handler.substr(0,8)==='function'){handler='return '+handler+';'};var handlerResult=(new Function(handler))();if(isFunction(handlerResult)){func=handlerResult}else{result=handlerResult}}};if(func){var args=Array.prototype.slice.call(arguments,1);result=func.apply(func,args)}}catch(catch$scope$var751069445){try{console.error(catch$scope$var751069445)}catch(catch$scope$var751069445){}};return result;function isFunction(obj){return Object.prototype.toString.call(obj)==='[object Function]'};function isString(obj){return Object.prototype.toString.call(obj)==='[object String]'}};function adsInsertHtmlHandler(handlerHtml,width,height){if(!handlerHtml){return};if(!obj){return};width=(width?width+'px':'');height=(height?height+'px':'');var iframeHandlerHtml='<html><head></head><body style="padding: 0; margin: 0;"><div>'+handlerHtml+'</div></body></html>',iframeHandler=document.createElement('iframe');iframeHandler.onload=fixIframeHeight;iframeHandler.id=(iframe?iframe.id:('vkwidget-'+Math.round(Math.random()*1000000)))+'_ads_html_handler';iframeHandler.src='about:blank';iframeHandler.width='100%';iframeHandler.height='100%';iframeHandler.scrolling='no';iframeHandler.frameBorder='0';iframeHandler.allowTransparency=true;iframeHandler.style.overflow='hidden';iframeHandler.style.width=width;iframeHandler.style.height=height;obj.style.width=width;obj.style.height=height;obj.appendChild(iframeHandler);iframeHandler.contentWindow.vk_ads_html_handler=iframeHandlerHtml;iframeHandler.src='javascript:window["vk_ads_html_handler"]';function fixIframeHeight(){if(height){return};try{var rect=iframeHandler.contentWindow.document.body.firstChild.getBoundingClientRect(),heightFix=Math.ceil(rect.bottom-rect.top);if(heightFix){iframeHandler.style.height=heightFix;obj.style.height=heightFix}}catch(catch$scope$var751069445){}}};function indexOf(arr,value,from){for(var i=from||0,l=(arr||[]).length;i<l;i++){if(arr[i]==value)return i};return-1};function inArray(value,arr){return indexOf(arr,value)!=-1};function onDone(o,i,r){obj=o;iframe=i;rpc=r}};VK.Widgets.AllowMessagesFromCommunity=function(objId,options,groupId){groupId=parseInt(groupId,10);if(!options)options={};if(!groupId||groupId<0)throw Error('No group id passed');var params={height:({22:22,24:24,30:30})[parseInt(options.height,10)||24],key:options.key?options.key.substr(0,256):'',group_id:groupId},rpc;return VK.Widgets._constructor('widget_allow_messages_from_community.php',objId,options,params,{},{startHeight:params.height,height:params.height},function(o,i,r){rpc=r})};VK.Widgets.CommunityMessages=(function(CommunityMessages){if(CommunityMessages)return CommunityMessages;var instances={},wCur={};var BUTTONS_CONF={no_button:{width:0,height:0},blue_circle:{width:50,height:50,margin:{bottom:20}}},DEFAULT_BUTTON_TYPE='blue_circle',BUTTON_POSITIONS={left:{bottom:0,left:20},right:{bottom:0,right:20}},DEFAULT_BUTTON_POSITION='right';CommunityMessages=function(objId,gid,options){options=options||{};options.width=300;options.height=399;if(!options.base_domain){options.base_domain=options.base_domain||VK._protocol+'//vk.com'};options.expandTimeout=parseInt(options.expandTimeout)||0;var params={gid:gid};options.expanded=parseInt(options.expanded)||0;if(!options.from_dev&&lsGet('expanded')!=null||options.expanded){options.shown=1};if(options.shown){params.shown=1};if(!options.welcomeScreen){params.disable_welcome_screen=1};var buttonType=options.buttonType;if(Object.keys(BUTTONS_CONF).indexOf(buttonType)==-1){buttonType=DEFAULT_BUTTON_TYPE};if(buttonType=='no_button'){options.disableButtonTooltip=1};if(options.disableButtonTooltip){params.disable_tooltip=1};if(options.tooltipButtonText){params.tooltip_text=options.tooltipButtonText};if(options.disableNewMessagesSound){params.disable_new_messages_sound=1};if(instances[objId]){CommunityMessages.destroy(objId)};params.domain=document.domain;options.no_loading=1;var curBox=false,expanded=0,ttSize=[0,0],widgetPosition;changeWidgetPosition(options.widgetPosition);params.button_position=options.widgetPosition;var chatRpc,chatIfr,inited=0,timers={};instances[objId]=VK.Widgets._constructor('widget_community_messages.php',objId,options,params,{onStartLoading:function(){var obj=document.getElementById(objId);obj.style.position='fixed';obj.style['z-index']=10000;updateWidgetPosition()},onReady:function(){inited=1;if(options.expandTimeout>0&&!options.shown){timers.showTimer=setTimeout(function(){expandChat({playSong:!options.disableExpandChatSound,noSaveState:1})},options.expandTimeout)}},showBox:function(url){if(curBox){try{curBox.hide();try{curBox.iframe.src='about: blank;'}catch(catch$scope$var751069445){};curBox.iframe.parentNode.removeChild(curBox.iframe)}catch(catch$scope$var751069445){}};curBox=VK.Util.Box(VK.Widgets.showBoxUrl(options.base_domain,url),[],{proxy:function(){rpc.callMethod.apply(rpc,arguments)}});curBox.show()},setTooltipSize:function(size){ttSize=size;if(!expanded){minimize()}},expand:function(opts){opts=opts||{};expanded=1;expand();if(!opts.noSaveState){lsSet('expanded',1)}},minimize:function(){setTimeout(function(){expanded=0;minimize(objId);lsRemove('expanded')},120)},canNotWrite:function(type){options.onCanNotWrite&&options.onCanNotWrite(type)},destroy:function(){chatRpc.destroy();try{chatIfr.src='about: blank;'}catch(catch$scope$var751069445){};try{chatIfr.parentNode.removeChild(chatIfr)}catch(catch$scope$var751069445){}},fatalError:function(error_code,public_id){var query={code:error_code,widget:2,public_id:public_id,};if(error_code==1903){query.referrer_domain=document.domain};var query_str=[];for(var i in query){query_str.push(i+'='+query[i])};CommunityMessages.destroy(objId);var box=VK.Util.Box(VK.Widgets.showBoxUrl(options.base_domain,'blank.php?'+query_str.join('&')));box.show()},setPageTitle:function(title){if(options.disableTitleChange){return};stopTitleAnimation();wCur.oldTitle=document.title||null;wCur.title=title;wCur.changeTitleMode=0;startTitleNotify(1)},resetPageTitle:function(){stopTitleAnimation()},newMessage:function(){if(document.hasFocus&&!document.hasFocus()&&!options.disableNewMessagesSound){callRpcMethod('playNewMsgSong')}}},{},function(o,i,r){chatRpc=r;chatIfr=i;if(!options.shown){minimize()}else{expand()}});function startTitleNotify(fast){clearTimeout(wCur.titleTimer);wCur.titleTimer=setTimeout(function(){if(wCur.changeTitleMode==1){document.title=wCur.oldTitle||''}else{document.title=wCur.title};wCur.changeTitleMode=wCur.changeTitleMode==1?0:1;startTitleNotify()},fast?0:1500)};function stopTitleAnimation(){if(options.disableTitleChange){return};clearTimeout(wCur.titleTimer);if(wCur.oldTitle){document.title=wCur.oldTitle}else if(wCur.oldTitle===null){document.title=''};wCur.title=''};function expand(){var obj=document.getElementById(objId),frame=obj.getElementsByTagName('iframe')[0];obj.style.width=frame.width='372px';obj.style.height=frame.height='399px';obj.style.margin='0px 0px 0px 0px'};function minimize(){var obj=document.getElementById(objId),frame=obj.getElementsByTagName('iframe')[0],btnConf=BUTTONS_CONF[buttonType],w=btnConf.width+ttSize[0],h=Math.max(btnConf.height,ttSize[1]);obj.style.width=w+'px';obj.style.height=h+'px';frame.style.boxShadow='none';var margin=btnConf.margin?btnConf.margin:{};obj.style.margin='0px '+(margin.right||0)+'px '+(margin.bottom||0)+'px 0px';if(frame){frame.width=w;frame.height=h}};function changeWidgetPosition(position){widgetPosition=position;if(Object.keys(BUTTON_POSITIONS).indexOf(widgetPosition)==-1){widgetPosition=DEFAULT_BUTTON_POSITION};updateWidgetPosition();callRpcMethod('changeButtonPosition',widgetPosition)};function updateWidgetPosition(){var obj=document.getElementById(objId);if(!obj){return};var props=['left','right','top','bottom'];for(var i in props){obj.style[props[i]]=''};var conf=BUTTON_POSITIONS[widgetPosition];for(var i in conf){obj.style[i]=conf[i]+'px'};if(!inited){return};if(expanded){expand()}else{minimize()}};function callRpcMethod(){chatRpc&&chatRpc.callMethod.apply(chatRpc,arguments)};function expandChat(opts){if(!opts||Object.prototype.toString.call(opts)!=='[object Object]'){opts={}};if(opts.welcomeScreen==undefined){opts.welcomeScreen=options.welcomeScreen};clearTimeout(timers.showTimer);callRpcMethod('expand',opts)};function minimizeChat(){callRpcMethod('minimize')};function destroyChat(){stopTitleAnimation();CommunityMessages.destroy(objId)};return{expand:expandChat,minimize:minimizeChat,destroy:destroyChat,changeButtonPosition:changeWidgetPosition,stopTitleAnimation:stopTitleAnimation,}};function lsGet(key){if(!window.localStorage){return null};return localStorage.getItem('vk_community_widget_'+key)};function lsSet(key,value){window.localStorage&&localStorage.setItem('vk_community_widget_'+key,value)};function lsRemove(key){window.localStorage&&localStorage.removeItem('vk_community_widget_'+key)};CommunityMessages.destroy=function(objId){if(!instances[objId]){return};var xdm=VK.Widgets.RPC[instances[objId]];xdm&&xdm.methods.destroy();delete instances[objId]};CommunityMessages.expand=function(objId){console.log(instances[objId])};return CommunityMessages})(VK.Widgets.CommunityMessages);VK.Widgets._constructor=function(widgetUrl,objId,options,params,funcs,defaults,onDone,widgetId,iter){var obj=document.getElementById(objId);widgetId=widgetId||(++VK.Widgets.count);if(!obj){iter=iter||0;if(iter>10){throw Error('VK.Widgets: object #'+objId+' not found.');};setTimeout(function(){VK.Widgets._constructor(widgetUrl,objId,options,params,funcs,defaults,onDone,widgetId,iter+1)},500);return widgetId};options=options||{};defaults=defaults||{};funcs=funcs||{};var ifr,url,urlQueryString,encodedParam,rpc,iframe,i,base_domain=options.base_domain||VK._protocol+'//vk.com',width=options.width==='auto'?(obj.clientWidth||obj.offsetWidth||defaults.minWidth)|0:parseInt(options.width||0,10);width=width?(Math.max(defaults.minWidth||200,Math.min(defaults.maxWidth||10000,width))+'px'):'100%';obj.style.width=width;if(options.height){params.height=options.height;obj.style.height=options.height+'px'}else{obj.style.height=(defaults.startHeight||200)+'px'};if(width==='100%')params.startWidth=(obj.clientWidth||obj.offsetWidth)|0;if(!params.url)params.url=options.pageUrl||location.href.replace(/#.*$/,'');url=base_domain+'/'+widgetUrl;urlQueryString='';if(!options.noDefaultParams){urlQueryString+='&app='+(VK._apiId||'0')+'&width='+encodeURIComponent(width)};urlQueryString+='&_ver='+VK.version;if(VK._iframeAppWidget){params.iframe_app=1};var pData=VK.Util.getPageData();params.url=params.url||pData.url||'';params.referrer=params.referrer||document.referrer||'';params.title=params.title||pData.title||document.title||'';for(i in params){if(i=='title'&&params[i].length>80)params[i]=params[i].substr(0,80)+'...';if(i=='description'&&params[i].length>160)params[i]=params[i].substr(0,160)+'...';if(typeof(params[i])=='number'){encodedParam=params[i]}else{try{encodedParam=encodeURIComponent(params[i])}catch(catch$scope$var751069445){encodedParam=''}};urlQueryString+='&'+i+'='+encodedParam};urlQueryString+='&'+(+new Date()).toString(16);url+='?'+urlQueryString.substr(1);funcs.onStartLoading&&funcs.onStartLoading();if(!options.no_loading){VK.Widgets.loading(obj,true)};funcs.showLoader=function(enable){VK.Util.Loader(enable)};funcs.publish=function(){var args=Array.prototype.slice.call(arguments);args.push(widgetId);VK.Observer.publish.apply(VK.Observer,args)};funcs.onInit=function(){VK.Widgets.loading(obj,false);if(funcs.onReady)funcs.onReady();if(options.onReady)options.onReady()};funcs.resize=function(e,cb){obj.style.height=e+'px';var el=document.getElementById('vkwidget'+widgetId);if(el){el.style.height=e+'px'}};funcs.resizeWidget=function(newWidth,newHeight){newWidth=parseInt(newWidth);newHeight=parseInt(newHeight);var widgetElem=document.getElementById('vkwidget'+widgetId);if(isFinite(newWidth)){obj.style.width=newWidth+'px';if(widgetElem){widgetElem.style.width=newWidth+'px'}};if(isFinite(newHeight)){obj.style.height=newHeight+'px';if(widgetElem){widgetElem.style.height=newHeight+'px'}};if(options.onResizeWidget)options.onResizeWidget()};funcs.updateVersion=function(ver){if(ver>1){VK.Api.attachScript('//vk.com/js/api/openapi_update.js?'+parseInt(ver))}};rpc=VK.Widgets.RPC[widgetId]=new fastXDM.Server(funcs,function(origin){if(!origin)return true;origin=origin.toLowerCase();return(origin.match(/(\.|\/)vk\.com($|\/|\?)/))},{safe:true});iframe=VK.Widgets.RPC[widgetId].append(obj,{src:url,width:(width.indexOf('%')!=-1)?width:(parseInt(width)||width),height:defaults.startHeight||'100%',scrolling:'no',id:'vkwidget'+widgetId,allowTransparency:options.allowTransparency||false,style:{overflow:'hidden'}});onDone&&setTimeout(function(){onDone(obj,iframe||obj.firstChild,rpc)},10);return widgetId}};if(!VK.Util){VK.Util={getPageData:function(){if(!VK._pData){var metas=document.getElementsByTagName('meta'),pData={},keys=['description','title','url','image','app_id'],metaName;for(var i in metas){if(!metas[i].getAttribute)continue;if(metas[i].getAttribute&&((metaName=metas[i].getAttribute('name'))||(metaName=metas[i].getAttribute('property')))){for(var j in keys){if(metaName==keys[j]||metaName=='og:'+keys[j]||metaName=='vk:'+keys[j]){pData[keys[j]]=metas[i].content}}}};if(pData.app_id&&!VK._apiId){VK._apiId=pData.app_id};pData.title=pData.title||document.title||'';pData.description=pData.description||'';pData.image=pData.image||'';if(!pData.url&&VK._iframeAppWidget&&VK._apiId){pData.url='/app'+VK._apiId;if(VK._browserHash){pData.url+=VK._browserHash}};var loc=location.href.replace(/#.*$/,'');if(!pData.url||!pData.url.indexOf(loc)){pData.url=loc};VK._pData=pData};return VK._pData},getStyle:function(elem,name){var ret,defaultView=document.defaultView||window;if(defaultView.getComputedStyle){name=name.replace(/([A-Z])/g,'-$1').toLowerCase();var computedStyle=defaultView.getComputedStyle(elem,null);if(computedStyle){ret=computedStyle.getPropertyValue(name)}}else if(elem.currentStyle){var camelCase=name.replace(/\-(\w)/g,function(all,letter){return letter.toUpperCase()});ret=elem.currentStyle[name]||elem.currentStyle[camelCase]};return ret},getXY:function(obj,fixed){if(!obj||obj===undefined)return;var left=0,top=0;if(obj.getBoundingClientRect!==undefined){var rect=obj.getBoundingClientRect();left=rect.left;top=rect.top;fixed=true}else if(obj.offsetParent){do{left+=obj.offsetLeft;top+=obj.offsetTop;if(fixed){left-=obj.scrollLeft;top-=obj.scrollTop}}while(obj=obj.offsetParent);};if(fixed){top+=window.pageYOffset||window.scrollNode&&scrollNode.scrollTop||document.documentElement.scrollTop;left+=window.pageXOffset||window.scrollNode&&scrollNode.scrollLeft||document.documentElement.scrollLeft};return[left,top]},Loader:function self(enable){if(!self.loader){self.loader=document.createElement('DIV');self.loader.innerHTML='<style type="text/css">        @-webkit-keyframes VKWidgetsLoaderKeyframes {0%{opacity: 0.2;}30%{opacity: 1;}100%{opacity: 0.2;}}        @keyframes VKWidgetsLoaderKeyframes {0%{opacity: 0.2;}30%{opacity: 1;}100%{opacity: 0.2;}}        .VKWidgetsLoader div {width: 7px;height: 7px;-webkit-border-radius: 50%;-khtml-border-radius: 50%;-moz-border-radius: 50%;border-radius: 50%;background: #fff;top: 21px;position: absolute;z-index: 2;-o-transition: opacity 350ms linear; transition: opacity 350ms linear;opacity: 0.2;-webkit-animation-duration: 750ms;-o-animation-duration: 750ms;animation-duration: 750ms;-webkit-animation-name: VKWidgetsLoaderKeyframes;-o-animation-name: VKWidgetsLoaderKeyframes;animation-name: VKWidgetsLoaderKeyframes;-webkit-animation-iteration-count: infinite;-o-animation-iteration-count: infinite;animation-iteration-count: infinite;-webkit-transform: translateZ(0);transform: translateZ(0);}</style><div class="VKWidgetsLoader" style="position: fixed;left: 50%;top: 50%;margin: -25px -50px;z-index: 1002;height: 50px;width: 100px;"><div style="left: 36px;-webkit-animation-delay: 0ms;-o-animation-delay: 0ms;animation-delay: 0ms;"></div><div style="left: 47px;-webkit-animation-delay: 180ms;-o-animation-delay: 180ms;animation-delay: 180ms;"></div><div style="left: 58px;-webkit-animation-delay: 360ms;-o-animation-delay: 360ms;animation-delay: 360ms;"></div><span style="display: block;background-color: #000;-webkit-border-radius: 4px;-khtml-border-radius: 4px;-moz-border-radius: 4px;border-radius: 4px;-webkit-box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.35);-moz-box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.35);box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.35);position: absolute;left: 0;top: 0;bottom: 0; right: 0;z-index: 1;opacity: 0.7;"></span></div>';document.body.insertBefore(self.loader,document.body.firstChild)};self.loader.style.display=enable?'block':'none'},Box:function(src,sizes,fnc,options){fnc=fnc||{};var overflowB=document.body.style.overflow;VK.Util.Loader(true);var is_vk=/(^|\.)(vk\.com|vkontakte\.ru)$/.test(location.hostname),rpc=new fastXDM.Server(VK.extend(fnc,{onInit:function(){iframe.style.background='transparent';iframe.style.visibility='visible';document.body.style.overflow='hidden';iframe.setAttribute('allowfullscreen',1);if(is_vk)document.body.className+=' layers_shown';VK.Util.Loader()},hide:function(){iframe.style.display='none'},tempHide:function(){iframe.style.left='-10000px';iframe.style.top='-10000px';iframe.style.width='10px';iframe.style.height='10px';if(is_vk)document.body.className=document.body.className.replace(/\b\s*?layers_shown\s*\b/,' ');document.body.style.overflow=overflowB},destroy:function(){try{iframe.src='about: blank;'}catch(catch$scope$var751069445){};iframe.parentNode.removeChild(iframe);if(is_vk)document.body.className=document.body.className.replace(/\b\s*?layers_shown\s*\b/,' ');document.body.style.overflow=overflowB},resize:function(w,h){}},true),false,{safe:true}),iframe=rpc.append(document.body,{src:src.replace(/&amp;/g,'&'),scrolling:'no',allowTransparency:true,style:{position:'fixed',left:0,top:0,zIndex:1002,background:VK._protocol+'//vk.com/images/upload.gif center center no-repeat transparent',padding:'0',border:'0',width:'100%',height:'100%',overflow:'hidden',visibility:'hidden'}});return{show:function(scrollTop,height){iframe.style.display='block';document.body.style.overflow='hidden'},hide:function(){iframe.style.display='none';document.body.style.overflow=overflowB},iframe:iframe,rpc:rpc}},addEvent:function(type,func){if(window.document.addEventListener){window.document.addEventListener(type,func,false)}else if(window.document.attachEvent){window.document.attachEvent('on'+type,func)}},removeEvent:function(type,func){if(window.document.removeEventListener){window.document.removeEventListener(type,func,false)}else if(window.document.detachEvent){window.document.detachEvent('on'+type,func)}},ss:function(el,styles){VK.extend(el.style,styles,true)}}};if(!VK.Retargeting){VK.Retargeting={pixelCode:null,Init:function(pixelCode){this.pixelCode=pixelCode},Event:function(event){if(!this.pixelCode){return}(window.Image?(new Image()):document.createElement('img')).src='https://vk.com/rtrg?p='+this.pixelCode+(event?('&event='+event):'')},Hit:function(){this.Event()},Add:function(audienceID){if(!this.pixelCode||!audienceID){return}(window.Image?(new Image()):document.createElement('img')).src='https://vk.com/rtrg?p='+this.pixelCode+'&audience='+audienceID}}};window.vkAsyncInit&&setTimeout(vkAsyncInit,0);if(window.vkAsyncInitCallbacks&&vkAsyncInitCallbacks.length){setTimeout(function(){var callback;while(callback=vkAsyncInitCallbacks.pop()){try{callback()}catch(catch$scope$var751069445){try{console.error(catch$scope$var751069445)}catch(catch$scope$var751069445){}}}},0)};try{stManager.done('api/openapi.js')}catch(catch$scope$var751069445){};$(function(){$('<div id="vk_community_messages"></div>').appendTo('body');VK.Widgets.CommunityMessages('vk_community_messages',122154011,{tooltipButtonText:' ?'})});(function(window,document,$,undefined){'use strict';if(!$){return undefined};var defaults={speed:330,loop:true,opacity:'auto',margin:[44,0],gutter:30,infobar:true,buttons:true,slideShow:true,fullScreen:true,thumbs:true,closeBtn:true,smallBtn:'auto',image:{preload:'auto',protect:false},ajax:{settings:{data:{fancybox:true}}},iframe:{tpl:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen allowtransparency="true" src=""></iframe>',preload:true,scrolling:'no',css:{}},baseClass:'',slideClass:'',baseTpl:'<div class="fancybox-container" role="dialog" tabindex="-1"><div class="fancybox-bg"></div><div class="fancybox-controls"><div class="fancybox-infobar"><button data-fancybox-previous class="fancybox-button fancybox-button--left" title="Previous"></button><div class="fancybox-infobar__body"><span class="js-fancybox-index"></span>&nbsp;/&nbsp;<span class="js-fancybox-count"></span></div><button data-fancybox-next class="fancybox-button fancybox-button--right" title="Next"></button></div><div class="fancybox-buttons"><button data-fancybox-close class="fancybox-button fancybox-button--close" title="Close (Esc)"></button></div></div><div class="fancybox-slider-wrap"><div class="fancybox-slider"></div></div><div class="fancybox-caption-wrap"><div class="fancybox-caption"></div></div></div>',spinnerTpl:'<div class="fancybox-loading"></div>',errorTpl:'<div class="fancybox-error"><p>The requested content cannot be loaded. <br /> Please try again later.<p></div>',closeTpl:'<button data-fancybox-close class="fancybox-close-small"></button>',parentEl:'body',touch:true,keyboard:true,focus:true,closeClickOutside:true,beforeLoad:$.noop,afterLoad:$.noop,beforeMove:$.noop,afterMove:$.noop,onComplete:$.noop,onInit:$.noop,beforeClose:$.noop,afterClose:$.noop,onActivate:$.noop,onDeactivate:$.noop};var $W=$(window),$D=$(document),called=0,isQuery=function(obj){return obj&&obj.hasOwnProperty&&obj instanceof $},requestAFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){window.setTimeout(callback,1000/60)}})(),isElementInViewport=function(el){var rect;if(typeof $==='function'&&el instanceof $){el=el[0]};rect=el.getBoundingClientRect();return rect.bottom>0&&rect.right>0&&rect.left<(window.innerWidth||document.documentElement.clientWidth)&&rect.top<(window.innerHeight||document.documentElement.clientHeight)},FancyBox=function(content,opts,index){var self=this;self.opts=$.extend(true,{index:index},defaults,opts||{});self.id=self.opts.id||++called;self.group=[];self.currIndex=parseInt(self.opts.index,10)||0;self.prevIndex=null;self.prevPos=null;self.currPos=0;self.firstRun=null;self.createGroup(content);if(!self.group.length){return};self.$lastFocus=$(document.activeElement).blur();self.slides={};self.init(content)};$.extend(FancyBox.prototype,{init:function(){var self=this,galleryHasHtml=false,testWidth,$container;self.scrollTop=$D.scrollTop();self.scrollLeft=$D.scrollLeft();if(!$.fancybox.getInstance()){testWidth=$('body').width();$('html').addClass('fancybox-enabled');if($.fancybox.isTouch){$.each(self.group,function(key,item){if(item.type!=='image'&&item.type!=='iframe'){galleryHasHtml=true;return false}});if(galleryHasHtml){$('body').css({position:'fixed',width:testWidth,top:self.scrollTop*-1})}}else{testWidth=$('body').width()-testWidth;if(testWidth>1){$('<style id="fancybox-noscroll" type="text/css">').html('.compensate-for-scrollbar, .fancybox-enabled body { margin-right: '+testWidth+'px; }').appendTo('head')}}};$container=$(self.opts.baseTpl).attr('id','fancybox-container-'+self.id).data('FancyBox',self).addClass(self.opts.baseClass).hide().prependTo(self.opts.parentEl);self.$refs={container:$container,bg:$container.find('.fancybox-bg'),controls:$container.find('.fancybox-controls'),buttons:$container.find('.fancybox-buttons'),slider_wrap:$container.find('.fancybox-slider-wrap'),slider:$container.find('.fancybox-slider'),caption:$container.find('.fancybox-caption')};self.trigger('onInit');self.activate();if(self.current){return};self.jumpTo(self.currIndex)},createGroup:function(content){var self=this,items=$.makeArray(content);$.each(items,function(i,item){var obj={},opts={},data=[],$item,type,src,srcParts;if($.isPlainObject(item)){obj=item;opts=item.opts||{}}else if($.type(item)==='object'&&$(item).length){$item=$(item);data=$item.data();opts='options' in data?data.options:{};opts=$.type(opts)==='object'?opts:{};obj.type='type' in data?data.type:opts.type;obj.src='src' in data?data.src:(opts.src||$item.attr('href'));opts.width='width' in data?data.width:opts.width;opts.height='height' in data?data.height:opts.height;opts.thumb='thumb' in data?data.thumb:opts.thumb;opts.selector='selector' in data?data.selector:opts.selector;if('srcset' in data){opts.image={srcset:data.srcset}};opts.$orig=$item}else{obj={type:'html',content:item+''}};obj.opts=$.extend(true,{},self.opts,opts);type=obj.type;src=obj.src||'';if(!type){if(obj.content){type='html'}else if(src.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)){type='image'}else if(src.match(/\.(pdf)((\?|#).*)?$/i)){type='pdf'}else if(src.charAt(0)==='#'){type='inline'};obj.type=type};obj.index=self.group.length;if(obj.opts.$orig&&!obj.opts.$orig.length){delete obj.opts.$orig};if(!obj.opts.$thumb&&obj.opts.$orig){obj.opts.$thumb=obj.opts.$orig.find('img:first')};if(obj.opts.$thumb&&!obj.opts.$thumb.length){delete obj.opts.$thumb};if($.type(obj.opts.caption)==='function'){obj.opts.caption=obj.opts.caption.apply(item,[self,obj])}else if('caption' in data){obj.opts.caption=data.caption}else if(opts.$orig){obj.opts.caption=$item.attr('title')};obj.opts.caption=obj.opts.caption===undefined?'':obj.opts.caption+'';if(type==='ajax'){srcParts=src.split(/\s+/,2);if(srcParts.length>1){obj.src=srcParts.shift();obj.opts.selector=srcParts.shift()}};if(obj.opts.smallBtn=='auto'){if($.inArray(type,['html','inline','ajax'])>-1){obj.opts.buttons=false;obj.opts.smallBtn=true}else{obj.opts.smallBtn=false}};if(type==='pdf'){obj.type='iframe';obj.opts.closeBtn=true;obj.opts.smallBtn=false;obj.opts.iframe.preload=false};if(obj.opts.modal){$.extend(true,obj.opts,{infobar:0,buttons:0,keyboard:0,slideShow:0,fullScreen:0,closeClickOutside:0})};self.group.push(obj)})},addEvents:function(){var self=this;self.removeEvents();self.$refs.container.on('click.fb-close','[data-fancybox-close]',function(e){e.stopPropagation();e.preventDefault();self.close(e)}).on('click.fb-previous','[data-fancybox-previous]',function(e){e.stopPropagation();e.preventDefault();self.previous()}).on('click.fb-next','[data-fancybox-next]',function(e){e.stopPropagation();e.preventDefault();self.next()});$(window).on('orientationchange.fb resize.fb',function(e){requestAFrame(function(){if(e&&e.originalEvent&&e.originalEvent.type==='resize'){self.update()}else{self.$refs.slider_wrap.hide();requestAFrame(function(){self.$refs.slider_wrap.show();self.update()})}})});$D.on('focusin.fb',function(e){var instance=$.fancybox?$.fancybox.getInstance():null;if(instance&&!$(e.target).hasClass('fancybox-container')&&!$.contains(instance.$refs.container[0],e.target)){e.stopPropagation();instance.focus();$W.scrollTop(self.scrollTop).scrollLeft(self.scrollLeft)}});$D.on('keydown.fb',function(e){var current=self.current,keycode=e.keyCode||e.which;if(!current||!current.opts.keyboard){return};if($(e.target).is('input')||$(e.target).is('textarea')){return};if(keycode===8||keycode===27){e.preventDefault();self.close(e);return};switch(keycode){case 37:case 38:e.preventDefault();self.previous();break;case 39:case 40:e.preventDefault();self.next();break;case 80:case 32:e.preventDefault();if(self.SlideShow){e.preventDefault();self.SlideShow.toggle()};break;case 70:if(self.FullScreen){e.preventDefault();self.FullScreen.toggle()};break;case 71:if(self.Thumbs){e.preventDefault();self.Thumbs.toggle()};break}})},removeEvents:function(){$W.off('scroll.fb resize.fb orientationchange.fb');$D.off('keydown.fb focusin.fb click.fb-close');this.$refs.container.off('click.fb-close click.fb-previous click.fb-next')},previous:function(duration){this.jumpTo(this.currIndex-1,duration)},next:function(duration){this.jumpTo(this.currIndex+1,duration)},jumpTo:function(to,duration){var self=this,firstRun,index,pos,loop;firstRun=self.firstRun=(self.firstRun===null);index=pos=to=parseInt(to,10);loop=self.current?self.current.opts.loop:false;if(self.isAnimating||(index==self.currIndex&&!firstRun)){return};if(self.group.length>1&&loop){index=index%self.group.length;index=index<0?self.group.length+index:index;if(self.group.length==2){pos=to-self.currIndex+self.currPos}else{pos=index-self.currIndex+self.currPos;if(Math.abs(self.currPos-(pos+self.group.length))<Math.abs(self.currPos-pos)){pos=pos+self.group.length}else if(Math.abs(self.currPos-(pos-self.group.length))<Math.abs(self.currPos-pos)){pos=pos-self.group.length}}}else if(!self.group[index]){self.update(false,false,duration);return};if(self.current){self.current.$slide.removeClass('fancybox-slide--current fancybox-slide--complete');self.updateSlide(self.current,true)};self.prevIndex=self.currIndex;self.prevPos=self.currPos;self.currIndex=index;self.currPos=pos;self.current=self.createSlide(pos);if(self.group.length>1){if(self.opts.loop||pos-1>=0){self.createSlide(pos-1)};if(self.opts.loop||pos+1<self.group.length){self.createSlide(pos+1)}};self.current.isMoved=false;self.current.isComplete=false;duration=parseInt(duration===undefined?self.current.opts.speed*1.5:duration,10);self.trigger('beforeMove');self.updateControls();if(firstRun){self.current.$slide.addClass('fancybox-slide--current');self.$refs.container.show();requestAFrame(function(){self.$refs.bg.css('transition-duration',self.current.opts.speed+'ms');self.$refs.container.addClass('fancybox-container--ready')})};self.update(true,false,firstRun?0:duration,function(){self.afterMove()});self.loadSlide(self.current);if(!(firstRun&&self.current.$ghost)){self.preload()}},createSlide:function(pos){var self=this,$slide,index,found;index=pos%self.group.length;index=index<0?self.group.length+index:index;if(!self.slides[pos]&&self.group[index]){if(self.opts.loop&&self.group.length>2){for(var key in self.slides){if(self.slides[key].index===index){found=self.slides[key];found.pos=pos;self.slides[pos]=found;delete self.slides[key];self.updateSlide(found);return found}}};$slide=$('<div class="fancybox-slide"></div>').appendTo(self.$refs.slider);self.slides[pos]=$.extend(true,{},self.group[index],{pos:pos,$slide:$slide,isMoved:false,isLoaded:false})};return self.slides[pos]},zoomInOut:function(type,duration,callback){var self=this,current=self.current,$what=current.$placeholder,opacity=current.opts.opacity,$thumb=current.opts.$thumb,thumbPos=$thumb?$thumb.offset():0,slidePos=current.$slide.offset(),props,start,end;if(!$what||!current.isMoved||!thumbPos||!isElementInViewport($thumb)){return false};if(type==='In'&&!self.firstRun){return false};$.fancybox.stop($what);self.isAnimating=true;props={top:thumbPos.top-slidePos.top+parseFloat($thumb.css('border-top-width')||0),left:thumbPos.left-slidePos.left+parseFloat($thumb.css('border-left-width')||0),width:$thumb.width(),height:$thumb.height(),scaleX:1,scaleY:1};if(opacity=='auto'){opacity=Math.abs(current.width/current.height-props.width/props.height)>0.1};if(type==='In'){start=props;end=self.getFitPos(current);end.scaleX=end.width/start.width;end.scaleY=end.height/start.height;if(opacity){start.opacity=0.1;end.opacity=1}}else{start=$.fancybox.getTranslate($what);end=props;if(current.$ghost){current.$ghost.show();if(current.$image){current.$image.remove()}};start.scaleX=start.width/end.width;start.scaleY=start.height/end.height;start.width=end.width;start.height=end.height;if(opacity){end.opacity=0}};self.updateCursor(end.width,end.height);delete end.width;delete end.height;$.fancybox.setTranslate($what,start);$what.show();self.trigger('beforeZoom'+type);$what.css('transition','all '+duration+'ms');$.fancybox.setTranslate($what,end);setTimeout(function(){var reset;$what.css('transition','none');reset=$.fancybox.getTranslate($what);reset.scaleX=1;reset.scaleY=1;$.fancybox.setTranslate($what,reset);self.trigger('afterZoom'+type);callback.apply(self);self.isAnimating=false},duration);return true},canPan:function(){var self=this,current=self.current,$what=current.$placeholder,rez=false;if($what){rez=self.getFitPos(current);rez=Math.abs($what.width()-rez.width)>1||Math.abs($what.height()-rez.height)>1};return rez},isScaledDown:function(){var self=this,current=self.current,$what=current.$placeholder,rez=false;if($what){rez=$.fancybox.getTranslate($what);rez=rez.width<current.width||rez.height<current.height};return rez},scaleToActual:function(x,y,duration){var self=this,current=self.current,$what=current.$placeholder,imgPos,posX,posY,scaleX,scaleY,canvasWidth=parseInt(current.$slide.width(),10),canvasHeight=parseInt(current.$slide.height(),10),newImgWidth=current.width,newImgHeight=current.height;if(!$what){return};self.isAnimating=true;x=x===undefined?canvasWidth*0.5:x;y=y===undefined?canvasHeight*0.5:y;imgPos=$.fancybox.getTranslate($what);scaleX=newImgWidth/imgPos.width;scaleY=newImgHeight/imgPos.height;posX=(canvasWidth*0.5-newImgWidth*0.5);posY=(canvasHeight*0.5-newImgHeight*0.5);if(newImgWidth>canvasWidth){posX=imgPos.left*scaleX-((x*scaleX)-x);if(posX>0){posX=0};if(posX<canvasWidth-newImgWidth){posX=canvasWidth-newImgWidth}};if(newImgHeight>canvasHeight){posY=imgPos.top*scaleY-((y*scaleY)-y);if(posY>0){posY=0};if(posY<canvasHeight-newImgHeight){posY=canvasHeight-newImgHeight}};self.updateCursor(newImgWidth,newImgHeight);$.fancybox.animate($what,null,{top:posY,left:posX,scaleX:scaleX,scaleY:scaleY},duration||current.opts.speed,function(){self.isAnimating=false})},scaleToFit:function(duration){var self=this,current=self.current,$what=current.$placeholder,end;if(!$what){return};self.isAnimating=true;end=self.getFitPos(current);self.updateCursor(end.width,end.height);$.fancybox.animate($what,null,{top:end.top,left:end.left,scaleX:end.width/$what.width(),scaleY:end.height/$what.height()},duration||current.opts.speed,function(){self.isAnimating=false})},getFitPos:function(slide){var $what=slide.$placeholder||slide.$content,imgWidth=slide.width,imgHeight=slide.height,margin=slide.opts.margin,canvasWidth,canvasHeight,minRatio,top,left,width,height;if(!$what||!$what.length||(!imgWidth&&!imgHeight)){return false};if($.type(margin)==='number'){margin=[margin,margin]};if(margin.length==2){margin=[margin[0],margin[1],margin[0],margin[1]]};if($W.width()<800){margin=[0,0,0,0]};canvasWidth=parseInt(slide.$slide.width(),10)-(margin[1]+margin[3]);canvasHeight=parseInt(slide.$slide.height(),10)-(margin[0]+margin[2]);minRatio=Math.min(1,canvasWidth/imgWidth,canvasHeight/imgHeight);width=Math.floor(minRatio*imgWidth);height=Math.floor(minRatio*imgHeight);top=Math.floor((canvasHeight-height)*0.5)+margin[0];left=Math.floor((canvasWidth-width)*0.5)+margin[3];return{top:top,left:left,width:width,height:height}},update:function(andSlides,andContent,duration,callback){var self=this,leftValue;if(self.isAnimating===true||!self.current){return};leftValue=(self.current.pos*Math.floor(self.current.$slide.width())*-1)-(self.current.pos*self.current.opts.gutter);duration=parseInt(duration,10)||0;$.fancybox.stop(self.$refs.slider);if(andSlides===false){self.updateSlide(self.current,andContent)}else{$.each(self.slides,function(key,slide){self.updateSlide(slide,andContent)})};if(duration){$.fancybox.animate(self.$refs.slider,null,{top:0,left:leftValue},duration,function(){self.current.isMoved=true;if($.type(callback)==='function'){callback.apply(self)}})}else{$.fancybox.setTranslate(self.$refs.slider,{top:0,left:leftValue});self.current.isMoved=true;if($.type(callback)==='function'){callback.apply(self)}}},updateSlide:function(slide,andContent){var self=this,$what=slide.$placeholder,leftPos;slide=slide||self.current;if(!slide||self.isClosing){return};leftPos=(slide.pos*Math.floor(slide.$slide.width()))+(slide.pos*slide.opts.gutter);if(leftPos!==slide.leftPos){$.fancybox.setTranslate(slide.$slide,{top:0,left:leftPos});slide.leftPos=leftPos};if(andContent!==false&&$what){$.fancybox.setTranslate($what,self.getFitPos(slide));if(slide.pos===self.currPos){self.updateCursor()}};slide.$slide.trigger('refresh');self.trigger('onUpdate',slide)},updateCursor:function(nextWidth,nextHeight){var self=this,canScale,$container=self.$refs.container.removeClass('fancybox-controls--canzoomIn fancybox-controls--canzoomOut fancybox-controls--canGrab');if(self.isClosing||!self.opts.touch){return};if(nextWidth!==undefined&&nextHeight!==undefined){canScale=nextWidth<self.current.width&&nextHeight<self.current.height}else{canScale=self.isScaledDown()};if(canScale){$container.addClass('fancybox-controls--canzoomIn')}else if(self.group.length<2){$container.addClass('fancybox-controls--canzoomOut')}else{$container.addClass('fancybox-controls--canGrab')}},loadSlide:function(slide){var self=this,type,$slide,ajaxLoad;if(!slide||slide.isLoaded||slide.isLoading){return};slide.isLoading=true;self.trigger('beforeLoad',slide);type=slide.type;$slide=slide.$slide;$slide.off('refresh').trigger('onReset').addClass('fancybox-slide--'+(type||'unknown')).addClass(slide.opts.slideClass);switch(type){case'image':self.setImage(slide);break;case'iframe':self.setIframe(slide);break;case'html':self.setContent(slide,slide.content);break;case'inline':if($(slide.src).length){self.setContent(slide,$(slide.src))}else{self.setError(slide)};break;case'ajax':self.showLoading(slide);ajaxLoad=$.ajax($.extend({},slide.opts.ajax.settings,{url:slide.src,success:function(data,textStatus){if(textStatus==='success'){self.setContent(slide,data)}},error:function(jqXHR,textStatus){if(jqXHR&&textStatus!=='abort'){self.setError(slide)}}}));$slide.one('onReset',function(){ajaxLoad.abort()});break;default:self.setError(slide);break};return true},setImage:function(slide){var self=this,srcset=slide.opts.image.srcset,found,temp,pxRatio,windowWidth;if(slide.isLoaded&&!slide.hasError){self.afterLoad(slide);return};if(srcset){pxRatio=window.devicePixelRatio||1;windowWidth=window.innerWidth*pxRatio;temp=srcset.split(',').map(function(el){var ret={};el.trim().split(/\s+/).forEach(function(el,i){var value=parseInt(el.substring(0,el.length-1),10);if(i===0){return(ret.url=el)};if(value){ret.value=value;ret.postfix=el[el.length-1]}});return ret});temp.sort(function(a,b){return a.value-b.value});for(var j=0;j<temp.length;j++){var el=temp[j];if((el.postfix==='w'&&el.value>=windowWidth)||(el.postfix==='x'&&el.value>=pxRatio)){found=el;break}};if(!found&&temp.length){found=temp[temp.length-1]};if(found){slide.src=found.url;if(slide.width&&slide.height&&found.postfix=='w'){slide.height=(slide.width/slide.height)*found.value;slide.width=found.value}}};slide.$placeholder=$('<div class="fancybox-placeholder"></div>').hide().appendTo(slide.$slide);if(slide.opts.preload!==false&&slide.opts.width&&slide.opts.height&&(slide.opts.thumb||slide.opts.$thumb)){slide.width=slide.opts.width;slide.height=slide.opts.height;slide.$ghost=$('<img />').one('load error',function(){if(self.isClosing){return};$('<img/>')[0].src=slide.src;self.revealImage(slide,function(){self.setBigImage(slide);if(self.firstRun&&slide.index===self.currIndex){self.preload()}})}).addClass('fancybox-image').appendTo(slide.$placeholder).attr('src',slide.opts.thumb||slide.opts.$thumb.attr('src'))}else{self.setBigImage(slide)}},setBigImage:function(slide){var self=this,$img=$('<img />');slide.$image=$img.one('error',function(){self.setError(slide)}).one('load',function(){clearTimeout(slide.timouts);slide.timouts=null;if(self.isClosing){return};slide.width=this.naturalWidth;slide.height=this.naturalHeight;if(slide.opts.image.srcset){$img.attr('sizes','100vw').attr('srcset',slide.opts.image.srcset)};self.afterLoad(slide);if(slide.$ghost){slide.timouts=setTimeout(function(){slide.$ghost.hide()},350)}}).addClass('fancybox-image').attr('src',slide.src).appendTo(slide.$placeholder);if($img[0].complete){$img.trigger('load')}else if($img[0].error){$img.trigger('error')}else{slide.timouts=setTimeout(function(){if(!$img[0].complete&&!slide.hasError){self.showLoading(slide)}},150)};if(slide.opts.image.protect){$('<div class="fancybox-spaceball"></div>').appendTo(slide.$placeholder).on('contextmenu.fb',function(e){if(e.button==2){e.preventDefault()};return true})}},revealImage:function(slide,callback){var self=this;callback=callback||$.noop;if(slide.type!=='image'||slide.hasError||slide.isRevealed===true){callback.apply(self);return};slide.isRevealed=true;if(!(slide.pos===self.currPos&&self.zoomInOut('In',slide.opts.speed,callback))){if(slide.$ghost&&!slide.isLoaded){self.updateSlide(slide,true)};if(slide.pos===self.currPos){$.fancybox.animate(slide.$placeholder,{opacity:0},{opacity:1},300,callback)}else{slide.$placeholder.show()};callback.apply(self)}},setIframe:function(slide){var self=this,opts=slide.opts.iframe,$slide=slide.$slide,$iframe;slide.$content=$('<div class="fancybox-content"></div>').css(opts.css).appendTo($slide);$iframe=$(opts.tpl.replace(/\{rnd\}/g,new Date().getTime())).attr('scrolling',$.fancybox.isTouch?'auto':opts.scrolling).appendTo(slide.$content);if(opts.preload){slide.$content.addClass('fancybox-tmp');self.showLoading(slide);$iframe.on('load.fb error.fb',function(e){this.isReady=1;slide.$slide.trigger('refresh');self.afterLoad(slide)});$slide.on('refresh.fb',function(){var $wrap=slide.$content,$contents,$body,scrollWidth,frameWidth,frameHeight;if($iframe[0].isReady!==1){return};try{$contents=$iframe.contents();$body=$contents.find('body')}catch(catch$scope$var751069445){};if($body&&$body.length&&!(opts.css.width!==undefined&&opts.css.height!==undefined)){scrollWidth=$iframe[0].contentWindow.document.documentElement.scrollWidth;frameWidth=Math.ceil($body.outerWidth(true)+($wrap.width()-scrollWidth));frameHeight=Math.ceil($body.outerHeight(true));$wrap.css({'width':opts.css.width===undefined?frameWidth+($wrap.outerWidth()-$wrap.innerWidth()):opts.css.width,'height':opts.css.height===undefined?frameHeight+($wrap.outerHeight()-$wrap.innerHeight()):opts.css.height})};$wrap.removeClass('fancybox-tmp')})}else{this.afterLoad(slide)};$iframe.attr('src',slide.src);if(slide.opts.smallBtn){slide.$content.prepend(slide.opts.closeTpl)};$slide.one('onReset',function(){try{$(this).find('iframe').hide().attr('src','//about:blank')}catch(catch$scope$var751069445){};$(this).empty();slide.isLoaded=false})},setContent:function(slide,content){var self=this;if(self.isClosing){return};self.hideLoading(slide);slide.$slide.empty();if(isQuery(content)&&content.parent().length){if(content.data('placeholder')){content.parents('.fancybox-slide').trigger('onReset')};content.data({'placeholder':$('<div></div>').hide().insertAfter(content)}).css('display','inline-block')}else{if($.type(content)==='string'){content=$('<div>').append(content).contents();if(content[0].nodeType===3){content=$('<div>').html(content)}};if(slide.opts.selector){content=$('<div>').html(content).find(slide.opts.selector)}};slide.$slide.one('onReset',function(){var placeholder=isQuery(content)?content.data('placeholder'):0;if(placeholder){content.hide().replaceAll(placeholder);content.data('placeholder',null)};if(!slide.hasError){$(this).empty();slide.isLoaded=false}});slide.$content=$(content).appendTo(slide.$slide);if(slide.opts.smallBtn===true){slide.$content.find('.fancybox-close-small').remove().end().eq(0).append(slide.opts.closeTpl)};this.afterLoad(slide)},setError:function(slide){slide.hasError=true;this.setContent(slide,slide.opts.errorTpl)},showLoading:function(slide){var self=this;slide=slide||self.current;if(slide&&!slide.$spinner){slide.$spinner=$(self.opts.spinnerTpl).appendTo(slide.$slide)}},hideLoading:function(slide){var self=this;slide=slide||self.current;if(slide&&slide.$spinner){slide.$spinner.remove();delete slide.$spinner}},afterMove:function(){var self=this,current=self.current,slides={};if(!current){return};current.$slide.siblings().trigger('onReset');$.each(self.slides,function(key,slide){if(slide.pos>=self.currPos-1&&slide.pos<=self.currPos+1){slides[slide.pos]=slide}else if(slide){slide.$slide.remove()}});self.slides=slides;self.trigger('afterMove');if(current.isLoaded){self.complete()}},afterLoad:function(slide){var self=this;if(self.isClosing){return};slide.isLoading=false;slide.isLoaded=true;self.trigger('afterLoad',slide);self.hideLoading(slide);if(!slide.$ghost){self.updateSlide(slide,true)};if(slide.index===self.currIndex&&slide.isMoved){self.complete()}else if(!slide.$ghost){self.revealImage(slide)}},complete:function(){var self=this,current=self.current;self.revealImage(current,function(){current.isComplete=true;current.$slide.addClass('fancybox-slide--complete');self.updateCursor();self.trigger('onComplete');if(current.opts.focus&&!(current.type==='image'||current.type==='iframe')){self.focus()}})},preload:function(){var self=this,next,prev;if(self.group.length<2){return};next=self.slides[self.currPos+1];prev=self.slides[self.currPos-1];if(next&&next.type==='image'){self.loadSlide(next)};if(prev&&prev.type==='image'){self.loadSlide(prev)}},focus:function(){var current=this.current,$el;$el=current&&current.isComplete?current.$slide.find('button,:input,[tabindex],a:not(".disabled")').filter(':visible:first'):null;if(!$el||!$el.length){$el=this.$refs.container};$el.focus();this.$refs.slider_wrap.scrollLeft(0);if(current){current.$slide.scrollTop(0)}},activate:function(){var self=this;$('.fancybox-container').each(function(){var instance=$(this).data('FancyBox');if(instance&&instance.uid!==self.uid&&!instance.isClosing){instance.trigger('onDeactivate')}});if(self.current){if(self.$refs.container.index()>0){self.$refs.container.prependTo(document.body)};self.updateControls()};self.trigger('onActivate');self.addEvents()},close:function(e){var self=this,current=self.current,duration=current.opts.speed,done=$.proxy(function(){self.cleanUp(e)},this);if(self.isAnimating||self.isClosing){return false};if(self.trigger('beforeClose',e)===false){$.fancybox.stop(self.$refs.slider);requestAFrame(function(){self.update(true,true,150)});return};self.isClosing=true;if(current.timouts){clearTimeout(current.timouts)};if(e!==true){$.fancybox.stop(self.$refs.slider)};self.$refs.container.removeClass('fancybox-container--active').addClass('fancybox-container--closing');current.$slide.removeClass('fancybox-slide--complete').siblings().remove();if(!current.isMoved){current.$slide.css('overflow','visible')};self.removeEvents();self.hideLoading(current);self.hideControls();self.updateCursor();self.$refs.bg.css('transition-duration',duration+'ms');this.$refs.container.removeClass('fancybox-container--ready');if(e===true){setTimeout(done,duration)}else if(!self.zoomInOut('Out',duration,done)){$.fancybox.animate(self.$refs.container,null,{opacity:0},duration,'easeInSine',done)}},cleanUp:function(e){var self=this,instance;self.$refs.slider.children().trigger('onReset');self.$refs.container.empty().remove();self.trigger('afterClose',e);self.current=null;instance=$.fancybox.getInstance();if(instance){instance.activate()}else{$('html').removeClass('fancybox-enabled');$('body').removeAttr('style');$W.scrollTop(self.scrollTop).scrollLeft(self.scrollLeft);$('#fancybox-noscroll').remove()};if(self.$lastFocus){self.$lastFocus.focus()}},trigger:function(name,slide){var args=Array.prototype.slice.call(arguments,1),self=this,obj=slide&&slide.opts?slide:self.current,rez;if(obj){args.unshift(obj)}else{obj=self};args.unshift(self);if($.isFunction(obj.opts[name])){rez=obj.opts[name].apply(obj,args)};if(rez===false){return rez};if(name==='afterClose'){$(document).trigger(name+'.fb',args)}else{self.$refs.container.trigger(name+'.fb',args)}},toggleControls:function(force){if(this.isHiddenControls){this.updateControls(force)}else{this.hideControls()}},hideControls:function(){this.isHiddenControls=true;this.$refs.container.removeClass('fancybox-show-controls');this.$refs.container.removeClass('fancybox-show-caption')},updateControls:function(force){var self=this,$container=self.$refs.container,$caption=self.$refs.caption,current=self.current,index=current.index,opts=current.opts,caption=opts.caption;if(this.isHiddenControls&&force!==true){return};this.isHiddenControls=false;$container.addClass('fancybox-show-controls').toggleClass('fancybox-show-infobar',!!opts.infobar&&self.group.length>1).toggleClass('fancybox-show-buttons',!!opts.buttons).toggleClass('fancybox-is-modal',!!opts.modal);$('.fancybox-button--left',$container).toggleClass('fancybox-button--disabled',(!opts.loop&&index<=0));$('.fancybox-button--right',$container).toggleClass('fancybox-button--disabled',(!opts.loop&&index>=self.group.length-1));$('.fancybox-button--play',$container).toggle(!!(opts.slideShow&&self.group.length>1));$('.fancybox-button--close',$container).toggle(!!opts.closeBtn);$('.js-fancybox-count',$container).html(self.group.length);$('.js-fancybox-index',$container).html(index+1);current.$slide.trigger('refresh');if($caption){$caption.empty()};if(caption&&caption.length){$caption.html(caption);this.$refs.container.addClass('fancybox-show-caption ');self.$caption=$caption}else{this.$refs.container.removeClass('fancybox-show-caption')}}});$.fancybox={version:'{fancybox-version}',defaults:defaults,getInstance:function(command){var instance=$('.fancybox-container:not(".fancybox-container--closing"):first').data('FancyBox'),args=Array.prototype.slice.call(arguments,1);if(instance instanceof FancyBox){if($.type(command)==='string'){instance[command].apply(instance,args)}else if($.type(command)==='function'){command.apply(instance,args)};return instance};return false},open:function(items,opts,index){return new FancyBox(items,opts,index)},close:function(all){var instance=this.getInstance();if(instance){instance.close();if(all===true){this.close()}}},isTouch:document.createTouch!==undefined&&/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),use3d:(function(){var div=document.createElement('div');return window.getComputedStyle(div).getPropertyValue('transform')&&!(document.documentMode&&document.documentMode<=11)}()),getTranslate:function($el){var position,matrix;if(!$el||!$el.length){return false};position=$el.get(0).getBoundingClientRect();matrix=$el.eq(0).css('transform');if(matrix&&matrix.indexOf('matrix')!==-1){matrix=matrix.split('(')[1];matrix=matrix.split(')')[0];matrix=matrix.split(',')}else{matrix=[]};if(matrix.length){if(matrix.length>10){matrix=[matrix[13],matrix[12],matrix[0],matrix[5]]}else{matrix=[matrix[5],matrix[4],matrix[0],matrix[3]]};matrix=matrix.map(parseFloat)}else{matrix=[0,0,1,1]};return{top:matrix[0],left:matrix[1],scaleX:matrix[2],scaleY:matrix[3],opacity:parseFloat($el.css('opacity')),width:position.width,height:position.height}},setTranslate:function($el,props){var str='',css={};if(!$el||!props){return};if(props.left!==undefined||props.top!==undefined){str=(props.left===undefined?$el.position().top:props.left)+'px, '+(props.top===undefined?$el.position().top:props.top)+'px';if(this.use3d){str='translate3d('+str+', 0px)'}else{str='translate('+str+')'}};if(props.scaleX!==undefined&&props.scaleY!==undefined){str=(str.length?str+' ':'')+'scale('+props.scaleX+', '+props.scaleY+')'};if(str.length){css.transform=str};if(props.opacity!==undefined){css.opacity=props.opacity};if(props.width!==undefined){css.width=props.width};if(props.height!==undefined){css.height=props.height};return $el.css(css)},easing:{easeOutCubic:function(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInCubic:function(t,b,c,d){return c*(t/=d)*t*t+b},easeOutSine:function(t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInSine:function(t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b}},stop:function($el){$el.removeData('animateID')},animate:function($el,from,to,duration,easing,done){var self=this,lastTime=null,animTime=0,curr,diff,id,finish=function(){if(to.scaleX!==undefined&&to.scaleY!==undefined&&from&&from.width!==undefined&&from.height!==undefined){to.width=from.width*to.scaleX;to.height=from.height*to.scaleY;to.scaleX=1;to.scaleY=1};self.setTranslate($el,to);done()},frame=function(timestamp){curr=[];diff=0;if(!$el.length||$el.data('animateID')!==id){return};timestamp=timestamp||Date.now();if(lastTime){diff=timestamp-lastTime};lastTime=timestamp;animTime+=diff;if(animTime>=duration){finish();return};for(var prop in to){if(to.hasOwnProperty(prop)&&from[prop]!==undefined){if(from[prop]==to[prop]){curr[prop]=to[prop]}else{curr[prop]=self.easing[easing](animTime,from[prop],to[prop]-from[prop],duration)}}};self.setTranslate($el,curr);requestAFrame(frame)};self.animateID=id=self.animateID===undefined?1:self.animateID+1;$el.data('animateID',id);if(done===undefined&&$.type(easing)=='function'){done=easing;easing=undefined};if(!easing){easing='easeOutCubic'};done=done||$.noop;if(from){this.setTranslate($el,from)}else{from=this.getTranslate($el)};if(duration){$el.show();requestAFrame(frame)}else{finish()}}};function _run(e){var target=e.currentTarget,opts=e.data?e.data.options:{},items=e.data?e.data.items:[],value='',index=0;e.preventDefault();e.stopPropagation();if($(target).attr('data-fancybox')){value=$(target).data('fancybox')};if(value){items=items.length?items.filter('[data-fancybox="'+value+'"]'):$('[data-fancybox='+value+']');index=items.index(target)}else{items=[target]};$.fancybox.open(items,opts,index)};$.fn.fancybox=function(options){this.off('click.fb-start').on('click.fb-start',{items:this,options:options||{}},_run);return this};$(document).on('click.fb-start','[data-fancybox]',_run)}(window,document,window.jQuery));typeof JSON!='object'&&(JSON={}),function(){'use strict';function f(e){return e<10?'0'+e:e};function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=='string'?t:'\\u'+('0000'+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'};function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=='object'&&typeof a.toJSON=='function'&&(a=a.toJSON(e)),typeof rep=='function'&&(a=rep.call(t,e,a));switch(typeof a){case'string':return quote(a);case'number':return isFinite(a)?String(a):'null';case'boolean':case'null':return String(a);case'object':if(!a)return'null';gap+=indent,u=[];if(Object.prototype.toString.apply(a)==='[object Array]'){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||'null';return i=u.length===0?'[]':gap?'[\n'+gap+u.join(',\n'+gap)+'\n'+o+']':'['+u.join(',')+']',gap=o,i};if(rep&&typeof rep=='object'){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=='string'&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?': ':':')+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?': ':':')+i));return i=u.length===0?'{}':gap?'{\n'+gap+u.join(',\n'+gap)+'\n'+o+'}':'{'+u.join(',')+'}',gap=o,i}};typeof Date.prototype.toJSON!='function'&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','	':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;typeof JSON.stringify!='function'&&(JSON.stringify=function(e,t,n){var r;gap='',indent='';if(typeof n=='number')for(r=0;r<n;r+=1)indent+=' ';else typeof n=='string'&&(indent=n);rep=t;if(!t||typeof t=='function'||typeof t=='object'&&typeof t.length=='number')return str('',{'':e});throw new Error('JSON.stringify');}),typeof JSON.parse!='function'&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=='object')for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)};var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return'\\u'+('0000'+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,'')))return j=eval('('+text+')'),typeof reviver=='function'?walk({'':j},''):j;throw new SyntaxError('JSON.parse');})}(),function(e,t){'use strict';var n=e.History=e.History||{},r=e.jQuery;if(typeof n.Adapter!='undefined')throw new Error('History.js Adapter has already been loaded...');n.Adapter={bind:function(e,t,n){r(e).bind(t,n)},trigger:function(e,t,n){r(e).trigger(t,n)},extractEventData:function(e,n,r){var i=n&&n.originalEvent&&n.originalEvent[e]||r&&r[e]||t;return i},onDomLoad:function(e){r(e)}},typeof n.init!='undefined'&&n.init()}(window),function(e,t){'use strict';var n=e.document,r=e.setTimeout||r,i=e.clearTimeout||i,s=e.setInterval||s,o=e.History=e.History||{};if(typeof o.initHtml4!='undefined')throw new Error('History.js HTML4 Support has already been loaded...');o.initHtml4=function(){if(typeof o.initHtml4.initialized!='undefined')return!1;o.initHtml4.initialized=!0,o.enabled=!0,o.savedHashes=[],o.isLastHash=function(e){var t=o.getHashByIndex(),n;return n=e===t,n},o.isHashEqual=function(e,t){return e=encodeURIComponent(e).replace(/%25/g,'%'),t=encodeURIComponent(t).replace(/%25/g,'%'),e===t},o.saveHash=function(e){return o.isLastHash(e)?!1:(o.savedHashes.push(e),!0)},o.getHashByIndex=function(e){var t=null;return typeof e=='undefined'?t=o.savedHashes[o.savedHashes.length-1]:e<0?t=o.savedHashes[o.savedHashes.length+e]:t=o.savedHashes[e],t},o.discardedHashes={},o.discardedStates={},o.discardState=function(e,t,n){var r=o.getHashByState(e),i;return i={discardedState:e,backState:n,forwardState:t},o.discardedStates[r]=i,!0},o.discardHash=function(e,t,n){var r={discardedHash:e,backState:n,forwardState:t};return o.discardedHashes[e]=r,!0},o.discardedState=function(e){var t=o.getHashByState(e),n;return n=o.discardedStates[t]||!1,n},o.discardedHash=function(e){var t=o.discardedHashes[e]||!1;return t},o.recycleState=function(e){var t=o.getHashByState(e);return o.discardedState(e)&&delete o.discardedStates[t],!0},o.emulated.hashChange&&(o.hashChangeInit=function(){o.checkerFunction=null;var t='',r,i,u,a,f=Boolean(o.getHash());return o.isInternetExplorer()?(r='historyjs-iframe',i=n.createElement('iframe'),i.setAttribute('id',r),i.setAttribute('src','#'),i.style.display='none',n.body.appendChild(i),i.contentWindow.document.open(),i.contentWindow.document.close(),u='',a=!1,o.checkerFunction=function(){if(a)return!1;a=!0;var n=o.getHash(),r=o.getHash(i.contentWindow.document);return n!==t?(t=n,r!==n&&(u=r=n,i.contentWindow.document.open(),i.contentWindow.document.close(),i.contentWindow.document.location.hash=o.escapeHash(n)),o.Adapter.trigger(e,'hashchange')):r!==u&&(u=r,f&&r===''?o.back():o.setHash(r,!1)),a=!1,!0}):o.checkerFunction=function(){var n=o.getHash()||'';return n!==t&&(t=n,o.Adapter.trigger(e,'hashchange')),!0},o.intervalList.push(s(o.checkerFunction,o.options.hashChangeInterval)),!0},o.Adapter.onDomLoad(o.hashChangeInit)),o.emulated.pushState&&(o.onHashChange=function(t){var n=t&&t.newURL||o.getLocationHref(),r=o.getHashByUrl(n),i=null,s=null,u=null,a;return o.isLastHash(r)?(o.busy(!1),!1):(o.doubleCheckComplete(),o.saveHash(r),r&&o.isTraditionalAnchor(r)?(o.Adapter.trigger(e,'anchorchange'),o.busy(!1),!1):(i=o.extractState(o.getFullUrl(r||o.getLocationHref()),!0),o.isLastSavedState(i)?(o.busy(!1),!1):(s=o.getHashByState(i),a=o.discardedState(i),a?(o.getHashByIndex(-2)===o.getHashByState(a.forwardState)?o.back(!1):o.forward(!1),!1):(o.pushState(i.data,i.title,encodeURI(i.url),!1),!0))))},o.Adapter.bind(e,'hashchange',o.onHashChange),o.pushState=function(t,n,r,i){r=encodeURI(r).replace(/%25/g,'%');if(o.getHashByUrl(r))throw new Error('History.js does not support states with fragment-identifiers (hashes/anchors).');if(i!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.pushState,args:arguments,queue:i}),!1;o.busy(!0);var s=o.createStateObject(t,n,r),u=o.getHashByState(s),a=o.getState(!1),f=o.getHashByState(a),l=o.getHash(),c=o.expectedStateId==s.id;return o.storeState(s),o.expectedStateId=s.id,o.recycleState(s),o.setTitle(s),u===f?(o.busy(!1),!1):(o.saveState(s),c||o.Adapter.trigger(e,'statechange'),!o.isHashEqual(u,l)&&!o.isHashEqual(u,o.getShortUrl(o.getLocationHref()))&&o.setHash(u,!1),o.busy(!1),!0)},o.replaceState=function(t,n,r,i){r=encodeURI(r).replace(/%25/g,'%');if(o.getHashByUrl(r))throw new Error('History.js does not support states with fragment-identifiers (hashes/anchors).');if(i!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.replaceState,args:arguments,queue:i}),!1;o.busy(!0);var s=o.createStateObject(t,n,r),u=o.getHashByState(s),a=o.getState(!1),f=o.getHashByState(a),l=o.getStateByIndex(-2);return o.discardState(a,s,l),u===f?(o.storeState(s),o.expectedStateId=s.id,o.recycleState(s),o.setTitle(s),o.saveState(s),o.Adapter.trigger(e,'statechange'),o.busy(!1)):o.pushState(s.data,s.title,s.url,!1),!0}),o.emulated.pushState&&o.getHash()&&!o.emulated.hashChange&&o.Adapter.onDomLoad(function(){o.Adapter.trigger(e,'hashchange')})},typeof o.init!='undefined'&&o.init()}(window),function(e,t){'use strict';var n=e.console||t,r=e.document,i=e.navigator,s=!1,o=e.setTimeout,u=e.clearTimeout,a=e.setInterval,f=e.clearInterval,l=e.JSON,c=e.alert,h=e.History=e.History||{},p=e.history;try{s=e.sessionStorage,s.setItem('TEST','1'),s.removeItem('TEST')}catch(catch$scope$var751069445){s=!1};l.stringify=l.stringify||l.encode,l.parse=l.parse||l.decode;if(typeof h.init!='undefined')throw new Error('History.js Core has already been loaded...');h.init=function(e){return typeof h.Adapter=='undefined'?!1:(typeof h.initCore!='undefined'&&h.initCore(),typeof h.initHtml4!='undefined'&&h.initHtml4(),!0)},h.initCore=function(d){if(typeof h.initCore.initialized!='undefined')return!1;h.initCore.initialized=!0,h.options=h.options||{},h.options.hashChangeInterval=h.options.hashChangeInterval||100,h.options.safariPollInterval=h.options.safariPollInterval||500,h.options.doubleCheckInterval=h.options.doubleCheckInterval||500,h.options.disableSuid=h.options.disableSuid||!1,h.options.storeInterval=h.options.storeInterval||1e3,h.options.busyDelay=h.options.busyDelay||250,h.options.debug=h.options.debug||!1,h.options.initialTitle=h.options.initialTitle||r.title,h.options.html4Mode=h.options.html4Mode||!1,h.options.delayInit=h.options.delayInit||!1,h.intervalList=[],h.clearAllIntervals=function(){var e,t=h.intervalList;if(typeof t!='undefined'&&t!==null){for(e=0;e<t.length;e++)f(t[e]);h.intervalList=null}},h.debug=function(){(h.options.debug||!1)&&h.log.apply(h,arguments)},h.log=function(){var e=typeof n!='undefined'&&typeof n.log!='undefined'&&typeof n.log.apply!='undefined',t=r.getElementById('log'),i,s,o,u,a;e?(u=Array.prototype.slice.call(arguments),i=u.shift(),typeof n.debug!='undefined'?n.debug.apply(n,[i,u]):n.log.apply(n,[i,u])):i='\n'+arguments[0]+'\n';for(s=1,o=arguments.length;s<o;++s){a=arguments[s];if(typeof a=='object'&&typeof l!='undefined')try{a=l.stringify(a)}catch(catch$scope$var751069445){};i+='\n'+a+'\n'};return t?(t.value+=i+'\n-----\n',t.scrollTop=t.scrollHeight-t.clientHeight):e||c(i),!0},h.getInternetExplorerMajorVersion=function(){var e=h.getInternetExplorerMajorVersion.cached=typeof h.getInternetExplorerMajorVersion.cached!='undefined'?h.getInternetExplorerMajorVersion.cached:function(){var e=3,t=r.createElement('div'),n=t.getElementsByTagName('i');while((t.innerHTML='<!--[if gt IE '+(++e)+']><i></i><![endif]-->')&&n[0]);return e>4?e:!1}();return e},h.isInternetExplorer=function(){var e=h.isInternetExplorer.cached=typeof h.isInternetExplorer.cached!='undefined'?h.isInternetExplorer.cached:Boolean(h.getInternetExplorerMajorVersion());return e},h.options.html4Mode?h.emulated={pushState:!0,hashChange:!0}:h.emulated={pushState:!Boolean(e.history&&e.history.pushState&&e.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(i.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(i.userAgent)),hashChange:Boolean(!('onhashchange'in e||'onhashchange'in r)||h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8)},h.enabled=!h.emulated.pushState,h.bugs={setHash:Boolean(!h.emulated.pushState&&i.vendor==='Apple Computer, Inc.'&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),safariPoll:Boolean(!h.emulated.pushState&&i.vendor==='Apple Computer, Inc.'&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),ieDoubleCheck:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<7)},h.isEmptyObject=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},h.cloneObject=function(e){var t,n;return e?(t=l.stringify(e),n=l.parse(t)):n={},n},h.getRootUrl=function(){var e=r.location.protocol+'//'+(r.location.hostname||r.location.host);if(r.location.port||!1)e+=':'+r.location.port;return e+='/',e},h.getBaseHref=function(){var e=r.getElementsByTagName('base'),t=null,n='';return e.length===1&&(t=e[0],n=t.href.replace(/[^\/]+$/,'')),n=n.replace(/\/+$/,''),n&&(n+='/'),n},h.getBaseUrl=function(){var e=h.getBaseHref()||h.getBasePageUrl()||h.getRootUrl();return e},h.getPageUrl=function(){var e=h.getState(!1,!1),t=(e||{}).url||h.getLocationHref(),n;return n=t.replace(/\/+$/,'').replace(/[^\/]+$/,function(e,t,n){return/\./.test(e)?e:e+'/'}),n},h.getBasePageUrl=function(){var e=h.getLocationHref().replace(/[#\?].*/,'').replace(/[^\/]+$/,function(e,t,n){return/[^\/]$/.test(e)?'':e}).replace(/\/+$/,'')+'/';return e},h.getFullUrl=function(e,t){var n=e,r=e.substring(0,1);return t=typeof t=='undefined'?!0:t,/[a-z]+\:\/\//.test(e)||(r==='/'?n=h.getRootUrl()+e.replace(/^\/+/,''):r==='#'?n=h.getPageUrl().replace(/#.*/,'')+e:r==='?'?n=h.getPageUrl().replace(/[\?#].*/,'')+e:t?n=h.getBaseUrl()+e.replace(/^(\.\/)+/,''):n=h.getBasePageUrl()+e.replace(/^(\.\/)+/,'')),n.replace(/\#$/,'')},h.getShortUrl=function(e){var t=e,n=h.getBaseUrl(),r=h.getRootUrl();return h.emulated.pushState&&(t=t.replace(n,'')),t=t.replace(r,'/'),h.isTraditionalAnchor(t)&&(t='./'+t),t=t.replace(/^(\.\/)+/g,'./').replace(/\#$/,''),t},h.getLocationHref=function(e){return e=e||r,e.URL===e.location.href?e.location.href:e.location.href===decodeURIComponent(e.URL)?e.URL:e.location.hash&&decodeURIComponent(e.location.href.replace(/^[^#]+/,''))===e.location.hash?e.location.href:e.URL.indexOf('#')==-1&&e.location.href.indexOf('#')!=-1?e.location.href:e.URL||e.location.href},h.store={},h.idToState=h.idToState||{},h.stateToId=h.stateToId||{},h.urlToId=h.urlToId||{},h.storedStates=h.storedStates||[],h.savedStates=h.savedStates||[],h.normalizeStore=function(){h.store.idToState=h.store.idToState||{},h.store.urlToId=h.store.urlToId||{},h.store.stateToId=h.store.stateToId||{}},h.getState=function(e,t){typeof e=='undefined'&&(e=!0),typeof t=='undefined'&&(t=!0);var n=h.getLastSavedState();return!n&&t&&(n=h.createStateObject()),e&&(n=h.cloneObject(n),n.url=n.cleanUrl||n.url),n},h.getIdByState=function(e){var t=h.extractId(e.url),n;if(!t){n=h.getStateString(e);if(typeof h.stateToId[n]!='undefined')t=h.stateToId[n];else if(typeof h.store.stateToId[n]!='undefined')t=h.store.stateToId[n];else{for(;;){t=(new Date).getTime()+String(Math.random()).replace(/\D/g,'');if(typeof h.idToState[t]=='undefined'&&typeof h.store.idToState[t]=='undefined')break};h.stateToId[n]=t,h.idToState[t]=e}};return t},h.normalizeState=function(e){var t,n;if(!e||typeof e!='object')e={};if(typeof e.normalized!='undefined')return e;if(!e.data||typeof e.data!='object')e.data={};return t={},t.normalized=!0,t.title=e.title||'',t.url=h.getFullUrl(e.url?e.url:h.getLocationHref()),t.hash=h.getShortUrl(t.url),t.data=h.cloneObject(e.data),t.id=h.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,''),t.url=t.cleanUrl,n=!h.isEmptyObject(t.data),(t.title||n)&&h.options.disableSuid!==!0&&(t.hash=h.getShortUrl(t.url).replace(/\??\&_suid.*/,''),/\?/.test(t.hash)||(t.hash+='?'),t.hash+='&_suid='+t.id),t.hashedUrl=h.getFullUrl(t.hash),(h.emulated.pushState||h.bugs.safariPoll)&&h.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t},h.createStateObject=function(e,t,n){var r={data:e,title:t,url:n};return r=h.normalizeState(r),r},h.getStateById=function(e){e=String(e);var n=h.idToState[e]||h.store.idToState[e]||t;return n},h.getStateString=function(e){var t,n,r;return t=h.normalizeState(e),n={data:t.data,title:e.title,url:e.url},r=l.stringify(n),r},h.getStateId=function(e){var t,n;return t=h.normalizeState(e),n=t.id,n},h.getHashByState=function(e){var t,n;return t=h.normalizeState(e),n=t.hash,n},h.extractId=function(e){var t,n,r,i;return e.indexOf('#')!=-1?i=e.split('#')[0]:i=e,n=/(.*)\&_suid=([0-9]+)$/.exec(i),r=n?n[1]||e:e,t=n?String(n[2]||''):'',t||!1},h.isTraditionalAnchor=function(e){var t=!/[\/\?\.]/.test(e);return t},h.extractState=function(e,t){var n=null,r,i;return t=t||!1,r=h.extractId(e),r&&(n=h.getStateById(r)),n||(i=h.getFullUrl(e),r=h.getIdByUrl(i)||!1,r&&(n=h.getStateById(r)),!n&&t&&!h.isTraditionalAnchor(e)&&(n=h.createStateObject(null,null,i))),n},h.getIdByUrl=function(e){var n=h.urlToId[e]||h.store.urlToId[e]||t;return n},h.getLastSavedState=function(){return h.savedStates[h.savedStates.length-1]||t},h.getLastStoredState=function(){return h.storedStates[h.storedStates.length-1]||t},h.hasUrlDuplicate=function(e){var t=!1,n;return n=h.extractState(e.url),t=n&&n.id!==e.id,t},h.storeState=function(e){return h.urlToId[e.url]=e.id,h.storedStates.push(h.cloneObject(e)),e},h.isLastSavedState=function(e){var t=!1,n,r,i;return h.savedStates.length&&(n=e.id,r=h.getLastSavedState(),i=r.id,t=n===i),t},h.saveState=function(e){return h.isLastSavedState(e)?!1:(h.savedStates.push(h.cloneObject(e)),!0)},h.getStateByIndex=function(e){var t=null;return typeof e=='undefined'?t=h.savedStates[h.savedStates.length-1]:e<0?t=h.savedStates[h.savedStates.length+e]:t=h.savedStates[e],t},h.getCurrentIndex=function(){var e=null;return h.savedStates.length<1?e=0:e=h.savedStates.length-1,e},h.getHash=function(e){var t=h.getLocationHref(e),n;return n=h.getHashByUrl(t),n},h.unescapeHash=function(e){var t=h.normalizeHash(e);return t=decodeURIComponent(t),t},h.normalizeHash=function(e){var t=e.replace(/[^#]*#/,'').replace(/#.*/,'');return t},h.setHash=function(e,t){var n,i;return t!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.setHash,args:arguments,queue:t}),!1):(h.busy(!0),n=h.extractState(e,!0),n&&!h.emulated.pushState?h.pushState(n.data,n.title,n.url,!1):h.getHash()!==e&&(h.bugs.setHash?(i=h.getPageUrl(),h.pushState(null,null,i+'#'+e,!1)):r.location.hash=e),h)},h.escapeHash=function(t){var n=h.normalizeHash(t);return n=e.encodeURIComponent(n),h.bugs.hashEscape||(n=n.replace(/\%21/g,'!').replace(/\%26/g,'&').replace(/\%3D/g,'=').replace(/\%3F/g,'?')),n},h.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,'$2');return t=h.unescapeHash(t),t},h.setTitle=function(e){var t=e.title,n;t||(n=h.getStateByIndex(0),n&&n.url===e.url&&(t=n.title||h.options.initialTitle));try{r.getElementsByTagName('title')[0].innerHTML=t.replace('<','&lt;').replace('>','&gt;').replace(' & ',' &amp; ')}catch(catch$scope$var751069445){};return r.title=t,h},h.queues=[],h.busy=function(e){typeof e!='undefined'?h.busy.flag=e:typeof h.busy.flag=='undefined'&&(h.busy.flag=!1);if(!h.busy.flag){u(h.busy.timeout);var t=function(){var e,n,r;if(h.busy.flag)return;for(e=h.queues.length-1;e>=0;--e){n=h.queues[e];if(n.length===0)continue;r=n.shift(),h.fireQueueItem(r),h.busy.timeout=o(t,h.options.busyDelay)}};h.busy.timeout=o(t,h.options.busyDelay)};return h.busy.flag},h.busy.flag=!1,h.fireQueueItem=function(e){return e.callback.apply(e.scope||h,e.args||[])},h.pushQueue=function(e){return h.queues[e.queue||0]=h.queues[e.queue||0]||[],h.queues[e.queue||0].push(e),h},h.queue=function(e,t){return typeof e=='function'&&(e={callback:e}),typeof t!='undefined'&&(e.queue=t),h.busy()?h.pushQueue(e):h.fireQueueItem(e),h},h.clearQueue=function(){return h.busy.flag=!1,h.queues=[],h},h.stateChanged=!1,h.doubleChecker=!1,h.doubleCheckComplete=function(){return h.stateChanged=!0,h.doubleCheckClear(),h},h.doubleCheckClear=function(){return h.doubleChecker&&(u(h.doubleChecker),h.doubleChecker=!1),h},h.doubleCheck=function(e){return h.stateChanged=!1,h.doubleCheckClear(),h.bugs.ieDoubleCheck&&(h.doubleChecker=o(function(){return h.doubleCheckClear(),h.stateChanged||e(),!0},h.options.doubleCheckInterval)),h},h.safariStatePoll=function(){var t=h.extractState(h.getLocationHref()),n;if(!h.isLastSavedState(t))return n=t,n||(n=h.createStateObject()),h.Adapter.trigger(e,'popstate'),h;return},h.back=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.back,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.back(!1)}),p.go(-1),!0)},h.forward=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.forward,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.forward(!1)}),p.go(1),!0)},h.go=function(e,t){var n;if(e>0)for(n=1;n<=e;++n)h.forward(t);else{if(!(e<0))throw new Error('History.go: History.go requires a positive or negative integer passed.');for(n=-1;n>=e;--n)h.back(t)};return h};if(h.emulated.pushState){var v=function(){};h.pushState=h.pushState||v,h.replaceState=h.replaceState||v}else h.onPopState=function(t,n){var r=!1,i=!1,s,o;return h.doubleCheckComplete(),s=h.getHash(),s?(o=h.extractState(s||h.getLocationHref(),!0),o?h.replaceState(o.data,o.title,o.url,!1):(h.Adapter.trigger(e,'anchorchange'),h.busy(!1)),h.expectedStateId=!1,!1):(r=h.Adapter.extractEventData('state',t,n)||!1,r?i=h.getStateById(r):h.expectedStateId?i=h.getStateById(h.expectedStateId):i=h.extractState(h.getLocationHref()),i||(i=h.createStateObject(null,null,h.getLocationHref())),h.expectedStateId=!1,h.isLastSavedState(i)?(h.busy(!1),!1):(h.storeState(i),h.saveState(i),h.setTitle(i),h.Adapter.trigger(e,'statechange'),h.busy(!1),!0))},h.Adapter.bind(e,'popstate',h.onPopState),h.pushState=function(t,n,r,i){if(h.getHashByUrl(r)&&h.emulated.pushState)throw new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');if(i!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.pushState,args:arguments,queue:i}),!1;h.busy(!0);var s=h.createStateObject(t,n,r);return h.isLastSavedState(s)?h.busy(!1):(h.storeState(s),h.expectedStateId=s.id,p.pushState(s.id,s.title,s.url),h.Adapter.trigger(e,'popstate')),!0},h.replaceState=function(t,n,r,i){if(h.getHashByUrl(r)&&h.emulated.pushState)throw new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');if(i!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.replaceState,args:arguments,queue:i}),!1;h.busy(!0);var s=h.createStateObject(t,n,r);return h.isLastSavedState(s)?h.busy(!1):(h.storeState(s),h.expectedStateId=s.id,p.replaceState(s.id,s.title,s.url),h.Adapter.trigger(e,'popstate')),!0};if(s){try{h.store=l.parse(s.getItem('History.store'))||{}}catch(catch$scope$var751069445){h.store={}};h.normalizeStore()}else h.store={},h.normalizeStore();h.Adapter.bind(e,'unload',h.clearAllIntervals),h.saveState(h.storeState(h.extractState(h.getLocationHref(),!0))),s&&(h.onUnload=function(){var e,t,n;try{e=l.parse(s.getItem('History.store'))||{}}catch(catch$scope$var751069445){e={}};e.idToState=e.idToState||{},e.urlToId=e.urlToId||{},e.stateToId=e.stateToId||{};for(t in h.idToState){if(!h.idToState.hasOwnProperty(t))continue;e.idToState[t]=h.idToState[t]};for(t in h.urlToId){if(!h.urlToId.hasOwnProperty(t))continue;e.urlToId[t]=h.urlToId[t]};for(t in h.stateToId){if(!h.stateToId.hasOwnProperty(t))continue;e.stateToId[t]=h.stateToId[t]};h.store=e,h.normalizeStore(),n=l.stringify(e);try{s.setItem('History.store',n)}catch(catch$scope$var751069445){if(catch$scope$var751069445.code!==DOMException.QUOTA_EXCEEDED_ERR)throw catch$scope$var751069445;s.length&&(s.removeItem('History.store'),s.setItem('History.store',n))}},h.intervalList.push(a(h.onUnload,h.options.storeInterval)),h.Adapter.bind(e,'beforeunload',h.onUnload),h.Adapter.bind(e,'unload',h.onUnload));if(!h.emulated.pushState){h.bugs.safariPoll&&h.intervalList.push(a(h.safariStatePoll,h.options.safariPollInterval));if(i.vendor==='Apple Computer, Inc.'||(i.appCodeName||'')==='Mozilla')h.Adapter.bind(e,'hashchange',function(){h.Adapter.trigger(e,'popstate')}),h.getHash()&&h.Adapter.onDomLoad(function(){h.Adapter.trigger(e,'hashchange')})}},(!h.options||!h.options.delayInit)&&h.init()}(window);(function(factory){if(typeof define==='function'&&define.amd){define(['inputmask.dependencyLib'],factory)}else if(typeof exports==='object'){module.exports=factory(require('./inputmask.dependencyLib.jquery'))}else{factory(window.dependencyLib||jQuery)}}(function($){function Inputmask(alias,options){if(!(this instanceof Inputmask)){return new Inputmask(alias,options)};if($.isPlainObject(alias)){options=alias}else{options=options||{};options.alias=alias};this.el=undefined;this.opts=$.extend(true,{},this.defaults,options);this.noMasksCache=options&&options.definitions!==undefined;this.userOptions=options||{};this.events={};resolveAlias(this.opts.alias,options,this.opts)};Inputmask.prototype={defaults:{placeholder:'_',optionalmarker:{start:'[',end:']'},quantifiermarker:{start:'{',end:'}'},groupmarker:{start:'(',end:')'},alternatormarker:'|',escapeChar:'\\',mask:null,oncomplete:$.noop,onincomplete:$.noop,oncleared:$.noop,repeat:0,greedy:true,autoUnmask:false,removeMaskOnSubmit:false,clearMaskOnLostFocus:true,insertMode:true,clearIncomplete:false,aliases:{},alias:null,onKeyDown:$.noop,onBeforeMask:null,onBeforePaste:function(pastedValue,opts){return $.isFunction(opts.onBeforeMask)?opts.onBeforeMask(pastedValue,opts):pastedValue},onBeforeWrite:null,onUnMask:null,showMaskOnFocus:true,showMaskOnHover:true,onKeyValidation:$.noop,skipOptionalPartCharacter:' ',showTooltip:false,tooltip:undefined,numericInput:false,rightAlign:false,undoOnEscape:true,radixPoint:'',radixPointDefinitionSymbol:undefined,groupSeparator:'',keepStatic:null,positionCaretOnTab:false,tabThrough:false,supportsInputType:['text','tel','password'],definitions:{'9':{validator:'[0-9]',cardinality:1,definitionSymbol:'*'},'a':{validator:'[A-Za-z\u0410-\u044F\u0401\u0451\u00C0-\u00FF\u00B5]',cardinality:1,definitionSymbol:'*'},'*':{validator:'[0-9A-Za-z\u0410-\u044F\u0401\u0451\u00C0-\u00FF\u00B5]',cardinality:1}},ignorables:[8,9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],isComplete:null,canClearPosition:$.noop,postValidation:null,staticDefinitionSymbol:undefined,jitMasking:false,nullable:true,inputEventOnly:false,positionCaretOnClick:'lvp'},masksCache:{},mask:function(elems){var that=this;if(typeof elems==='string'){elems=document.getElementById(elems)||document.querySelectorAll(elems)};elems=elems.nodeName?[elems]:elems;$.each(elems,function(ndx,el){var scopedOpts=$.extend(true,{},that.opts);importAttributeOptions(el,scopedOpts,$.extend(true,{},that.userOptions));var maskset=generateMaskSet(scopedOpts,that.noMasksCache);if(maskset!==undefined){if(el.inputmask!==undefined){el.inputmask.remove()};el.inputmask=new Inputmask();el.inputmask.opts=scopedOpts;el.inputmask.noMasksCache=that.noMasksCache;el.inputmask.userOptions=$.extend(true,{},that.userOptions);el.inputmask.el=el;el.inputmask.maskset=maskset;el.inputmask.isRTL=false;$.data(el,'_inputmask_opts',scopedOpts);maskScope({'action':'mask','el':el})}});return elems&&elems[0]?(elems[0].inputmask||this):this},option:function(options,noremask){if(typeof options==='string'){return this.opts[options]}else if(typeof options==='object'){$.extend(this.userOptions,options);if(this.el&&noremask!==true){this.mask(this.el)};return this}},unmaskedvalue:function(value){return maskScope({'action':'unmaskedvalue','el':this.el,'value':value},this.el&&this.el.inputmask?this.el.inputmask.maskset:generateMaskSet(this.opts,this.noMasksCache),this.opts)},remove:function(){if(this.el){maskScope({'action':'remove','el':this.el});this.el.inputmask=undefined;return this.el}},getemptymask:function(){return maskScope({'action':'getemptymask'},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts)},hasMaskedValue:function(){return!this.opts.autoUnmask},isComplete:function(){return maskScope({'action':'isComplete','el':this.el},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts)},getmetadata:function(){return maskScope({'action':'getmetadata'},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts)},isValid:function(value){return maskScope({'action':'isValid','value':value},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts)},format:function(value,metadata){return maskScope({'action':'format','value':value,'metadata':metadata},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts)}};Inputmask.extendDefaults=function(options){$.extend(true,Inputmask.prototype.defaults,options)};Inputmask.extendDefinitions=function(definition){$.extend(true,Inputmask.prototype.defaults.definitions,definition)};Inputmask.extendAliases=function(alias){$.extend(true,Inputmask.prototype.defaults.aliases,alias)};Inputmask.format=function(value,options,metadata){return Inputmask(options).format(value,metadata)};Inputmask.unmask=function(value,options){return Inputmask(options).unmaskedvalue(value)};Inputmask.isValid=function(value,options){return Inputmask(options).isValid(value)};Inputmask.remove=function(elems){$.each(elems,function(ndx,el){if(el.inputmask)el.inputmask.remove()})};Inputmask.escapeRegex=function(str){var specials=['/','.','*','+','?','|','(',')','[',']','{','}','\\','$','^'];return str.replace(new RegExp('(\\'+specials.join('|\\')+')','gim'),'\\$1')};Inputmask.keyCode={ALT:18,BACKSPACE:8,BACKSPACE_SAFARI:127,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91,X:88};function isInputEventSupported(eventName){var el=document.createElement('input'),evName='on'+eventName,isSupported=(evName in el);if(!isSupported){el.setAttribute(evName,'return;');isSupported=typeof el[evName]=='function'};el=null;return isSupported};function isElementTypeSupported(input,opts){var elementType=input.getAttribute('type'),isSupported=(input.tagName==='INPUT'&&$.inArray(elementType,opts.supportsInputType)!==-1)||input.isContentEditable||input.tagName==='TEXTAREA';if(!isSupported&&input.tagName==='INPUT'){var el=document.createElement('input');el.setAttribute('type',elementType);isSupported=el.type==='text';el=null};return isSupported};function resolveAlias(aliasStr,options,opts){var aliasDefinition=opts.aliases[aliasStr];if(aliasDefinition){if(aliasDefinition.alias)resolveAlias(aliasDefinition.alias,undefined,opts);$.extend(true,opts,aliasDefinition);$.extend(true,opts,options);return true}else if(opts.mask===null){opts.mask=aliasStr};return false};function importAttributeOptions(npt,opts,userOptions){var attrOptions=npt.getAttribute('data-inputmask'),option,dataoptions,optionData,p;function importOption(option,optionData){optionData=optionData!==undefined?optionData:npt.getAttribute('data-inputmask-'+option);if(optionData!==null){if(typeof optionData==='string'){if(option.indexOf('on')===0)optionData=window[optionData];else if(optionData==='false')optionData=false;else if(optionData==='true')optionData=true};userOptions[option]=optionData}};if(attrOptions&&attrOptions!==''){attrOptions=attrOptions.replace(new RegExp('\'','g'),'"');dataoptions=JSON.parse('{'+attrOptions+'}')};if(dataoptions){optionData=undefined;for(p in dataoptions){if(p.toLowerCase()==='alias'){optionData=dataoptions[p];break}}};importOption('alias',optionData);if(userOptions.alias){resolveAlias(userOptions.alias,userOptions,opts)};for(option in opts){if(dataoptions){optionData=undefined;for(p in dataoptions){if(p.toLowerCase()===option.toLowerCase()){optionData=dataoptions[p];break}}};importOption(option,optionData)};$.extend(true,opts,userOptions);return opts};function generateMaskSet(opts,nocache){var ms;function analyseMask(mask){var tokenizer=/(?:[?*+]|\{[0-9\+\*]+(?:,[0-9\+\*]*)?\})|[^.?*+^${[]()|\\]+|./g,escaped=false,currentToken=new MaskToken(),match,m,openenings=[],maskTokens=[],openingToken,currentOpeningToken,alternator,lastMatch,groupToken;function MaskToken(isGroup,isOptional,isQuantifier,isAlternator){this.matches=[];this.isGroup=isGroup||false;this.isOptional=isOptional||false;this.isQuantifier=isQuantifier||false;this.isAlternator=isAlternator||false;this.quantifier={min:1,max:1}};function insertTestDefinition(mtoken,element,position){var maskdef=opts.definitions[element];position=position!==undefined?position:mtoken.matches.length;var prevMatch=mtoken.matches[position-1];if(maskdef&&!escaped){maskdef.placeholder=$.isFunction(maskdef.placeholder)?maskdef.placeholder(opts):maskdef.placeholder;var prevalidators=maskdef.prevalidator,prevalidatorsL=prevalidators?prevalidators.length:0;for(var i=1;i<maskdef.cardinality;i++){var prevalidator=prevalidatorsL>=i?prevalidators[i-1]:[],validator=prevalidator.validator,cardinality=prevalidator.cardinality;mtoken.matches.splice(position++,0,{fn:validator?typeof validator==='string'?new RegExp(validator):new function(){this.test=validator}:new RegExp('.'),cardinality:cardinality?cardinality:1,optionality:mtoken.isOptional,newBlockMarker:prevMatch===undefined||prevMatch.def!==(maskdef.definitionSymbol||element),casing:maskdef.casing,def:maskdef.definitionSymbol||element,placeholder:maskdef.placeholder,mask:element});prevMatch=mtoken.matches[position-1]};mtoken.matches.splice(position++,0,{fn:maskdef.validator?typeof maskdef.validator=='string'?new RegExp(maskdef.validator):new function(){this.test=maskdef.validator}:new RegExp('.'),cardinality:maskdef.cardinality,optionality:mtoken.isOptional,newBlockMarker:prevMatch===undefined||prevMatch.def!==(maskdef.definitionSymbol||element),casing:maskdef.casing,def:maskdef.definitionSymbol||element,placeholder:maskdef.placeholder,mask:element})}else{mtoken.matches.splice(position++,0,{fn:null,cardinality:0,optionality:mtoken.isOptional,newBlockMarker:prevMatch===undefined||prevMatch.def!==element,casing:null,def:opts.staticDefinitionSymbol||element,placeholder:opts.staticDefinitionSymbol!==undefined?element:undefined,mask:element});escaped=false}};function verifyGroupMarker(lastMatch,isOpenGroup){if(lastMatch.isGroup){lastMatch.isGroup=false;insertTestDefinition(lastMatch,opts.groupmarker.start,0);if(isOpenGroup!==true){insertTestDefinition(lastMatch,opts.groupmarker.end)}}};function maskCurrentToken(m,currentToken,lastMatch,extraCondition){if(currentToken.matches.length>0&&(extraCondition===undefined||extraCondition)){lastMatch=currentToken.matches[currentToken.matches.length-1];verifyGroupMarker(lastMatch)};insertTestDefinition(currentToken,m)};function defaultCase(){if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];maskCurrentToken(m,currentOpeningToken,lastMatch,!currentOpeningToken.isAlternator);if(currentOpeningToken.isAlternator){alternator=openenings.pop();for(var mndx=0;mndx<alternator.matches.length;mndx++){alternator.matches[mndx].isGroup=false};if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];currentOpeningToken.matches.push(alternator)}else{currentToken.matches.push(alternator)}}}else{maskCurrentToken(m,currentToken,lastMatch)}};function reverseTokens(maskToken){function reverseStatic(st){if(st===opts.optionalmarker.start)st=opts.optionalmarker.end;else if(st===opts.optionalmarker.end)st=opts.optionalmarker.start;else if(st===opts.groupmarker.start)st=opts.groupmarker.end;else if(st===opts.groupmarker.end)st=opts.groupmarker.start;return st};maskToken.matches=maskToken.matches.reverse();for(var match in maskToken.matches){var intMatch=parseInt(match);if(maskToken.matches[match].isQuantifier&&maskToken.matches[intMatch+1]&&maskToken.matches[intMatch+1].isGroup){var qt=maskToken.matches[match];maskToken.matches.splice(match,1);maskToken.matches.splice(intMatch+1,0,qt)};if(maskToken.matches[match].matches!==undefined){maskToken.matches[match]=reverseTokens(maskToken.matches[match])}else{maskToken.matches[match]=reverseStatic(maskToken.matches[match])}};return maskToken}while(match=tokenizer.exec(mask)){m=match[0];if(escaped){defaultCase();continue};switch(m.charAt(0)){case opts.escapeChar:escaped=true;break;case opts.optionalmarker.end:case opts.groupmarker.end:openingToken=openenings.pop();if(openingToken!==undefined){if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];currentOpeningToken.matches.push(openingToken);if(currentOpeningToken.isAlternator){alternator=openenings.pop();for(var mndx=0;mndx<alternator.matches.length;mndx++){alternator.matches[mndx].isGroup=false};if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];currentOpeningToken.matches.push(alternator)}else{currentToken.matches.push(alternator)}}}else{currentToken.matches.push(openingToken)}}else defaultCase();break;case opts.optionalmarker.start:openenings.push(new MaskToken(false,true));break;case opts.groupmarker.start:openenings.push(new MaskToken(true));break;case opts.quantifiermarker.start:var quantifier=new MaskToken(false,false,true);m=m.replace(/[{}]/g,'');var mq=m.split(','),mq0=isNaN(mq[0])?mq[0]:parseInt(mq[0]),mq1=mq.length===1?mq0:(isNaN(mq[1])?mq[1]:parseInt(mq[1]));if(mq1==='*'||mq1==='+'){mq0=mq1==='*'?0:1};quantifier.quantifier={min:mq0,max:mq1};if(openenings.length>0){var matches=openenings[openenings.length-1].matches;match=matches.pop();if(!match.isGroup){groupToken=new MaskToken(true);groupToken.matches.push(match);match=groupToken};matches.push(match);matches.push(quantifier)}else{match=currentToken.matches.pop();if(!match.isGroup){groupToken=new MaskToken(true);groupToken.matches.push(match);match=groupToken};currentToken.matches.push(match);currentToken.matches.push(quantifier)};break;case opts.alternatormarker:if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];lastMatch=currentOpeningToken.matches.pop()}else{lastMatch=currentToken.matches.pop()};if(lastMatch.isAlternator){openenings.push(lastMatch)}else{alternator=new MaskToken(false,false,false,true);alternator.matches.push(lastMatch);openenings.push(alternator)};break;default:defaultCase()}}while(openenings.length>0){openingToken=openenings.pop();verifyGroupMarker(openingToken,true);currentToken.matches.push(openingToken)};if(currentToken.matches.length>0){lastMatch=currentToken.matches[currentToken.matches.length-1];verifyGroupMarker(lastMatch);maskTokens.push(currentToken)};if(opts.numericInput){reverseTokens(maskTokens[0])};return maskTokens};function generateMask(mask,metadata){if(mask===null||mask===''){return undefined}else{if(mask.length===1&&opts.greedy===false&&opts.repeat!==0){opts.placeholder=''};if(opts.repeat>0||opts.repeat==='*'||opts.repeat==='+'){var repeatStart=opts.repeat==='*'?0:(opts.repeat==='+'?1:opts.repeat);mask=opts.groupmarker.start+mask+opts.groupmarker.end+opts.quantifiermarker.start+repeatStart+','+opts.repeat+opts.quantifiermarker.end};var masksetDefinition;if(Inputmask.prototype.masksCache[mask]===undefined||nocache===true){masksetDefinition={'mask':mask,'maskToken':analyseMask(mask),'validPositions':{},'_buffer':undefined,'buffer':undefined,'tests':{},'metadata':metadata};if(nocache!==true){Inputmask.prototype.masksCache[opts.numericInput?mask.split('').reverse().join(''):mask]=masksetDefinition;masksetDefinition=$.extend(true,{},Inputmask.prototype.masksCache[opts.numericInput?mask.split('').reverse().join(''):mask])}}else masksetDefinition=$.extend(true,{},Inputmask.prototype.masksCache[opts.numericInput?mask.split('').reverse().join(''):mask]);return masksetDefinition}};function preProcessMask(mask){mask=mask.toString();return mask};if($.isFunction(opts.mask)){opts.mask=opts.mask(opts)};if($.isArray(opts.mask)){if(opts.mask.length>1){opts.keepStatic=opts.keepStatic===null?true:opts.keepStatic;var altMask='(';$.each(opts.numericInput?opts.mask.reverse():opts.mask,function(ndx,msk){if(altMask.length>1){altMask+=')|('};if(msk.mask!==undefined&&!$.isFunction(msk.mask)){altMask+=preProcessMask(msk.mask)}else{altMask+=preProcessMask(msk)}});altMask+=')';return generateMask(altMask,opts.mask)}else opts.mask=opts.mask.pop()};if(opts.mask){if(opts.mask.mask!==undefined&&!$.isFunction(opts.mask.mask)){ms=generateMask(preProcessMask(opts.mask.mask),opts.mask)}else{ms=generateMask(preProcessMask(opts.mask),opts.mask)}};return ms};var ua=navigator.userAgent,mobile=/mobile/i.test(ua),iemobile=/iemobile/i.test(ua),iphone=/iphone/i.test(ua)&&!iemobile;function maskScope(actionObj,maskset,opts){var isRTL=false,undoValue,el,$el,skipKeyPressEvent=false,skipInputEvent=false,ignorable=false,maxLength,mouseEnter=true;function getMaskTemplate(baseOnInput,minimalPos,includeInput){minimalPos=minimalPos||0;var maskTemplate=[],ndxIntlzr,pos=0,test,testPos,lvp=getLastValidPosition();maxLength=el!==undefined?el.maxLength:undefined;if(maxLength===-1)maxLength=undefined;do{if(baseOnInput===true&&getMaskSet().validPositions[pos]){var validPos=getMaskSet().validPositions[pos];test=validPos.match;ndxIntlzr=validPos.locator.slice();maskTemplate.push(includeInput===true?validPos.input:getPlaceholder(pos,test))}else{testPos=getTestTemplate(pos,ndxIntlzr,pos-1);test=testPos.match;ndxIntlzr=testPos.locator.slice();if(opts.jitMasking===false||pos<lvp||(isFinite(opts.jitMasking)&&opts.jitMasking>pos)){maskTemplate.push(getPlaceholder(pos,test))}};pos++}while((maxLength===undefined||pos<maxLength)&&(test.fn!==null||test.def!=='')||minimalPos>pos);if(maskTemplate[maskTemplate.length-1]===''){maskTemplate.pop()};getMaskSet().maskLength=pos+1;return maskTemplate};function getMaskSet(){return maskset};function resetMaskSet(soft){var maskset=getMaskSet();maskset.buffer=undefined;if(soft!==true){maskset._buffer=undefined;maskset.validPositions={};maskset.p=0}};function getLastValidPosition(closestTo,strict,validPositions){var before=-1,after=-1,valids=validPositions||getMaskSet().validPositions;if(closestTo===undefined)closestTo=-1;for(var posNdx in valids){var psNdx=parseInt(posNdx);if(valids[psNdx]&&(strict||valids[psNdx].match.fn!==null)){if(psNdx<=closestTo)before=psNdx;if(psNdx>=closestTo)after=psNdx}};return(before!==-1&&(closestTo-before)>1)||after<closestTo?before:after};function setValidPosition(pos,validTest,fromSetValid,isSelection){if(isSelection||(opts.insertMode&&getMaskSet().validPositions[pos]!==undefined&&fromSetValid===undefined)){var positionsClone=$.extend(true,{},getMaskSet().validPositions),lvp=getLastValidPosition(),i;for(i=pos;i<=lvp;i++){delete getMaskSet().validPositions[i]};getMaskSet().validPositions[pos]=validTest;var valid=true,j,vps=getMaskSet().validPositions,needsValidation=false;for(i=(j=pos);i<=lvp;i++){var t=positionsClone[i];if(t!==undefined){var posMatch=j,prevPosMatch=-1;while(posMatch<getMaskSet().maskLength&&((t.match.fn==null&&vps[i]&&(vps[i].match.optionalQuantifier===true||vps[i].match.optionality===true))||t.match.fn!=null)){if(t.match.fn===null||(!opts.keepStatic&&vps[i]&&(vps[i+1]!==undefined&&getTests(i+1,vps[i].locator.slice(),i).length>1||vps[i].alternation!==undefined))){posMatch++}else posMatch=seekNext(j);if(needsValidation===false&&positionsClone[posMatch]&&positionsClone[posMatch].match.def===t.match.def){getMaskSet().validPositions[posMatch]=$.extend(true,{},positionsClone[posMatch]);getMaskSet().validPositions[posMatch].input=t.input;j=posMatch;valid=true;break}else if(positionCanMatchDefinition(posMatch,t.match.def)){var result=isValid(posMatch,t.input,true,true);valid=result!==false;j=(result.caret||result.insert)?getLastValidPosition():posMatch;needsValidation=true;if(valid)break}else{valid=t.match.fn==null;if(prevPosMatch===posMatch)break;prevPosMatch=posMatch}}};if(!valid)break};if(!valid){getMaskSet().validPositions=$.extend(true,{},positionsClone);resetMaskSet(true);return false}}else getMaskSet().validPositions[pos]=validTest;resetMaskSet(true);return true};function stripValidPositions(start,end,nocheck,strict){function IsEnclosedStatic(pos){var posMatch=getMaskSet().validPositions[pos];if(posMatch!==undefined&&posMatch.match.fn===null){var prevMatch=getMaskSet().validPositions[pos-1],nextMatch=getMaskSet().validPositions[pos+1];return prevMatch!==undefined&&nextMatch!==undefined};return false};var i,startPos=start,positionsClone=$.extend(true,{},getMaskSet().validPositions),needsValidation=false;getMaskSet().p=start;for(i=end-1;i>=startPos;i--){if(getMaskSet().validPositions[i]!==undefined){if(nocheck===true||(!IsEnclosedStatic(i)&&opts.canClearPosition(getMaskSet(),i,getLastValidPosition(),strict,opts)!==false)){delete getMaskSet().validPositions[i]}}};resetMaskSet(true);for(i=startPos+1;i<=getLastValidPosition();){while(getMaskSet().validPositions[startPos]!==undefined)startPos++;var s=getMaskSet().validPositions[startPos];if(i<startPos)i=startPos+1;if((getMaskSet().validPositions[i]!==undefined||!isMask(i))&&s===undefined){var t=getTestTemplate(i);if(needsValidation===false&&positionsClone[startPos]&&positionsClone[startPos].match.def===t.match.def){getMaskSet().validPositions[startPos]=$.extend(true,{},positionsClone[startPos]);getMaskSet().validPositions[startPos].input=t.input;delete getMaskSet().validPositions[i];i++}else if(positionCanMatchDefinition(startPos,t.match.def)){if(isValid(startPos,t.input||getPlaceholder(i),true)!==false){delete getMaskSet().validPositions[i];i++;needsValidation=true}}else if(!isMask(i)){i++;startPos--};startPos++}else i++};resetMaskSet(true)};function determineTestTemplate(tests,ignoreGreedy){var testPos,testPositions=tests,lvp=getLastValidPosition(),lvTest=getMaskSet().validPositions[lvp]||getTests(0)[0],lvTestAltArr=(lvTest.alternation!==undefined)?lvTest.locator[lvTest.alternation].toString().split(','):[];for(var ndx=0;ndx<testPositions.length;ndx++){testPos=testPositions[ndx];if(testPos.match&&((((opts.greedy||ignoreGreedy)&&testPos.match.optionalQuantifier!==true)||(testPos.match.optionality===false||testPos.match.newBlockMarker===false)&&testPos.match.optionalQuantifier!==true)&&((lvTest.alternation===undefined||lvTest.alternation!==testPos.alternation)||(testPos.locator[lvTest.alternation]!==undefined&&checkAlternationMatch(testPos.locator[lvTest.alternation].toString().split(','),lvTestAltArr))))){break}};return testPos};function getTestTemplate(pos,ndxIntlzr,tstPs){return getMaskSet().validPositions[pos]||determineTestTemplate(getTests(pos,ndxIntlzr?ndxIntlzr.slice():ndxIntlzr,tstPs))};function getTest(pos){if(getMaskSet().validPositions[pos]){return getMaskSet().validPositions[pos]};return getTests(pos)[0]};function positionCanMatchDefinition(pos,def){var valid=false,tests=getTests(pos);for(var tndx=0;tndx<tests.length;tndx++){if(tests[tndx].match&&tests[tndx].match.def===def){valid=true;break}};return valid};function selectBestMatch(pos,alternateNdx){var bestMatch,indexPos;if(getMaskSet().tests[pos]||getMaskSet().validPositions[pos]){$.each(getMaskSet().tests[pos]||[getMaskSet().validPositions[pos]],function(ndx,lmnt){var ndxPos=lmnt.alternation?lmnt.locator[lmnt.alternation].toString().indexOf(alternateNdx):-1;if((indexPos===undefined||ndxPos<indexPos)&&ndxPos!==-1){bestMatch=lmnt;indexPos=ndxPos}})};return bestMatch};function getTests(pos,ndxIntlzr,tstPs){var maskTokens=getMaskSet().maskToken,testPos=ndxIntlzr?tstPs:0,ndxInitializer=ndxIntlzr?ndxIntlzr.slice():[0],matches=[],insertStop=false,latestMatch,cacheDependency=ndxIntlzr?ndxIntlzr.join(''):'';function resolveTestFromToken(maskToken,ndxInitializer,loopNdx,quantifierRecurse){function handleMatch(match,loopNdx,quantifierRecurse){function isFirstMatch(latestMatch,tokenGroup){var firstMatch=$.inArray(latestMatch,tokenGroup.matches)===0;if(!firstMatch){$.each(tokenGroup.matches,function(ndx,match){if(match.isQuantifier===true){firstMatch=isFirstMatch(latestMatch,tokenGroup.matches[ndx-1]);if(firstMatch)return false}})};return firstMatch};function resolveNdxInitializer(pos,alternateNdx){var bestMatch=selectBestMatch(pos,alternateNdx);return bestMatch?bestMatch.locator.slice(bestMatch.alternation+1):[]};if(testPos>10000){throw'Inputmask: There is probably an error in your mask definition or in the code. Create an issue on github with an example of the mask you are using. '+getMaskSet().mask;};if(testPos===pos&&match.matches===undefined){matches.push({'match':match,'locator':loopNdx.reverse(),'cd':cacheDependency});return true}else if(match.matches!==undefined){if(match.isGroup&&quantifierRecurse!==match){match=handleMatch(maskToken.matches[$.inArray(match,maskToken.matches)+1],loopNdx);if(match)return true}else if(match.isOptional){var optionalToken=match;match=resolveTestFromToken(match,ndxInitializer,loopNdx,quantifierRecurse);if(match){latestMatch=matches[matches.length-1].match;if(isFirstMatch(latestMatch,optionalToken)){insertStop=true;testPos=pos}else return true}}else if(match.isAlternator){var alternateToken=match,malternateMatches=[],maltMatches,currentMatches=matches.slice(),loopNdxCnt=loopNdx.length,altIndex=ndxInitializer.length>0?ndxInitializer.shift():-1;if(altIndex===-1||typeof altIndex==='string'){var currentPos=testPos,ndxInitializerClone=ndxInitializer.slice(),altIndexArr=[],amndx;if(typeof altIndex=='string'){altIndexArr=altIndex.split(',')}else{for(amndx=0;amndx<alternateToken.matches.length;amndx++){altIndexArr.push(amndx)}};for(var ndx=0;ndx<altIndexArr.length;ndx++){amndx=parseInt(altIndexArr[ndx]);matches=[];ndxInitializer=resolveNdxInitializer(testPos,amndx);match=handleMatch(alternateToken.matches[amndx]||maskToken.matches[amndx],[amndx].concat(loopNdx),quantifierRecurse)||match;if(match!==true&&match!==undefined&&(altIndexArr[altIndexArr.length-1]<alternateToken.matches.length)){var ntndx=$.inArray(match,maskToken.matches)+1;if(maskToken.matches.length>ntndx){match=handleMatch(maskToken.matches[ntndx],[ntndx].concat(loopNdx.slice(1,loopNdx.length)),quantifierRecurse);if(match){altIndexArr.push(ntndx.toString());$.each(matches,function(ndx,lmnt){lmnt.alternation=loopNdx.length-1})}}};maltMatches=matches.slice();testPos=currentPos;matches=[];for(var i=0;i<ndxInitializerClone.length;i++){ndxInitializer[i]=ndxInitializerClone[i]};for(var ndx1=0;ndx1<maltMatches.length;ndx1++){var altMatch=maltMatches[ndx1],hasMatch=false;altMatch.alternation=altMatch.alternation||loopNdxCnt;for(var ndx2=0;ndx2<malternateMatches.length;ndx2++){var altMatch2=malternateMatches[ndx2];if(altMatch.match.def===altMatch2.match.def&&(typeof altIndex!=='string'||$.inArray(altMatch.locator[altMatch.alternation].toString(),altIndexArr)!==-1)){hasMatch=altMatch.match.mask===altMatch2.match.mask;if(altMatch2.locator[altMatch.alternation].toString().indexOf(altMatch.locator[altMatch.alternation])===-1){altMatch2.locator[altMatch.alternation]=altMatch2.locator[altMatch.alternation]+','+altMatch.locator[altMatch.alternation];altMatch2.alternation=altMatch.alternation};break}};if(!hasMatch){malternateMatches.push(altMatch)}}};if(typeof altIndex=='string'){malternateMatches=$.map(malternateMatches,function(lmnt,ndx){if(isFinite(ndx)){var mamatch,alternation=lmnt.alternation,altLocArr=lmnt.locator[alternation].toString().split(',');lmnt.locator[alternation]=undefined;lmnt.alternation=undefined;for(var alndx=0;alndx<altLocArr.length;alndx++){mamatch=$.inArray(altLocArr[alndx],altIndexArr)!==-1;if(mamatch){if(lmnt.locator[alternation]!==undefined){lmnt.locator[alternation]+=',';lmnt.locator[alternation]+=altLocArr[alndx]}else lmnt.locator[alternation]=parseInt(altLocArr[alndx]);lmnt.alternation=alternation}};if(lmnt.locator[alternation]!==undefined)return lmnt}})};matches=currentMatches.concat(malternateMatches);testPos=pos;insertStop=matches.length>0}else{match=handleMatch(alternateToken.matches[altIndex]||maskToken.matches[altIndex],[altIndex].concat(loopNdx),quantifierRecurse)};if(match)return true}else if(match.isQuantifier&&quantifierRecurse!==maskToken.matches[$.inArray(match,maskToken.matches)-1]){var qt=match;for(var qndx=(ndxInitializer.length>0)?ndxInitializer.shift():0;(qndx<(isNaN(qt.quantifier.max)?qndx+1:qt.quantifier.max))&&testPos<=pos;qndx++){var tokenGroup=maskToken.matches[$.inArray(qt,maskToken.matches)-1];match=handleMatch(tokenGroup,[qndx].concat(loopNdx),tokenGroup);if(match){latestMatch=matches[matches.length-1].match;latestMatch.optionalQuantifier=qndx>(qt.quantifier.min-1);if(isFirstMatch(latestMatch,tokenGroup)){if(qndx>(qt.quantifier.min-1)){insertStop=true;testPos=pos;break}else return true}else{return true}}}}else{match=resolveTestFromToken(match,ndxInitializer,loopNdx,quantifierRecurse);if(match)return true}}else testPos++};for(var tndx=(ndxInitializer.length>0?ndxInitializer.shift():0);tndx<maskToken.matches.length;tndx++){if(maskToken.matches[tndx].isQuantifier!==true){var match=handleMatch(maskToken.matches[tndx],[tndx].concat(loopNdx),quantifierRecurse);if(match&&testPos===pos){return match}else if(testPos>pos){break}}}};function mergeLocators(tests){var locator=[];if(!$.isArray(tests))tests=[tests];if(tests.length>0){if(tests[0].alternation===undefined){locator=determineTestTemplate(tests.slice()).locator.slice();if(locator.length===0)locator=tests[0].locator.slice()}else{$.each(tests,function(ndx,tst){if(tst.def!==''){if(locator.length===0)locator=tst.locator.slice();else{for(var i=0;i<locator.length;i++){if(tst.locator[i]&&locator[i].toString().indexOf(tst.locator[i])===-1){locator[i]+=','+tst.locator[i]}}}}})}};return locator};function filterTests(tests){if(false&&ndxIntlzr!==undefined){var temp=$.map(tests,function(test){var match=true;for(var i=0,ndxtl=tests.length,ndxil=ndxIntlzr?ndxIntlzr.length:0;i<ndxil;i++){if((typeof test.locator[i]==='string'&&!checkAlternationMatch(test.locator[i].split(','),ndxIntlzr[i].toString().split(',')))||(typeof test.locator[i]!=='string'&&(test.locator[i]<ndxIntlzr[i]&&(i!==ndxil-1||i!==ndxtl-1)))){match=false;break}};if(match){return test}});if(temp.length==0){console.log(JSON.stringify(tests))};return temp};return tests};if(pos>-1){if(ndxIntlzr===undefined){var previousPos=pos-1,test;while((test=getMaskSet().validPositions[previousPos]||getMaskSet().tests[previousPos])===undefined&&previousPos>-1){previousPos--};if(test!==undefined&&previousPos>-1){ndxInitializer=mergeLocators(test);cacheDependency=ndxInitializer.join('');testPos=previousPos}};if(getMaskSet().tests[pos]&&getMaskSet().tests[pos][0].cd===cacheDependency){return filterTests(getMaskSet().tests[pos])}else{};for(var mtndx=ndxInitializer.shift();mtndx<maskTokens.length;mtndx++){var match=resolveTestFromToken(maskTokens[mtndx],ndxInitializer,[mtndx]);if((match&&testPos===pos)||testPos>pos){break}}};if(matches.length===0||insertStop){matches.push({match:{fn:null,cardinality:0,optionality:true,casing:null,def:'',placeholder:''},locator:[],cd:cacheDependency})};if(ndxIntlzr!==undefined&&getMaskSet().tests[pos]){return $.extend(true,[],matches)};getMaskSet().tests[pos]=$.extend(true,[],matches);return getMaskSet().tests[pos]};function getBufferTemplate(){if(getMaskSet()._buffer===undefined){getMaskSet()._buffer=getMaskTemplate(false,1);if(getMaskSet().buffer===undefined){getMaskSet()._buffer.slice()}};return getMaskSet()._buffer};function getBuffer(noCache){if(getMaskSet().buffer===undefined||noCache===true){getMaskSet().buffer=getMaskTemplate(true,getLastValidPosition(),true)};return getMaskSet().buffer};function refreshFromBuffer(start,end,buffer){var i;if(start===true){resetMaskSet();start=0;end=buffer.length}else{for(i=start;i<end;i++){delete getMaskSet().validPositions[i]}};for(i=start;i<end;i++){resetMaskSet(true);if(buffer[i]!==opts.skipOptionalPartCharacter){isValid(i,buffer[i],true,true)}}};function casing(elem,test,pos){switch(test.casing){case'upper':elem=elem.toUpperCase();break;case'lower':elem=elem.toLowerCase();break;case'title':var posBefore=getMaskSet().validPositions[pos-1];if(pos===0||posBefore&&posBefore.input===String.fromCharCode(Inputmask.keyCode.SPACE)){elem=elem.toUpperCase()}else{elem=elem.toLowerCase()};break};return elem};function checkAlternationMatch(altArr1,altArr2){var altArrC=opts.greedy?altArr2:altArr2.slice(0,1),isMatch=false;for(var alndx=0;alndx<altArr1.length;alndx++){if($.inArray(altArr1[alndx],altArrC)!==-1){isMatch=true;break}};return isMatch};function isValid(pos,c,strict,fromSetValid){function isSelection(posObj){return isRTL?(posObj.begin-posObj.end)>1||((posObj.begin-posObj.end)===1&&opts.insertMode):(posObj.end-posObj.begin)>1||((posObj.end-posObj.begin)===1&&opts.insertMode)};strict=strict===true;var maskPos=pos;if(pos.begin!==undefined){maskPos=isRTL&&!isSelection(pos)?pos.end:pos.begin};function _isValid(position,c,strict,fromSetValid){var rslt=false;$.each(getTests(position),function(ndx,tst){var test=tst.match,loopend=c?1:0,chrs='';for(var i=test.cardinality;i>loopend;i--){chrs+=getBufferElement(position-(i-1))};if(c){chrs+=c};getBuffer(true);rslt=test.fn!=null?test.fn.test(chrs,getMaskSet(),position,strict,opts,isSelection(pos)):(c===test.def||c===opts.skipOptionalPartCharacter)&&test.def!==''?{c:test.placeholder||test.def,pos:position}:false;if(rslt!==false){var elem=rslt.c!==undefined?rslt.c:c;elem=(elem===opts.skipOptionalPartCharacter&&test.fn===null)?(test.placeholder||test.def):elem;var validatedPos=position,possibleModifiedBuffer=getBuffer();if(rslt.remove!==undefined){if(!$.isArray(rslt.remove))rslt.remove=[rslt.remove];$.each(rslt.remove.sort(function(a,b){return b-a}),function(ndx,lmnt){stripValidPositions(lmnt,lmnt+1,true)})};if(rslt.insert!==undefined){if(!$.isArray(rslt.insert))rslt.insert=[rslt.insert];$.each(rslt.insert.sort(function(a,b){return a-b}),function(ndx,lmnt){isValid(lmnt.pos,lmnt.c,false,fromSetValid)})};if(rslt.refreshFromBuffer){var refresh=rslt.refreshFromBuffer;strict=true;refreshFromBuffer(refresh===true?refresh:refresh.start,refresh.end,possibleModifiedBuffer);if(rslt.pos===undefined&&rslt.c===undefined){rslt.pos=getLastValidPosition();return false};validatedPos=rslt.pos!==undefined?rslt.pos:position;if(validatedPos!==position){rslt=$.extend(rslt,isValid(validatedPos,elem,true,fromSetValid));return false}}else if(rslt!==true&&rslt.pos!==undefined&&rslt.pos!==position){validatedPos=rslt.pos;refreshFromBuffer(position,validatedPos,getBuffer().slice());if(validatedPos!==position){rslt=$.extend(rslt,isValid(validatedPos,elem,true));return false}};if(rslt!==true&&rslt.pos===undefined&&rslt.c===undefined){return false};if(ndx>0){resetMaskSet(true)};if(!setValidPosition(validatedPos,$.extend({},tst,{'input':casing(elem,test,validatedPos)}),fromSetValid,isSelection(pos))){rslt=false};return false}});return rslt};function alternate(pos,c,strict,fromSetValid){var validPsClone=$.extend(true,{},getMaskSet().validPositions),lastAlt,alternation,isValidRslt,altPos,i,validPos;for(var lAlt=getLastValidPosition();lAlt>=0;lAlt--){altPos=getMaskSet().validPositions[lAlt];if(altPos&&altPos.alternation!==undefined){lastAlt=lAlt;alternation=getMaskSet().validPositions[lastAlt].alternation;if(getTestTemplate(lastAlt).locator[altPos.alternation]!==altPos.locator[altPos.alternation]){break}}};if(alternation!==undefined){lastAlt=parseInt(lastAlt);for(var decisionPos in getMaskSet().validPositions){decisionPos=parseInt(decisionPos);altPos=getMaskSet().validPositions[decisionPos];if(decisionPos>=lastAlt&&altPos.alternation!==undefined){var altNdxs;if(lastAlt===0){altNdxs=[];$.each(getMaskSet().tests[lastAlt],function(ndx,test){if(test.locator[alternation]!==undefined){altNdxs=altNdxs.concat(test.locator[alternation].toString().split(','))}})}else{altNdxs=getMaskSet().validPositions[lastAlt].locator[alternation].toString().split(',')};var decisionTaker=altPos.locator[alternation]!==undefined?altPos.locator[alternation]:altNdxs[0];if(decisionTaker.length>0){decisionTaker=decisionTaker.split(',')[0]};for(var mndx=0;mndx<altNdxs.length;mndx++){var validInputs=[],staticInputsBeforePos=0,staticInputsBeforePosAlternate=0;if(decisionTaker<altNdxs[mndx]){var possibilityPos,possibilities;for(var dp=decisionPos;dp>=0;dp--){possibilityPos=getMaskSet().validPositions[dp];if(possibilityPos!==undefined){var bestMatch=selectBestMatch(dp,altNdxs[mndx]);if(getMaskSet().validPositions[dp].match.def!==bestMatch.match.def){if(getMaskSet().validPositions[dp].generatedInput!==true){validInputs.push(getMaskSet().validPositions[dp].input)};getMaskSet().validPositions[dp]=bestMatch;getMaskSet().validPositions[dp].input=getPlaceholder(dp);if(getMaskSet().validPositions[dp].match.fn===null){staticInputsBeforePosAlternate++};possibilityPos=bestMatch};possibilities=possibilityPos.locator[alternation];possibilityPos.locator[alternation]=parseInt(altNdxs[mndx]);break}};if(decisionTaker!==possibilityPos.locator[alternation]){for(i=decisionPos+1;i<getLastValidPosition(undefined,true)+1;i++){validPos=getMaskSet().validPositions[i];if(validPos&&validPos.match.fn!=null){validInputs.push(validPos.input)}else if(i<pos)staticInputsBeforePos++;delete getMaskSet().validPositions[i]};resetMaskSet(true);opts.keepStatic=!opts.keepStatic;isValidRslt=true;while(validInputs.length>0){var input=validInputs.shift();if(input!==opts.skipOptionalPartCharacter){if(!(isValidRslt=isValid(getLastValidPosition(undefined,true)+1,input,false,fromSetValid))){break}}};possibilityPos.alternation=alternation;possibilityPos.locator[alternation]=possibilities;if(isValidRslt){var targetLvp=getLastValidPosition(pos)+1;for(i=decisionPos+1;i<getLastValidPosition()+1;i++){validPos=getMaskSet().validPositions[i];if((validPos===undefined||validPos.match.fn==null)&&i<pos){staticInputsBeforePosAlternate++}};pos=pos+(staticInputsBeforePosAlternate-staticInputsBeforePos);isValidRslt=isValid(pos>targetLvp?targetLvp:pos,c,strict,fromSetValid)};opts.keepStatic=!opts.keepStatic;if(!isValidRslt){resetMaskSet();getMaskSet().validPositions=$.extend(true,{},validPsClone)}else return isValidRslt}}};break}}};return false};function trackbackAlternations(originalPos,newPos){var vp=getMaskSet().validPositions[newPos],targetLocator=vp.locator,tll=targetLocator.length;for(var ps=originalPos;ps<newPos;ps++){if(getMaskSet().validPositions[ps]===undefined&&!isMask(ps,true)){var tests=getTests(ps),bestMatch=tests[0],equality=-1;$.each(tests,function(ndx,tst){for(var i=0;i<tll;i++){if(tst.locator[i]!==undefined&&checkAlternationMatch(tst.locator[i].toString().split(','),targetLocator[i].toString().split(','))){if(equality<i){equality=i;bestMatch=tst}}else break}});setValidPosition(ps,$.extend({},bestMatch,{'input':bestMatch.match.placeholder||bestMatch.match.def}),true)}}};var result=false,positionsClone=$.extend(true,{},getMaskSet().validPositions);for(var pndx=maskPos-1;pndx>-1;pndx--){if(getMaskSet().validPositions[pndx])break};var testTemplate,generatedPos;for(pndx++;pndx<maskPos;pndx++){if(getMaskSet().validPositions[pndx]===undefined&&(opts.jitMasking===false||opts.jitMasking>pndx)&&((testTemplate=getTestTemplate(pndx,getTestTemplate(pndx-1).locator,pndx-1)).match.def===opts.radixPointDefinitionSymbol||!isMask(pndx,true)||($.inArray(opts.radixPoint,getBuffer())<pndx&&testTemplate.match.fn&&testTemplate.match.fn.test(getPlaceholder(pndx),getMaskSet(),pndx,false,opts)))){result=_isValid(pndx,testTemplate.match.placeholder||(testTemplate.match.fn==null?testTemplate.match.def:(getPlaceholder(pndx)!==''?getPlaceholder(pndx):getBuffer()[pndx])),true,fromSetValid);if(result!==false){getMaskSet().validPositions[result.pos||pndx].generatedInput=true}}};if(isSelection(pos)){handleRemove(undefined,Inputmask.keyCode.DELETE,pos);maskPos=getMaskSet().p};if(maskPos<getMaskSet().maskLength){result=_isValid(maskPos,c,strict,fromSetValid);if((!strict||fromSetValid===true)&&result===false){var currentPosValid=getMaskSet().validPositions[maskPos];if(currentPosValid&&currentPosValid.match.fn===null&&(currentPosValid.match.def===c||c===opts.skipOptionalPartCharacter)){result={'caret':seekNext(maskPos)}}else if((opts.insertMode||getMaskSet().validPositions[seekNext(maskPos)]===undefined)&&!isMask(maskPos,true)){var testsFromPos=getTests(maskPos).slice();if(testsFromPos[testsFromPos.length-1].match.def==='')testsFromPos.pop();var staticChar=determineTestTemplate(testsFromPos,true);if(staticChar){staticChar=staticChar.match.placeholder||staticChar.match.def;_isValid(maskPos,staticChar,strict,fromSetValid)};for(var nPos=maskPos+1,snPos=seekNext(maskPos);nPos<=snPos;nPos++){result=_isValid(nPos,c,strict,fromSetValid);if(result!==false){trackbackAlternations(maskPos,nPos);maskPos=nPos;break}}}}};if(result===false&&opts.keepStatic){result=alternate(maskPos,c,strict,fromSetValid)};if(result===true){result={'pos':maskPos}};if($.isFunction(opts.postValidation)&&result!==false&&!strict&&fromSetValid!==true){result=opts.postValidation(getBuffer(true),result,opts)?result:false};if(result.pos===undefined){result.pos=maskPos};if(result===false){resetMaskSet(true);getMaskSet().validPositions=$.extend(true,{},positionsClone)};return result};function isMask(pos,strict){var test;if(strict){test=getTestTemplate(pos).match;if(test.def==='')test=getTest(pos).match}else test=getTest(pos).match;if(test.fn!=null){return test.fn}else if(strict!==true&&pos>-1&&!opts.keepStatic&&getMaskSet().validPositions[pos]===undefined){var tests=getTests(pos);return tests.length>2};return false};function seekNext(pos,newBlock){var maskL=getMaskSet().maskLength;if(pos>=maskL)return maskL;var position=pos;while(++position<maskL&&((newBlock===true&&(getTest(position).match.newBlockMarker!==true||!isMask(position)))||(newBlock!==true&&!isMask(position)))){};return position};function seekPrevious(pos,newBlock){var position=pos;if(position<=0)return 0;while(--position>0&&((newBlock===true&&getTest(position).match.newBlockMarker!==true)||(newBlock!==true&&!isMask(position)&&getTests(position).length<2))){};return position};function getBufferElement(position){return getMaskSet().validPositions[position]===undefined?getPlaceholder(position):getMaskSet().validPositions[position].input};function writeBuffer(input,buffer,caretPos,event,triggerInputEvent){if(event&&$.isFunction(opts.onBeforeWrite)){var result=opts.onBeforeWrite(event,buffer,caretPos,opts);if(result){if(result.refreshFromBuffer){var refresh=result.refreshFromBuffer;refreshFromBuffer(refresh===true?refresh:refresh.start,refresh.end,result.buffer||buffer);buffer=getBuffer(true)};if(caretPos!==undefined)caretPos=result.caret!==undefined?result.caret:caretPos}};input.inputmask._valueSet(buffer.join(''));if(caretPos!==undefined&&(event===undefined||event.type!=='blur')){caret(input,caretPos)};if(triggerInputEvent===true){skipInputEvent=true;$(input).trigger('input')}};function getPlaceholder(pos,test){test=test||getTest(pos).match;if(test.placeholder!==undefined){return test.placeholder}else if(test.fn===null){if(pos>-1&&!opts.keepStatic&&getMaskSet().validPositions[pos]===undefined){var tests=getTests(pos),staticAlternations=[],prevTest;if(tests.length>2){for(var i=0;i<tests.length;i++){if(tests[i].match.optionality!==true&&tests[i].match.optionalQuantifier!==true&&(tests[i].match.fn===null||(prevTest===undefined||tests[i].match.fn.test(prevTest.match.def,getMaskSet(),pos,true,opts)!==false))){staticAlternations.push(tests[i]);if(tests[i].match.fn===null)prevTest=tests[i];if(staticAlternations.length>1){if(new RegExp('[0-9a-bA-Z]').test(staticAlternations[0].match.def)){return opts.placeholder.charAt(pos%opts.placeholder.length)}}}}}};return test.def};return opts.placeholder.charAt(pos%opts.placeholder.length)};function checkVal(input,writeOut,strict,nptvl){var inputValue=nptvl.slice(),charCodes='',initialNdx=0,result;function isTemplateMatch(){var isMatch=false,charCodeNdx=getBufferTemplate().slice(initialNdx,seekNext(initialNdx)).join('').indexOf(charCodes);if(charCodeNdx!==-1&&!isMask(initialNdx)){isMatch=true;var bufferTemplateArr=getBufferTemplate().slice(initialNdx,initialNdx+charCodeNdx);for(var i=0;i<bufferTemplateArr.length;i++){if(bufferTemplateArr[i]!==' '){isMatch=false;break}}};return isMatch};resetMaskSet();getMaskSet().p=seekNext(-1);if(!strict){if(opts.autoUnmask!==true){var staticInput=getBufferTemplate().slice(0,seekNext(-1)).join(''),matches=inputValue.join('').match(new RegExp('^'+Inputmask.escapeRegex(staticInput),'g'));if(matches&&matches.length>0){inputValue.splice(0,matches.length*staticInput.length);initialNdx=seekNext(initialNdx)}}else{initialNdx=seekNext(initialNdx)}};$.each(inputValue,function(ndx,charCode){if(charCode!==undefined){var keypress=new $.Event('keypress');keypress.which=charCode.charCodeAt(0);charCodes+=charCode;var lvp=getLastValidPosition(undefined,true),lvTest=getMaskSet().validPositions[lvp],nextTest=getTestTemplate(lvp+1,lvTest?lvTest.locator.slice():undefined,lvp);if(!isTemplateMatch()||strict||opts.autoUnmask){var pos=strict?ndx:(nextTest.match.fn==null&&nextTest.match.optionality&&(lvp+1)<getMaskSet().p?lvp+1:getMaskSet().p);result=keypressEvent.call(input,keypress,true,false,strict,pos);initialNdx=pos+1;charCodes=''}else{result=keypressEvent.call(input,keypress,true,false,true,lvp+1)};if(!strict&&$.isFunction(opts.onBeforeWrite)){result=opts.onBeforeWrite(keypress,getBuffer(),result.forwardPosition,opts);if(result&&result.refreshFromBuffer){var refresh=result.refreshFromBuffer;refreshFromBuffer(refresh===true?refresh:refresh.start,refresh.end,result.buffer);resetMaskSet(true);if(result.caret){getMaskSet().p=result.caret}}}}});if(writeOut){writeBuffer(input,getBuffer(),document.activeElement===input?seekNext(getLastValidPosition(0)):undefined,new $.Event('checkval'))}};function unmaskedvalue(input){if(input&&input.inputmask===undefined){return input.value};var umValue=[],vps=getMaskSet().validPositions;for(var pndx in vps){if(vps[pndx].match&&vps[pndx].match.fn!=null){umValue.push(vps[pndx].input)}};var unmaskedValue=umValue.length===0?'':(isRTL?umValue.reverse():umValue).join('');if($.isFunction(opts.onUnMask)){var bufferValue=(isRTL?getBuffer().slice().reverse():getBuffer()).join('');unmaskedValue=(opts.onUnMask(bufferValue,unmaskedValue,opts)||unmaskedValue)};return unmaskedValue};function caret(input,begin,end,notranslate){function translatePosition(pos){if(notranslate!==true&&isRTL&&typeof pos==='number'&&(!opts.greedy||opts.placeholder!=='')){var bffrLght=getBuffer().join('').length;pos=bffrLght-pos};return pos};var range;if(typeof begin==='number'){begin=translatePosition(begin);end=translatePosition(end);end=(typeof end=='number')?end:begin;var scrollCalc=parseInt(((input.ownerDocument.defaultView||window).getComputedStyle?(input.ownerDocument.defaultView||window).getComputedStyle(input,null):input.currentStyle).fontSize)*end;input.scrollLeft=scrollCalc>input.scrollWidth?scrollCalc:0;if(!mobile&&opts.insertMode===false&&begin===end)end++;if(input.setSelectionRange){input.selectionStart=begin;input.selectionEnd=end}else if(window.getSelection){range=document.createRange();if(input.firstChild===undefined||input.firstChild===null){var textNode=document.createTextNode('');input.appendChild(textNode)};range.setStart(input.firstChild,begin<input.inputmask._valueGet().length?begin:input.inputmask._valueGet().length);range.setEnd(input.firstChild,end<input.inputmask._valueGet().length?end:input.inputmask._valueGet().length);range.collapse(true);var sel=window.getSelection();sel.removeAllRanges();sel.addRange(range)}else if(input.createTextRange){range=input.createTextRange();range.collapse(true);range.moveEnd('character',end);range.moveStart('character',begin);range.select()}}else{if(input.setSelectionRange){begin=input.selectionStart;end=input.selectionEnd}else if(window.getSelection){range=window.getSelection().getRangeAt(0);if(range.commonAncestorContainer.parentNode===input||range.commonAncestorContainer===input){begin=range.startOffset;end=range.endOffset}}else if(document.selection&&document.selection.createRange){range=document.selection.createRange();begin=0-range.duplicate().moveStart('character',-input.inputmask._valueGet().length);end=begin+range.text.length};return{'begin':translatePosition(begin),'end':translatePosition(end)}}};function determineLastRequiredPosition(returnDefinition){var buffer=getBuffer(),bl=buffer.length,pos,lvp=getLastValidPosition(),positions={},lvTest=getMaskSet().validPositions[lvp],ndxIntlzr=lvTest!==undefined?lvTest.locator.slice():undefined,testPos;for(pos=lvp+1;pos<buffer.length;pos++){testPos=getTestTemplate(pos,ndxIntlzr,pos-1);ndxIntlzr=testPos.locator.slice();positions[pos]=$.extend(true,{},testPos)};var lvTestAlt=lvTest&&lvTest.alternation!==undefined?lvTest.locator[lvTest.alternation]:undefined;for(pos=bl-1;pos>lvp;pos--){testPos=positions[pos];if((testPos.match.optionality||testPos.match.optionalQuantifier||(lvTestAlt&&((lvTestAlt!==positions[pos].locator[lvTest.alternation]&&testPos.match.fn!=null)||(testPos.match.fn===null&&testPos.locator[lvTest.alternation]&&checkAlternationMatch(testPos.locator[lvTest.alternation].toString().split(','),lvTestAlt.toString().split(','))&&getTests(pos)[0].def!==''))))&&buffer[pos]===getPlaceholder(pos,testPos.match)){bl--}else break};return returnDefinition?{'l':bl,'def':positions[bl]?positions[bl].match:undefined}:bl};function clearOptionalTail(buffer){var rl=determineLastRequiredPosition(),lmib=buffer.length-1;for(;lmib>rl;lmib--){if(isMask(lmib))break};buffer.splice(rl,lmib+1-rl);return buffer};function isComplete(buffer){if($.isFunction(opts.isComplete))return opts.isComplete(buffer,opts);if(opts.repeat==='*')return undefined;var complete=false,lrp=determineLastRequiredPosition(true),aml=seekPrevious(lrp.l);if(lrp.def===undefined||lrp.def.newBlockMarker||lrp.def.optionality||lrp.def.optionalQuantifier){complete=true;for(var i=0;i<=aml;i++){var test=getTestTemplate(i).match;if((test.fn!==null&&getMaskSet().validPositions[i]===undefined&&test.optionality!==true&&test.optionalQuantifier!==true)||(test.fn===null&&buffer[i]!==getPlaceholder(i,test))){complete=false;break}}};return complete};var EventRuler={on:function(input,eventName,eventHandler){var ev=function(e){if(this.inputmask===undefined&&this.nodeName!=='FORM'){var imOpts=$.data(this,'_inputmask_opts');if(imOpts)(new Inputmask(imOpts)).mask(this);else EventRuler.off(this)}else if(e.type!=='setvalue'&&(this.disabled||(this.readOnly&&!(e.type==='keydown'&&(e.ctrlKey&&e.keyCode===67)||(opts.tabThrough===false&&e.keyCode===Inputmask.keyCode.TAB))))){e.preventDefault()}else{switch(e.type){case'input':if(skipInputEvent===true){skipInputEvent=false;return e.preventDefault()};break;case'keydown':skipKeyPressEvent=false;skipInputEvent=false;break;case'keypress':if(skipKeyPressEvent===true){return e.preventDefault()};skipKeyPressEvent=true;break;case'click':if(iemobile){var that=this;setTimeout(function(){eventHandler.apply(that,arguments)},0);return false};break};var returnVal=eventHandler.apply(this,arguments);if(returnVal===false){e.preventDefault();e.stopPropagation()};return returnVal}};input.inputmask.events[eventName]=input.inputmask.events[eventName]||[];input.inputmask.events[eventName].push(ev);if($.inArray(eventName,['submit','reset'])!==-1){if(input.form!=null)$(input.form).on(eventName,ev)}else{$(input).on(eventName,ev)}},off:function(input,event){if(input.inputmask&&input.inputmask.events){var events;if(event){events=[];events[event]=input.inputmask.events[event]}else{events=input.inputmask.events};$.each(events,function(eventName,evArr){while(evArr.length>0){var ev=evArr.pop();if($.inArray(eventName,['submit','reset'])!==-1){if(input.form!=null)$(input.form).off(eventName,ev)}else{$(input).off(eventName,ev)}};delete input.inputmask.events[eventName]})}}};function patchValueProperty(npt){var valueGet,valueSet;function patchValhook(type){if($.valHooks&&($.valHooks[type]===undefined||$.valHooks[type].inputmaskpatch!==true)){var valhookGet=$.valHooks[type]&&$.valHooks[type].get?$.valHooks[type].get:function(elem){return elem.value},valhookSet=$.valHooks[type]&&$.valHooks[type].set?$.valHooks[type].set:function(elem,value){elem.value=value;return elem};$.valHooks[type]={get:function(elem){if(elem.inputmask){if(elem.inputmask.opts.autoUnmask){return elem.inputmask.unmaskedvalue()}else{var result=valhookGet(elem);return getLastValidPosition(undefined,undefined,elem.inputmask.maskset.validPositions)!==-1||opts.nullable!==true?result:''}}else return valhookGet(elem)},set:function(elem,value){var $elem=$(elem),result;result=valhookSet(elem,value);if(elem.inputmask){$elem.trigger('setvalue')};return result},inputmaskpatch:true}}};function getter(){if(this.inputmask){return this.inputmask.opts.autoUnmask?this.inputmask.unmaskedvalue():(getLastValidPosition()!==-1||opts.nullable!==true?(document.activeElement===this&&opts.clearMaskOnLostFocus?(isRTL?clearOptionalTail(getBuffer().slice()).reverse():clearOptionalTail(getBuffer().slice())).join(''):valueGet.call(this)):'')}else return valueGet.call(this)};function setter(value){valueSet.call(this,value);if(this.inputmask){$(this).trigger('setvalue')}};function installNativeValueSetFallback(npt){EventRuler.on(npt,'mouseenter',function(event){var $input=$(this),input=this,value=input.inputmask._valueGet();if(value!==getBuffer().join('')){$input.trigger('setvalue')}})};if(!npt.inputmask.__valueGet){if(Object.getOwnPropertyDescriptor){if(typeof Object.getPrototypeOf!=='function'){Object.getPrototypeOf=typeof'test'.__proto__==='object'?function(object){return object.__proto__}:function(object){return object.constructor.prototype}};var valueProperty=Object.getPrototypeOf?Object.getOwnPropertyDescriptor(Object.getPrototypeOf(npt),'value'):undefined;if(valueProperty&&valueProperty.get&&valueProperty.set){valueGet=valueProperty.get;valueSet=valueProperty.set;Object.defineProperty(npt,'value',{get:getter,set:setter,configurable:true})}else if(npt.tagName!=='INPUT'){valueGet=function(){return this.textContent};valueSet=function(value){this.textContent=value};Object.defineProperty(npt,'value',{get:getter,set:setter,configurable:true})}}else if(document.__lookupGetter__&&npt.__lookupGetter__('value')){valueGet=npt.__lookupGetter__('value');valueSet=npt.__lookupSetter__('value');npt.__defineGetter__('value',getter);npt.__defineSetter__('value',setter)};npt.inputmask.__valueGet=valueGet;npt.inputmask._valueGet=function(overruleRTL){return isRTL&&overruleRTL!==true?valueGet.call(this.el).split('').reverse().join(''):valueGet.call(this.el)};npt.inputmask.__valueSet=valueSet;npt.inputmask._valueSet=function(value,overruleRTL){valueSet.call(this.el,(value===null||value===undefined)?'':((overruleRTL!==true&&isRTL)?value.split('').reverse().join(''):value))};if(valueGet===undefined){valueGet=function(){return this.value};valueSet=function(value){this.value=value};patchValhook(npt.type);installNativeValueSetFallback(npt)}}};function handleRemove(input,k,pos,strict){function generalize(){if(opts.keepStatic){resetMaskSet(true);var validInputs=[],lastAlt,positionsClone=$.extend(true,{},getMaskSet().validPositions);for(lastAlt=getLastValidPosition();lastAlt>=0;lastAlt--){var validPos=getMaskSet().validPositions[lastAlt];if(validPos){if(validPos.match.fn!=null){validInputs.push(validPos.input)};delete getMaskSet().validPositions[lastAlt];if(validPos.alternation!==undefined&&validPos.locator[validPos.alternation]===getTestTemplate(lastAlt).locator[validPos.alternation]){break}}};if(lastAlt>-1){while(validInputs.length>0){getMaskSet().p=seekNext(getLastValidPosition());var keypress=new $.Event('keypress');keypress.which=validInputs.pop().charCodeAt(0);keypressEvent.call(input,keypress,true,false,false,getMaskSet().p)}}else getMaskSet().validPositions=$.extend(true,{},positionsClone)}};if(opts.numericInput||isRTL){if(k===Inputmask.keyCode.BACKSPACE){k=Inputmask.keyCode.DELETE}else if(k===Inputmask.keyCode.DELETE){k=Inputmask.keyCode.BACKSPACE};if(isRTL){var pend=pos.end;pos.end=pos.begin;pos.begin=pend}};if(k===Inputmask.keyCode.BACKSPACE&&(pos.end-pos.begin<1||opts.insertMode===false)){pos.begin=seekPrevious(pos.begin);if(getMaskSet().validPositions[pos.begin]!==undefined&&(getMaskSet().validPositions[pos.begin].input===opts.groupSeparator||getMaskSet().validPositions[pos.begin].input===opts.radixPoint)){pos.begin--}}else if(k===Inputmask.keyCode.DELETE&&pos.begin===pos.end){pos.end=isMask(pos.end)?pos.end+1:seekNext(pos.end)+1;if(getMaskSet().validPositions[pos.begin]!==undefined&&(getMaskSet().validPositions[pos.begin].input===opts.groupSeparator||getMaskSet().validPositions[pos.begin].input===opts.radixPoint)){pos.end++}};stripValidPositions(pos.begin,pos.end,false,strict);if(strict!==true){generalize()};var lvp=getLastValidPosition(pos.begin);if(lvp<pos.begin){getMaskSet().p=seekNext(lvp)}else if(strict!==true){getMaskSet().p=pos.begin}};function keydownEvent(e){var input=this,$input=$(input),k=e.keyCode,pos=caret(input);if(k===Inputmask.keyCode.BACKSPACE||k===Inputmask.keyCode.DELETE||(iphone&&k===Inputmask.keyCode.BACKSPACE_SAFARI)||(e.ctrlKey&&k===Inputmask.keyCode.X&&!isInputEventSupported('cut'))){e.preventDefault();handleRemove(input,k,pos);writeBuffer(input,getBuffer(),getMaskSet().p,e,undoValue!==getBuffer().join(''));if(input.inputmask._valueGet()===getBufferTemplate().join('')){$input.trigger('cleared')}else if(isComplete(getBuffer())===true){$input.trigger('complete')};if(opts.showTooltip){input.title=opts.tooltip||getMaskSet().mask}}else if(k===Inputmask.keyCode.END||k===Inputmask.keyCode.PAGE_DOWN){e.preventDefault();var caretPos=seekNext(getLastValidPosition());if(!opts.insertMode&&caretPos===getMaskSet().maskLength&&!e.shiftKey)caretPos--;caret(input,e.shiftKey?pos.begin:caretPos,caretPos,true)}else if((k===Inputmask.keyCode.HOME&&!e.shiftKey)||k===Inputmask.keyCode.PAGE_UP){e.preventDefault();caret(input,0,e.shiftKey?pos.begin:0,true)}else if(((opts.undoOnEscape&&k===Inputmask.keyCode.ESCAPE)||(k===90&&e.ctrlKey))&&e.altKey!==true){checkVal(input,true,false,undoValue.split(''));$input.trigger('click')}else if(k===Inputmask.keyCode.INSERT&&!(e.shiftKey||e.ctrlKey)){opts.insertMode=!opts.insertMode;caret(input,!opts.insertMode&&pos.begin===getMaskSet().maskLength?pos.begin-1:pos.begin)}else if(opts.tabThrough===true&&k===Inputmask.keyCode.TAB){if(e.shiftKey===true){if(getTest(pos.begin).match.fn===null){pos.begin=seekNext(pos.begin)};pos.end=seekPrevious(pos.begin,true);pos.begin=seekPrevious(pos.end,true)}else{pos.begin=seekNext(pos.begin,true);pos.end=seekNext(pos.begin,true);if(pos.end<getMaskSet().maskLength)pos.end--};if(pos.begin<getMaskSet().maskLength){e.preventDefault();caret(input,pos.begin,pos.end)}}else if(opts.insertMode===false&&!e.shiftKey){if(k===Inputmask.keyCode.RIGHT){setTimeout(function(){var caretPos=caret(input);caret(input,caretPos.begin)},0)}else if(k===Inputmask.keyCode.LEFT){setTimeout(function(){var caretPos=caret(input);caret(input,isRTL?caretPos.begin+1:caretPos.begin-1)},0)}};opts.onKeyDown.call(this,e,getBuffer(),caret(input).begin,opts);ignorable=$.inArray(k,opts.ignorables)!==-1};function keypressEvent(e,checkval,writeOut,strict,ndx){var input=this,$input=$(input),k=e.which||e.charCode||e.keyCode;if(checkval!==true&&(!(e.ctrlKey&&e.altKey)&&(e.ctrlKey||e.metaKey||ignorable))){if(k===Inputmask.keyCode.ENTER&&undoValue!==getBuffer().join('')){undoValue=getBuffer().join('');setTimeout(function(){$input.trigger('change')},0)};return true}else{if(k){if(k===46&&e.shiftKey===false&&opts.radixPoint===',')k=44;var pos=checkval?{begin:ndx,end:ndx}:caret(input),forwardPosition,c=String.fromCharCode(k);getMaskSet().writeOutBuffer=true;var valResult=isValid(pos,c,strict);if(valResult!==false){var p=valResult.pos;resetMaskSet(true);if(valResult.caret!==undefined){forwardPosition=valResult.caret}else{var vps=getMaskSet().validPositions;if(!opts.keepStatic&&(vps[p+1]!==undefined&&getTests(p+1,vps[p].locator.slice(),p).length>1||vps[p].alternation!==undefined)){forwardPosition=p+1}else forwardPosition=seekNext(p)};getMaskSet().p=forwardPosition};if(writeOut!==false){var self=this;setTimeout(function(){opts.onKeyValidation.call(self,k,valResult,opts)},0);if(getMaskSet().writeOutBuffer&&valResult!==false){var buffer=getBuffer();writeBuffer(input,buffer,(opts.numericInput&&valResult.caret===undefined)?seekPrevious(forwardPosition):forwardPosition,e,checkval!==true);if(checkval!==true){setTimeout(function(){if(isComplete(buffer)===true)$input.trigger('complete')},0)}}};if(opts.showTooltip){input.title=opts.tooltip||getMaskSet().mask};e.preventDefault();if(checkval){valResult.forwardPosition=forwardPosition;return valResult}}}};function pasteEvent(e){var input=this,ev=e.originalEvent||e,$input=$(input),inputValue=input.inputmask._valueGet(true),caretPos=caret(input),tempValue;if(isRTL){tempValue=caretPos.end;caretPos.end=caretPos.begin;caretPos.begin=tempValue};var valueBeforeCaret=inputValue.substr(0,caretPos.begin),valueAfterCaret=inputValue.substr(caretPos.end,inputValue.length);if(valueBeforeCaret===(isRTL?getBufferTemplate().reverse():getBufferTemplate()).slice(0,caretPos.begin).join(''))valueBeforeCaret='';if(valueAfterCaret===(isRTL?getBufferTemplate().reverse():getBufferTemplate()).slice(caretPos.end).join(''))valueAfterCaret='';if(isRTL){tempValue=valueBeforeCaret;valueBeforeCaret=valueAfterCaret;valueAfterCaret=tempValue};if(window.clipboardData&&window.clipboardData.getData){inputValue=valueBeforeCaret+window.clipboardData.getData('Text')+valueAfterCaret}else if(ev.clipboardData&&ev.clipboardData.getData){inputValue=valueBeforeCaret+ev.clipboardData.getData('text/plain')+valueAfterCaret};var pasteValue=inputValue;if($.isFunction(opts.onBeforePaste)){pasteValue=opts.onBeforePaste(inputValue,opts);if(pasteValue===false){return e.preventDefault()};if(!pasteValue){pasteValue=inputValue}};checkVal(input,false,false,isRTL?pasteValue.split('').reverse():pasteValue.toString().split(''));writeBuffer(input,getBuffer(),seekNext(getLastValidPosition()),e,true);if(isComplete(getBuffer())===true){$input.trigger('complete')};return e.preventDefault()};function inputFallBackEvent(e){var input=this,inputValue=input.inputmask._valueGet();if(getBuffer().join('')!==inputValue){var caretPos=caret(input);inputValue=inputValue.replace(new RegExp('('+Inputmask.escapeRegex(getBufferTemplate().join(''))+')*'),'');if(iemobile){var inputChar=inputValue.replace(getBuffer().join(''),'');if(inputChar.length===1){var keypress=new $.Event('keypress');keypress.which=inputChar.charCodeAt(0);keypressEvent.call(input,keypress,true,true,false,getMaskSet().validPositions[caretPos.begin-1]?caretPos.begin:caretPos.begin-1);return false}};if(caretPos.begin>inputValue.length){caret(input,inputValue.length);caretPos=caret(input)};if((getBuffer().length-inputValue.length)===1&&inputValue.charAt(caretPos.begin)!==getBuffer()[caretPos.begin]&&inputValue.charAt(caretPos.begin+1)!==getBuffer()[caretPos.begin]&&!isMask(caretPos.begin)){e.keyCode=Inputmask.keyCode.BACKSPACE;keydownEvent.call(input,e)}else{var lvp=getLastValidPosition()+1,bufferTemplate=getBuffer().slice(lvp).join('');while(inputValue.match(Inputmask.escapeRegex(bufferTemplate)+'$')===null){bufferTemplate=bufferTemplate.slice(1)};inputValue=inputValue.replace(bufferTemplate,'');inputValue=inputValue.split('');checkVal(input,true,false,inputValue);if(isComplete(getBuffer())===true){$(input).trigger('complete')}};e.preventDefault()}};function setValueEvent(e){var input=this,value=input.inputmask._valueGet();checkVal(input,true,false,($.isFunction(opts.onBeforeMask)?(opts.onBeforeMask(value,opts)||value):value).split(''));undoValue=getBuffer().join('');if((opts.clearMaskOnLostFocus||opts.clearIncomplete)&&input.inputmask._valueGet()===getBufferTemplate().join('')){input.inputmask._valueSet('')}};function focusEvent(e){var input=this,nptValue=input.inputmask._valueGet();if(opts.showMaskOnFocus&&(!opts.showMaskOnHover||(opts.showMaskOnHover&&nptValue===''))){if(input.inputmask._valueGet()!==getBuffer().join('')){writeBuffer(input,getBuffer(),seekNext(getLastValidPosition()))}}else if(mouseEnter===false){caret(input,seekNext(getLastValidPosition()))};if(opts.positionCaretOnTab===true){setTimeout(function(){caret(input,seekNext(getLastValidPosition()))},0)};undoValue=getBuffer().join('')};function mouseleaveEvent(e){var input=this;mouseEnter=false;if(opts.clearMaskOnLostFocus&&document.activeElement!==input){var buffer=getBuffer().slice(),nptValue=input.inputmask._valueGet();if(nptValue!==input.getAttribute('placeholder')&&nptValue!==''){if(getLastValidPosition()===-1&&nptValue===getBufferTemplate().join('')){buffer=[]}else{clearOptionalTail(buffer)};writeBuffer(input,buffer)}}};function clickEvent(e){function doRadixFocus(clickPos){if(opts.radixPoint!==''){var vps=getMaskSet().validPositions;if(vps[clickPos]===undefined||(vps[clickPos].input===getPlaceholder(clickPos))){if(clickPos<seekNext(-1))return true;var radixPos=$.inArray(opts.radixPoint,getBuffer());if(radixPos!==-1){for(var vp in vps){if(radixPos<vp&&vps[vp].input!==getPlaceholder(vp)){return false}};return true}}};return false};var input=this;setTimeout(function(){if(document.activeElement===input){var selectedCaret=caret(input);if(selectedCaret.begin===selectedCaret.end){switch(opts.positionCaretOnClick){case'none':break;case'radixFocus':if(doRadixFocus(selectedCaret.begin)){caret(input,opts.numericInput?seekNext($.inArray(opts.radixPoint,getBuffer())):$.inArray(opts.radixPoint,getBuffer()));break};default:var clickPosition=selectedCaret.begin,lvclickPosition=getLastValidPosition(clickPosition,true),lastPosition=seekNext(lvclickPosition);if(clickPosition<lastPosition){caret(input,!isMask(clickPosition)&&!isMask(clickPosition-1)?seekNext(clickPosition):clickPosition)}else{var placeholder=getPlaceholder(lastPosition);if((placeholder!==''&&getBuffer()[lastPosition]!==placeholder)||(!isMask(lastPosition,true)&&getTest(lastPosition).match.def===placeholder)){lastPosition=seekNext(lastPosition)};caret(input,lastPosition)};break}}}},0)};function dblclickEvent(e){var input=this;setTimeout(function(){caret(input,0,seekNext(getLastValidPosition()))},0)};function cutEvent(e){var input=this,$input=$(input),pos=caret(input),ev=e.originalEvent||e,clipboardData=window.clipboardData||ev.clipboardData,clipData=isRTL?getBuffer().slice(pos.end,pos.begin):getBuffer().slice(pos.begin,pos.end);clipboardData.setData('text',isRTL?clipData.reverse().join(''):clipData.join(''));if(document.execCommand)document.execCommand('copy');handleRemove(input,Inputmask.keyCode.DELETE,pos);writeBuffer(input,getBuffer(),getMaskSet().p,e,undoValue!==getBuffer().join(''));if(input.inputmask._valueGet()===getBufferTemplate().join('')){$input.trigger('cleared')};if(opts.showTooltip){input.title=opts.tooltip||getMaskSet().mask}};function blurEvent(e){var $input=$(this),input=this;if(input.inputmask){var nptValue=input.inputmask._valueGet(),buffer=getBuffer().slice();if(undoValue!==buffer.join('')){setTimeout(function(){$input.trigger('change');undoValue=buffer.join('')},0)};if(nptValue!==''){if(opts.clearMaskOnLostFocus){if(getLastValidPosition()===-1&&nptValue===getBufferTemplate().join('')){buffer=[]}else{clearOptionalTail(buffer)}};if(isComplete(buffer)===false){setTimeout(function(){$input.trigger('incomplete')},0);if(opts.clearIncomplete){resetMaskSet();if(opts.clearMaskOnLostFocus){buffer=[]}else{buffer=getBufferTemplate().slice()}}};writeBuffer(input,buffer,undefined,e)}}};function mouseenterEvent(e){var input=this;mouseEnter=true;if(document.activeElement!==input&&opts.showMaskOnHover){if(input.inputmask._valueGet()!==getBuffer().join('')){writeBuffer(input,getBuffer())}}};function submitEvent(e){if(undoValue!==getBuffer().join('')){$el.trigger('change')};if(opts.clearMaskOnLostFocus&&getLastValidPosition()===-1&&el.inputmask._valueGet&&el.inputmask._valueGet()===getBufferTemplate().join('')){el.inputmask._valueSet('')};if(opts.removeMaskOnSubmit){el.inputmask._valueSet(el.inputmask.unmaskedvalue(),true);setTimeout(function(){writeBuffer(el,getBuffer())},0)}};function resetEvent(e){setTimeout(function(){$el.trigger('setvalue')},0)};function mask(elem){el=elem;$el=$(el);if(opts.showTooltip){el.title=opts.tooltip||getMaskSet().mask};if(el.dir==='rtl'||opts.rightAlign){el.style.textAlign='right'};if(el.dir==='rtl'||opts.numericInput){el.dir='ltr';el.removeAttribute('dir');el.inputmask.isRTL=true;isRTL=true};EventRuler.off(el);patchValueProperty(el);if(isElementTypeSupported(el,opts)){EventRuler.on(el,'submit',submitEvent);EventRuler.on(el,'reset',resetEvent);EventRuler.on(el,'mouseenter',mouseenterEvent);EventRuler.on(el,'blur',blurEvent);EventRuler.on(el,'focus',focusEvent);EventRuler.on(el,'mouseleave',mouseleaveEvent);EventRuler.on(el,'click',clickEvent);EventRuler.on(el,'dblclick',dblclickEvent);EventRuler.on(el,'paste',pasteEvent);EventRuler.on(el,'dragdrop',pasteEvent);EventRuler.on(el,'drop',pasteEvent);EventRuler.on(el,'cut',cutEvent);EventRuler.on(el,'complete',opts.oncomplete);EventRuler.on(el,'incomplete',opts.onincomplete);EventRuler.on(el,'cleared',opts.oncleared);if(opts.inputEventOnly!==true){EventRuler.on(el,'keydown',keydownEvent);EventRuler.on(el,'keypress',keypressEvent)};EventRuler.on(el,'input',inputFallBackEvent)};EventRuler.on(el,'setvalue',setValueEvent);if(el.inputmask._valueGet()!==''||opts.clearMaskOnLostFocus===false||document.activeElement===el){var initialValue=$.isFunction(opts.onBeforeMask)?(opts.onBeforeMask(el.inputmask._valueGet(),opts)||el.inputmask._valueGet()):el.inputmask._valueGet();checkVal(el,true,false,initialValue.split(''));var buffer=getBuffer().slice();undoValue=buffer.join('');if(isComplete(buffer)===false){if(opts.clearIncomplete){resetMaskSet()}};if(opts.clearMaskOnLostFocus&&document.activeElement!==el){if(getLastValidPosition()===-1){buffer=[]}else{clearOptionalTail(buffer)}};writeBuffer(el,buffer);if(document.activeElement===el){caret(el,seekNext(getLastValidPosition()))}}};var valueBuffer;if(actionObj!==undefined){switch(actionObj.action){case'isComplete':el=actionObj.el;return isComplete(getBuffer());case'unmaskedvalue':el=actionObj.el;if(el!==undefined&&el.inputmask!==undefined){maskset=el.inputmask.maskset;opts=el.inputmask.opts;isRTL=el.inputmask.isRTL}else{valueBuffer=actionObj.value;if(opts.numericInput){isRTL=true};valueBuffer=($.isFunction(opts.onBeforeMask)?(opts.onBeforeMask(valueBuffer,opts)||valueBuffer):valueBuffer).split('');checkVal(undefined,false,false,isRTL?valueBuffer.reverse():valueBuffer);if($.isFunction(opts.onBeforeWrite))opts.onBeforeWrite(undefined,getBuffer(),0,opts)};return unmaskedvalue(el);case'mask':el=actionObj.el;maskset=el.inputmask.maskset;opts=el.inputmask.opts;isRTL=el.inputmask.isRTL;undoValue=getBuffer().join('');mask(el);break;case'format':if(opts.numericInput){isRTL=true};valueBuffer=($.isFunction(opts.onBeforeMask)?(opts.onBeforeMask(actionObj.value,opts)||actionObj.value):actionObj.value).split('');checkVal(undefined,false,false,isRTL?valueBuffer.reverse():valueBuffer);if($.isFunction(opts.onBeforeWrite))opts.onBeforeWrite(undefined,getBuffer(),0,opts);if(actionObj.metadata){return{value:isRTL?getBuffer().slice().reverse().join(''):getBuffer().join(''),metadata:maskScope({'action':'getmetadata'},maskset,opts)}};return isRTL?getBuffer().slice().reverse().join(''):getBuffer().join('');case'isValid':if(opts.numericInput){isRTL=true};if(actionObj.value){valueBuffer=actionObj.value.split('');checkVal(undefined,false,true,isRTL?valueBuffer.reverse():valueBuffer)}else{actionObj.value=getBuffer().join('')};var buffer=getBuffer(),rl=determineLastRequiredPosition(),lmib=buffer.length-1;for(;lmib>rl;lmib--){if(isMask(lmib))break};buffer.splice(rl,lmib+1-rl);return isComplete(buffer)&&actionObj.value===getBuffer().join('');case'getemptymask':return getBufferTemplate().join('');case'remove':el=actionObj.el;$el=$(el);maskset=el.inputmask.maskset;opts=el.inputmask.opts;el.inputmask._valueSet(unmaskedvalue(el));EventRuler.off(el);var valueProperty;if(Object.getOwnPropertyDescriptor&&Object.getPrototypeOf){valueProperty=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(el),'value');if(valueProperty){if(el.inputmask.__valueGet){Object.defineProperty(el,'value',{get:el.inputmask.__valueGet,set:el.inputmask.__valueSet,configurable:true})}}}else if(document.__lookupGetter__&&el.__lookupGetter__('value')){if(el.inputmask.__valueGet){el.__defineGetter__('value',el.inputmask.__valueGet);el.__defineSetter__('value',el.inputmask.__valueSet)}};el.inputmask=undefined;break;case'getmetadata':if($.isArray(maskset.metadata)){var alternation,lvp=getLastValidPosition(undefined,true);for(var firstAlt=lvp;firstAlt>=0;firstAlt--){if(getMaskSet().validPositions[firstAlt]&&getMaskSet().validPositions[firstAlt].alternation!==undefined){alternation=getMaskSet().validPositions[firstAlt].alternation;break}};return alternation!==undefined?maskset.metadata[getMaskSet().validPositions[firstAlt].locator[alternation]]:[]};return maskset.metadata}}};window.Inputmask=Inputmask;return Inputmask}));(function(factory){if(typeof define==='function'&&define.amd){define(['jquery','inputmask'],factory)}else if(typeof exports==='object'){module.exports=factory(require('jquery'),require('./inputmask'))}else{factory(jQuery,window.Inputmask)}}(function($,Inputmask){if($.fn.inputmask===undefined){$.fn.inputmask=function(fn,options){var nptmask,input=this[0];if(options===undefined)options={};if(typeof fn==='string'){switch(fn){case'unmaskedvalue':return input&&input.inputmask?input.inputmask.unmaskedvalue():$(input).val();case'remove':return this.each(function(){if(this.inputmask)this.inputmask.remove()});case'getemptymask':return input&&input.inputmask?input.inputmask.getemptymask():'';case'hasMaskedValue':return input&&input.inputmask?input.inputmask.hasMaskedValue():false;case'isComplete':return input&&input.inputmask?input.inputmask.isComplete():true;case'getmetadata':return input&&input.inputmask?input.inputmask.getmetadata():undefined;case'setvalue':$(input).val(options);if(input&&input.inputmask===undefined){$(input).triggerHandler('setvalue')};break;case'option':if(typeof options==='string'){if(input&&input.inputmask!==undefined){return input.inputmask.option(options)}}else{return this.each(function(){if(this.inputmask!==undefined){return this.inputmask.option(options)}})};break;default:options.alias=fn;nptmask=new Inputmask(options);return this.each(function(){nptmask.mask(this)})}}else if(typeof fn=='object'){nptmask=new Inputmask(fn);if(fn.mask===undefined&&fn.alias===undefined){return this.each(function(){if(this.inputmask!==undefined){return this.inputmask.option(fn)}else nptmask.mask(this)})}else{return this.each(function(){nptmask.mask(this)})}}else if(fn===undefined){return this.each(function(){nptmask=new Inputmask(options);nptmask.mask(this)})}}};return $.fn.inputmask}));var fn={};fn.loadCss=function(url){$('head').append('<link rel="stylesheet" href="'+url+'" type="text/css">')};fn.loadingHtml=function(box){var html='<div class="loading"><i class="fa fa-circle-o-notch fa-spin"></i></div>';box.empty().html(html)};fn.int=function(str,def){var int=parseInt(str);def=def?def:0;return isNaN(int)?def:int};fn.serializeArray=function(box){var data={};$('input, textarea, select',box).each(function(){var el=$(this),name=el.attr('name');if(!name){return};if(el.attr('type')=='checkbox'){if(el.is(':checked')){data[name]=data[name]||[];data[name].push(el.val())};return};data[name]=el.val()});return data};fn.price=function(price){price=new String(price);return price.replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,'$1 ')};fn.scrollTo=function(el,duration,options){options=$.extend({offsetTop:-50,easing:'swing'},options);if(!duration){duration=600};$('html, body').animate({scrollTop:el.offset().top+options.offsetTop,},duration,options.easing)};var Url=function(){this.path='',this.get={},this.hash={},this.init=function(){var url={};var tmp=location.href.split('?');if(tmp[1]){tmp=tmp[1].split('#');url.get=tmp[0];url.hash=tmp[1]};url.hash=location.hash.substr(1);url.path='/'+tmp[0].replace(/^http:\/\/[a-zA-Z1-9\-\.]*\//,'');this.path=url.path;if(url.get){var getParams=url.get.split('&');for(i=0;i<getParams.length;i++){var tmp=getParams[i].split('=');this.get[tmp[0]]=tmp[1]}};if(url.hash){var hashParams=url.hash.split('&');for(i=0;i<hashParams.length;i++){var tmp=hashParams[i].split('=');this.hash[tmp[0]]=tmp[1]}};return this};this.setPath=function(path){this.path=path;return this};this.setParams=function(params,value){if(typeof params==='object'){this.get=$.extend(this.get,params)}else{this.get[params]=value};return this};this.getParams=function(key){if(key){return this.get[key]}else{return this.get}};this.clearParams=function(){this.get={};return this};this.setHash=function(params,value){if(typeof params==='object'){this.hash=$.extend(this.hash,params)}else{this.hash[params]=value};location.hash='#'+this.generateHash();return this};this.getHash=function(key){if(key){return this.hash[key]}else{return this.hash}};this.clearHash=function(){this.hash={};return this};this.generateParams=function(){var getParams='',first=true;for(var param in this.get){if(this.get[param]){getParams+=(first?'':'&')+param+'='+this.get[param];first=false}};return getParams};this.generateHash=function(){var hashParams='',first=true;for(var param in this.hash){if(this.hash[param]){hashParams+=(first?'':'&')+param+'='+this.hash[param];first=false}};return hashParams};this.getUrl=function(){var url=this.path;if(getParams=this.generateParams()){url+='?'+getParams};if(hashParams=this.generateHash()){url+='#'+hashParams};return url};this.redirect=function(){location.href=this.getUrl()}};fn.url=function(){return new Url()};var Tabs=function(){this.el=null;this.options={historyMode:false,afterLoad:false};this.init=function(options){this.options=$.extend(this.options,options);var header=this.el.children('.tabs-header');this.el.find('.tab').each(function(){var tab=$(this);if(!tab.data('tab')){tab.attr('data-tab',(parseInt(tab.index()+1)))}});var tabs=this;header.find('.tab').on('click',function(){var tab=$(this);if(tab.prop('tagName')!='A'||tab.data('load')){tabs.setActive(tab);return false}});var active=header.children('.tab.active');if(!active.length){var tabName=fn.url().getHash(this.el.attr('data-name'));if(tabName){active=header.children('.tab[data-tab="'+tabName+'"]').addClass('active')}};if(!active.length){active=header.children('.tab:eq(0)').addClass('active')};tabs.setActive(active)};this.setActive=function(tab){var header=this.el.children('.tabs-header'),body=this.el.children('.tabs-body'),headerTab=header.find(tab),bodyTab=body.find('.tab[data-tab="'+tab.attr('data-tab')+'"]');if(!bodyTab.length){bodyTab=$('<div class="tab"></div>');bodyTab.attr('data-tab',tab.attr('data-tab'));bodyTab.appendTo(body)};if(headerTab.hasClass('active')&&!bodyTab.is(':empty')){bodyTab.addClass('active');return};headerTab.addClass('active').siblings().removeClass('active');bodyTab.addClass('active').siblings().removeClass('active');var options=this.options;if(headerTab.attr('data-load')){var url=headerTab.attr('data-load');if(this.options.historyMode){var disablePushState=this.options.disablePushState;$.ajax({url:url,dataType:'json',success:function(resp){bodyTab.html(resp.html);if(!disablePushState){History.replaceState({},resp.meta.title,url)};if(options.afterLoad){options.afterLoad()}}})}else{bodyTab.load(url,function(){headerTab.attr('data-load',null)})}};if(this.el.attr('data-name')){fn.url().setHash(this.el.attr('data-name'),headerTab.attr('data-tab'))}};this.setElement=function(el){this.el=el;return this}};$.fn.tabs=function(options){$(this).each(function(){var tabs=new Tabs();tabs.setElement($(this)).init(options)})};$.aptero=fn;jQuery.cookie=function(e,i,o){if('undefined'==typeof i){var n=null;if(document.cookie&&''!=document.cookie)for(var r=document.cookie.split(';'),t=0;t<r.length;t++){var p=jQuery.trim(r[t]);if(p.substring(0,e.length+1)==e+'='){n=decodeURIComponent(p.substring(e.length+1));break}};return n};o=o||{},null===i&&(i='',o.expires=-1);var u='';if(o.expires&&('number'==typeof o.expires||o.expires.toUTCString)){var s;'number'==typeof o.expires?(s=new Date,s.setTime(s.getTime()+24*o.expires*60*60*1e3)):s=o.expires,u='; expires='+s.toUTCString()};var a=o.path?'; path='+o.path:'',c=o.domain?'; domain='+o.domain:'',m=o.secure?'; secure':'';document.cookie=[e,'=',encodeURIComponent(i),u,a,c,m].join('')};var Products=function(){this.products=[];this.cookie='viewed-products';this.init=function(){var jsonProducts=$.cookie(this.cookie);this.products=jsonProducts?$.parseJSON(jsonProducts):[];return this};this.clear=function(){this.products=[]};this.add=function(data){var exists=false;data.date=$.now();for(var i=0;i<this.products.length;i++){if(this.products[i].id==data.id){data.count=this.products[i].count+1;this.products.splice(i,1,data);exists=true}};if(!exists){data.count=1;this.products.push(data)};this.save()};this.getProducts=function(){return this.products};this.save=function(){var productsJson=null;if(this.products.length){productsJson=JSON.stringify(this.products)};this.products.sort(function(a,b){return(a.date<b.date)});this.products=this.products.splice(0,9);$.cookie(this.cookie,productsJson,{expires:365,path:'/'})}},Cart=function(){this.cart=[];this.price=0;this.count=0;this.sum=0;this.cookie='cart';this.init=function(){this.on('update',function(){this.save();this.sync()});var jsonCart=$.cookie(this.cookie);this.cart=jsonCart?$.parseJSON(jsonCart):[];this.trigger('update')};this.clear=function(){this.cart=[];this.trigger('update')};this.compare=function(data1,data2){return data1.product_id==data2.product_id&&data1.taste_id==data2.taste_id&&data1.size_id==data2.size_id};this.getProductInfo=function(data,callback){$.ajax({url:'/catalog/get-product-info/',data:data,success:callback,dataType:'json',method:'post'})};this.add=function(data,options){options=$.extend({count:'increase'},options);var exists=false,newCount=parseInt(data.count),diff=newCount;for(var i=0;i<this.cart.length;i++){if(!this.compare(this.cart[i],data)){continue};if(options.count=='increase'){data.count=newCount+parseInt(this.cart[i].count)}else{diff=newCount-parseInt(this.cart[i].count)};this.cart.splice(i,1,data);exists=true};if(!exists){this.cart.push(data)};if(diff>0){this.getProductInfo(data,function(resp){gtag('event','add_to_cart',{'items':[$.extend(resp,{quantity:diff})]});gtag('event','order_event',{'event_category':'catalog','event_action':'order','event_label':'cart_add','value':10});window.metrikaEc.push({ecommerce:{add:{products:resp}}});getYandexCounter().reachGoal('cart_add')})}else{this.getProductInfo(data,function(resp){gtag('event','remove_from_cart',{'items':[$.extend(resp,{quantity:diff*-1})]});gtag('event','order_event',{'event_category':'catalog','event_action':'order','event_label':'cart_del','value':10});window.metrikaEc.push({ecommerce:{add:{products:resp}}});getYandexCounter().reachGoal('cart_del')})};this.trigger('update')};this.del=function(data){for(var i in this.cart){if(this.compare(this.cart[i],data)){var quantity=this.cart[i].count;this.cart.splice(i,1);this.getProductInfo(data,function(resp){gtag('event','remove_from_cart',{'items':[$.extend(resp,{quantity:quantity})]});gtag('event','order_event',{'event_category':'catalog','event_action':'order','event_label':'cart_del','value':10});window.metrikaEc.push({ecommerce:{add:{products:resp}}});getYandexCounter().reachGoal('cart_del')});break}};this.trigger('update')};this.ecoomerceCart=function(callback){this.getProductInfo({products:this.cart},function(resp){callback(resp)})};this.getCart=function(){return this.cart};this.save=function(){var cartJson=null;if(this.cart.length){cartJson=JSON.stringify(this.cart)};$.cookie(this.cookie,cartJson,{expires:365,path:'/'})};this.sync=function(){var cart=this;$.ajax({url:'/cart/get-info/',success:function(serverCart){cart.cart=[];for(var i in serverCart.cart){var product=serverCart.cart[i];cart.cart.push(product)};cart.price=serverCart.price;cart.count=parseInt(serverCart.count);cart.sum=serverCart.price;cart.delivery=serverCart.delivery;cart.save();cart.trigger('render')},dataType:'json'})};this.on=function(event,fn){$(this).on(event,fn)};this.trigger=function(event){$(this).trigger(event)}};$.cart=new Cart();$.cart.init();var FormValidator=function(){this.form=null;this.options={autoValidate:false,before:false,after:false,fail:false,success:false,};this.setElement=function(form){this.form=form;return this};this.init=function(options){this.options=$.extend(this.options,options);$('input, select, textarea',this.form).on('change, keyup',function(){var parent=$(this).parent();parent.removeClass('invalid');parent.find('.errors').remove()});return this};this.renderErrors=function(errors){if(!errors){return''};var html='<div class="errors">';for(key in errors){html+='<div class="error">'+errors[key]+'</li>'};html+='</div>';return html};this.checkErrors=function(form,options){options=$.extend({requestType:'submit',element:null,async:true},options);var result=false,data=form.serializeArray(),async=options.async;data.push({name:'requestType',value:options.requestType});var formV=this;$.ajax({type:'POST',async:async,url:form.attr('action'),data:data,dataType:'json',success:function(resp){if(!resp['errors']||!Object.keys(resp['errors']).length){form.find('.errors').remove();form.find('.invalid').removeClass('invalid');result=resp?resp:true;return};form.find('c').empty();$('.form-errors',form).empty();if(resp['errors']['all']){console.log(resp['errors']['all']);$('.form-errors',form).append(formV.renderErrors(resp['errors']['all']))};form.find('input[type!="submit"], select, textarea').each(function(){var input=$(this),inputBox=$(this).parent(),errorsBox=inputBox.find('.errors'),errors=resp['errors'][input.attr('name')];if(!errors){errorsBox.remove();inputBox.removeClass('invalid')};if(options.element){if(options.element.attr('name')==input.attr('name')){errorsBox.remove();if(resp['errors'][input.attr('name')]){inputBox.addClass('invalid');inputBox.append(formV.renderErrors(errors))}else{inputBox.removeClass('invalid')}};return};errorsBox.remove();if(errors){inputBox.addClass('invalid');inputBox.append(formV.renderErrors(errors))}else{inputBox.removeClass('invalid')}})}});return result};this.formValidate=function(){return checkErrors($(this),{requestType:'validate',async:false})};this.submit=function(){var options=this.options,form=this.form,formV=this;this.form.on('submit',function(){if(options.before){options.before(form)};if(result=formV.checkErrors(form,{requestType:'submit',async:false})){if(options.success){options.success(result,form)}}else{if(options.fail){options.fail(result,form)}};if(options.after){options.after(result,form)};return false});return this}};$.fn.formSubmit=function(options){$(this).each(function(){var form=new FormValidator();form.setElement($(this)).init(options).submit()})};(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery'],factory)}else{factory(jQuery)}})(function($){'use strict';var instances=[],matchers=[],defaultOptions={precision:100,elapse:false,defer:false};matchers.push(/^[0-9]*$/.source);matchers.push(/([0-9]{1,2}\/){2}[0-9]{4}( [0-9]{1,2}(:[0-9]{2}){2})?/.source);matchers.push(/[0-9]{4}([\/\-][0-9]{1,2}){2}( [0-9]{1,2}(:[0-9]{2}){2})?/.source);matchers=new RegExp(matchers.join('|'));function parseDateString(dateString){if(dateString instanceof Date){return dateString};if(String(dateString).match(matchers)){if(String(dateString).match(/^[0-9]*$/)){dateString=Number(dateString)};if(String(dateString).match(/\-/)){dateString=String(dateString).replace(/\-/g,'/')};return new Date(dateString)}else{throw new Error('Couldn\'t cast `'+dateString+'` to a date object.');}};var DIRECTIVE_KEY_MAP={'Y':'years','m':'months','n':'daysToMonth','d':'daysToWeek','w':'weeks','W':'weeksToMonth','H':'hours','M':'minutes','S':'seconds','D':'totalDays','I':'totalHours','N':'totalMinutes','T':'totalSeconds'};function escapedRegExp(str){var sanitize=str.toString().replace(/([.?*+^$[\]\\(){}|-])/g,'\\$1');return new RegExp(sanitize)};function strftime(offsetObject){return function(format){var directives=format.match(/%(-|!)?[A-Z]{1}(:[^;]+;)?/gi);if(directives){for(var i=0,len=directives.length;i<len;++i){var directive=directives[i].match(/%(-|!)?([a-zA-Z]{1})(:[^;]+;)?/),regexp=escapedRegExp(directive[0]),modifier=directive[1]||'',plural=directive[3]||'',value=null;directive=directive[2];if(DIRECTIVE_KEY_MAP.hasOwnProperty(directive)){value=DIRECTIVE_KEY_MAP[directive];value=Number(offsetObject[value])};if(value!==null){if(modifier==='!'){value=pluralize(plural,value)};if(modifier===''){if(value<10){value='0'+value.toString()}};format=format.replace(regexp,value.toString())}}};format=format.replace(/%%/,'%');return format}};function pluralize(format,count){var plural='s',singular='';if(format){format=format.replace(/(:|;|\s)/gi,'').split(/\,/);if(format.length===1){plural=format[0]}else{singular=format[0];plural=format[1]}};if(Math.abs(count)>1){return plural}else{return singular}};var Countdown=function(el,finalDate,options){this.el=el;this.$el=$(el);this.interval=null;this.offset={};this.options=$.extend({},defaultOptions);this.instanceNumber=instances.length;instances.push(this);this.$el.data('countdown-instance',this.instanceNumber);if(options){if(typeof options==='function'){this.$el.on('update.countdown',options);this.$el.on('stoped.countdown',options);this.$el.on('finish.countdown',options)}else{this.options=$.extend({},defaultOptions,options)}};this.setFinalDate(finalDate);if(this.options.defer===false){this.start()}};$.extend(Countdown.prototype,{start:function(){if(this.interval!==null){clearInterval(this.interval)};var self=this;this.update();this.interval=setInterval(function(){self.update.call(self)},this.options.precision)},stop:function(){clearInterval(this.interval);this.interval=null;this.dispatchEvent('stoped')},toggle:function(){if(this.interval){this.stop()}else{this.start()}},pause:function(){this.stop()},resume:function(){this.start()},remove:function(){this.stop.call(this);instances[this.instanceNumber]=null;delete this.$el.data().countdownInstance},setFinalDate:function(value){this.finalDate=parseDateString(value)},update:function(){if(this.$el.closest('html').length===0){this.remove();return};var hasEventsAttached=$._data(this.el,'events')!==undefined,now=new Date(),newTotalSecsLeft;newTotalSecsLeft=this.finalDate.getTime()-now.getTime();newTotalSecsLeft=Math.ceil(newTotalSecsLeft/1000);newTotalSecsLeft=!this.options.elapse&&newTotalSecsLeft<0?0:Math.abs(newTotalSecsLeft);if(this.totalSecsLeft===newTotalSecsLeft||!hasEventsAttached){return}else{this.totalSecsLeft=newTotalSecsLeft};this.elapsed=(now>=this.finalDate);this.offset={seconds:this.totalSecsLeft%60,minutes:Math.floor(this.totalSecsLeft/60)%60,hours:Math.floor(this.totalSecsLeft/60/60)%24,days:Math.floor(this.totalSecsLeft/60/60/24)%7,daysToWeek:Math.floor(this.totalSecsLeft/60/60/24)%7,daysToMonth:Math.floor(this.totalSecsLeft/60/60/24%30.4368),weeks:Math.floor(this.totalSecsLeft/60/60/24/7),weeksToMonth:Math.floor(this.totalSecsLeft/60/60/24/7)%4,months:Math.floor(this.totalSecsLeft/60/60/24/30.4368),years:Math.abs(this.finalDate.getFullYear()-now.getFullYear()),totalDays:Math.floor(this.totalSecsLeft/60/60/24),totalHours:Math.floor(this.totalSecsLeft/60/60),totalMinutes:Math.floor(this.totalSecsLeft/60),totalSeconds:this.totalSecsLeft};if(!this.options.elapse&&this.totalSecsLeft===0){this.stop();this.dispatchEvent('finish')}else{this.dispatchEvent('update')}},dispatchEvent:function(eventName){var event=$.Event(eventName+'.countdown');event.finalDate=this.finalDate;event.elapsed=this.elapsed;event.offset=$.extend({},this.offset);event.strftime=strftime(this.offset);this.$el.trigger(event)}});$.fn.countdown=function(){var argumentsArray=Array.prototype.slice.call(arguments,0);return this.each(function(){var instanceNumber=$(this).data('countdown-instance');if(instanceNumber!==undefined){var instance=instances[instanceNumber],method=argumentsArray[0];if(Countdown.prototype.hasOwnProperty(method)){instance[method].apply(instance,argumentsArray.slice(1))}else if(String(method).match(/^[$A-Z_][0-9A-Z_$]*$/i)===null){instance.setFinalDate.call(instance,method);instance.start()}else{$.error('Method %s does not exist on jQuery.countdown'.replace(/\%s/gi,method))}}else{new Countdown(this,argumentsArray[0],argumentsArray[1])}})}});$(function(){initPopups();initElements();initNav();initDatepicker();initAutocomplete();initMetric()});function initMetric(){var url=$.aptero.url();url.init();$.ajax({url:'/metrics/init/',method:'post',data:{query:url.getParams()}})};function initNav(){var header=$('#header'),fog=$('#fog');$('.item',header).on('click',function(){var box=$('.box.'+$(this).data('box'),header);if(box.css('display')=='none'){$('.box',header).css({display:'none'});box.slideDown(200);fog.fadeIn(200)}else{box.slideUp(200);fog.fadeOut(200)}});fog.on('click',function(){$('.box',header).slideUp(200);fog.fadeOut(200)})};function initElements(){$('.std-counter').each(function(){var el=$(this),input=$('input',el);$('.incr',el).on('click',function(){input.val(parseInt(input.val())+1).trigger('change')});$('.decr',el).on('click',function(){var count=parseInt(input.val())-1;if(count<1){return};input.val(count).trigger('change')})})};function initPopups(){$('body').on('click','.popup',function(){var el=$(this);$.fancybox.open({src:el.attr('href'),type:'ajax',opts:{ajax:{settings:{data:el.data()}},afterLoad:function(e){initElements(e.$refs.slider)}}});return false})};function initAutocomplete(){var input=$('.search .query'),url='/catalog/search/';function stars(stars){var html='<div class="stars">';for($i=0;$i<=4;$i++){$starFilling=stars-$i;if($starFilling>=0.6){$class=' class="full"'}else if($starFilling>=0.1){$class=' class="half"'}else{$class=''};html+='<div'+$class+'></div> '};html+='</div>';return html};$.widget('custom.catcomplete',$.ui.autocomplete,{_create:function(){this._super();this.widget().menu('option','items','.ac-item');$('.add-to-cart').menu('option','disabled',true)},_renderItem:function(ul,item){var li=$('<li></li>');li.addClass('ac-item');switch(item.type){case'title':break;case'hr':li.addClass('ac-hr').removeClass('ac-item').text(item.label);break;case'clear':li.addClass('ac-clear').removeClass('ac-item').text(item.label);break;case'show-all':li.addClass('ac-show-all').removeClass('ac-item');li.append('<span> </span>');li.on('click',function(){location.href=url+'?query='+input.val()});break;case'category':li.addClass('ac-category');li.append('<a href="'+item.url+'">'+item.label+'</a>');break;case'brand':li.addClass('ac-brand');li.append('<a href="'+item.url+'">'+item.label+'</a>');break;case'product':li.addClass('ac-product');li.append('<div class="pr-box"><div><a href="'+item.url+'" class="pic"><img src="'+item.img+'"></a><div class="info"><a href="'+item.url+'" class="title">'+item.label+'</a><div>'+stars(item.stars)+'<span class="reviews">'+item.reviews+'</span></div><span class="price"><span></span> '+$.aptero.price(item.price)+' <i class="fa fa-rub"></i></span> </div></div></div>');break;default:li.append('<a href="#">'+item.label+'</a>')};if(item.hide){li.addClass('hide').removeClass('ac-item')};return li.appendTo(ul)}});var pos={my:'left top',at:'left bottom'};input.catcomplete({position:pos,source:function(request,response){$.ajax({url:url,type:'get',dataType:'json',data:{query:request.term},success:function(data){response(data)}})},select:function(event,ui){if(ui.item.url){location.href=ui.item.url}},open:function(event,ui){$('.order-box .js-to-cart','.ac-product').on('click',function(e){var el=$(this);cart.add({id:el.data('id'),count:1});e.stopPropagation();return false})},lookup:'res',maxHeight:300,width:630,zIndex:9999,deferRequestBy:300,params:{limit:10},})};function initDatepicker(){$.config.datepicker={clearText:'',clearStatus:'',closeText:'',closeStatus:'',prevText:'',prevStatus:'',nextText:'',nextStatus:'',currentText:'',currentStatus:'',monthNames:['','','','','','','','','','','',''],monthNamesShort:['','','','','','','','','','','',''],monthStatus:'',yearStatus:'',weekHeader:'',weekStatus:'',dayNames:['','','','','','',''],dayNamesShort:['','','','','','',''],dayNamesMin:['','','','','','',''],dayStatus:'DD',dateStatus:'D, M d',dateFormat:'dd.mm.yy',firstDay:1,initStatus:'',isRTL:false,minDate:+1,maxDate:+30,};$('.datepicker').datepicker($.config.datepicker)};var mapsArr=[];function setPickupMap(options){var map=null;$.each(mapsArr,function(key,val){if(val.id==options.id){val.map.destroy();mapsArr.splice(key,1)}});$.getScript(libs.libYandexMaps,function(){var data=options.pointsData?options.pointsData:{};var url=options.url?options.url:'/delivery/points-map-data/';$.ajax({url:url,method:'post',data:data,success:function(resp){options=$.extend(options,{center:resp.center,points:resp.points,});initMap(options)}})});var initMap=function(options){if(!options.center.lat||!options.center.lon){return};ymaps.ready(function(){map=new ymaps.Map(options.id,{center:[options.center.lat,options.center.lon],controls:[],zoom:(options.zoom?options.zoom:11)});var clusterer=new ymaps.Clusterer({preset:'twirl#invertedBlueClusterIcons',clusterDisableClickZoom:false,});var markers=[];options.points.forEach(function(point){var marker=new ymaps.Placemark([point.lat,point.lon],{balloonContent:point.desc},{preset:'islands#blackHomeIcon',});markers.push(marker)});clusterer.add(markers);map.geoObjects.add(clusterer);if(options.zoom!==undefined&&options.zoom==false){map.behaviors.disable('scrollZoom')};map.controls.add('zoomControl',{top:10,left:5});if(options.onInit){options.onInit()};mapsArr.push({id:options.id,map:map})})};return map};$(function(){productView($('.product-view'));cartView();cartRender();userModel();orderForm()});function orderForm(){$('.order-popup').on('click',function(){$.fancybox.open({src:'/order/',type:'ajax',opts:{margin:[0,0],closeClickOutside:false,closeBtn:false,closeTpl:'',afterLoad:function(e){initElements(box)}}});return false})};$(function(){});function productView(box){$('.product-tabs').tabs({historyMode:true});var viewedProducts=new Products().init();viewedProducts.add({id:$('[name="product_id"]',$('.type-box',box)).val()});var product=box,pic=$('.images .pic',product),img=$('img',pic),thumbs=$('.thumb',product);thumbs.on('click',function(){var el=$(this),img=$('img',pic);el.addClass('active').siblings().removeClass('active');pic.data('size',el.data('size')).data('taste',el.data('taste')).removeClass('hide');img.attr('src',el.attr('href')).data('zoom-image',el.data('zoom'));return false});toCartForm(product,{priceUpdate:function(resp){$('.price span',product).text($.aptero.price(resp.price));$('.price-old span',product).text($.aptero.price(resp.price_old));if(parseInt(resp.stock)){$('.in-stock',product).css({display:'block'});$('.not-in-stock',product).css({display:'none'})}else{$('.in-stock',product).css({display:'none'});$('.not-in-stock',product).css({display:'block'})}},toCart:function(){$('.to-cart',product).addClass('in-cart').removeClass('to-cart').text(' ')},typeChange:function(size_id,taste_id){$('.in-cart',product).addClass('to-cart').removeClass('in-cart').text(' ');thumbs.each(function(){var thumb=$(this),th_size_id=thumb.data('size'),th_taste_id=thumb.data('taste');if((th_size_id&&th_size_id!=size_id)||(th_taste_id&&th_taste_id!=taste_id)){thumb.addClass('hide')}else{thumb.removeClass('hide')}});if((pic.data('taste')&&pic.data('taste')!=taste_id)||(pic.data('size')&&pic.data('size')!=size_id)){pic.addClass('hide')};if(pic.hasClass('hide')){$('.thumb:not(.hide)',product).eq(0).trigger('click')}}})};function toCartForm(box,options){if(!box.length){return};var typeBox=$('.type-box',box),sizeSelect=$('.js-size-select',typeBox),tasteSelect=$('.js-taste-select',typeBox),countSelect=$('.js-count',typeBox);function updatePrice(){var data=$.aptero.serializeArray(typeBox);$.ajax({url:'/catalog/get-price/',method:'post',data:data,success:options.priceUpdate})};sizeSelect.on('change',function(){$.ajax({url:'/catalog/get-product-stock/',method:'post',data:$.aptero.serializeArray(typeBox),success:function(resp){$('option',tasteSelect).each(function(){var el=$(this),id=el.attr('value');if(parseInt(resp[sizeSelect.val()].taste[id])){el.addClass('green').removeClass('red')}else{el.addClass('red').removeClass('green')}});if($('option[value="'+tasteSelect.val()+'"]',tasteSelect).hasClass('red')&&$('option.green',tasteSelect).length){tasteSelect.val($('option.green',tasteSelect).attr('value')).trigger('change')}else{options.typeChange(sizeSelect.val(),tasteSelect.val());updatePrice()}}})});tasteSelect.on('change',function(){options.typeChange(sizeSelect.val(),tasteSelect.val());updatePrice()});countSelect.on('change',function(){updatePrice()});$.ajax({url:'/catalog/get-product-stock/',method:'post',data:$.aptero.serializeArray(typeBox),success:function(resp){$('option',sizeSelect).each(function(){var el=$(this),id=el.attr('value');if(parseInt(resp[id].stock)){el.addClass('green').removeClass('red')}else{el.addClass('red').removeClass('green')}});if($('option[value="'+sizeSelect.val()+'"]',sizeSelect).hasClass('red')){if($('option.green',sizeSelect).length){sizeSelect.val($('option.green',sizeSelect).attr('value'))}};sizeSelect.trigger('change')}});$('.js-product-request',box).on('click',function(){$.fancybox.open({src:'/order/product-request/',type:'ajax',opts:{margin:[0,0],ajax:{settings:{data:$.aptero.serializeArray(typeBox)}}}})});$('.js-cart-add',box).on('click',function(){var btn=$(this);if(btn.hasClass('to-cart')){$.cart.add($.aptero.serializeArray(typeBox));options.toCart();return false}})};function cartView(){var box=$('.cart-list');if(!box.length){return};box.on('change','.js-cart-count',function(){var el=$(this),data=el.closest('.product').data();data.count=parseInt(el.val());if(data.count>0){$.cart.add(data,{count:'replace'})}});box.on('click','.js-cart-del',function(){var product=$(this).closest('.product');product.fadeOut(200);$.cart.del(product.data())})};function cartRender(){$.cart.on('render',function(){for(var i in $.cart.cart){var product=$.cart.cart[i],productEl=$('.product[data-product_id="'+product.product_id+'"][data-size_id="'+product.size_id+'"][data-taste_id="'+product.taste_id+'"]','.cart-list');$('.sum span',productEl).text($.aptero.price(product.price*product.count))};var navCart=$('.item.cart','#header'),orderForm=$('.order-form');if($.cart.count){$('.desc',navCart).html($.aptero.price($.cart.sum)+' <i class="fa fa-rub"></i>');$('.counter',navCart).text($.cart.count).fadeIn(200);$('.cart-price').text($.aptero.price($.cart.sum));if(orderForm.length){var deliveryPrice=0;switch($('[name="attrs-delivery"]',orderForm).val()){case'courier':deliveryPrice=$.cart.delivery.courier;$('.cart-delivery').html(deliveryPrice?$.aptero.price(deliveryPrice)+' <i class="fa fa-rub"></i>':'');break;case'pickup':deliveryPrice=$.cart.delivery.pickup;$('.cart-delivery').html(deliveryPrice?$.aptero.price(deliveryPrice)+' <i class="fa fa-rub"></i>':'');break;default:$('.cart-delivery').html(' ');break};$('.cart-sum-price',orderForm).text($.aptero.price($.cart.sum+parseInt(deliveryPrice)));$('.cart-error').css({display:'none'});$('.order-btn').css({display:'block'})}}else{$('.desc',navCart).text(' ');$('.counter',navCart).fadeOut(200);$('.cart-list').html('<div class="empty">  </div>')}})};function userModel(){$('.profile-tabs').tabs()};